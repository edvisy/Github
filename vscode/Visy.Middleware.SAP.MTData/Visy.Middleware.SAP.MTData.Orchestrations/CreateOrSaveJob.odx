#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="95e931f2-0636-44c6-9206-61fa056b4368" LowerBound="1.1" HigherBound="615.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="Visy.Middleware.SAP.MTData.Orchestrations" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="ServiceDeclaration" OID="f302bc15-eccf-4c40-a542-693b417de58a" ParentLink="Module_ServiceDeclaration" LowerBound="142.1" HigherBound="614.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="CreateOrSaveJobAgent" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="1d1f8ee1-8af5-4ec1-9856-533e3d4b6b94" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="158.1" HigherBound="159.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Username" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="eaf269dc-bad3-4290-9cad-f0511a83fb2d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="159.1" HigherBound="160.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Password" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c8df8c1d-c3a6-4fb8-bf43-6b96aa370928" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="160.1" HigherBound="161.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="UserId" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e8ea2d2a-bc4e-48df-906a-96d3d0af9e33" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="161.1" HigherBound="162.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="dispatchId" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c4db212e-b1d3-47b5-9b72-052048a6e1d0" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="162.1" HigherBound="163.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="idocNumber" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="35e244ca-921d-4b9e-9e95-edc6a175953a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="163.1" HigherBound="164.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sbMsgBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f525f872-54e0-4099-a260-1b46614e7686" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="164.1" HigherBound="165.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="rsNumber" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f4d97938-2ce2-409c-86e0-e7342f44914d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="165.1" HigherBound="166.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sStatus" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8f316f5c-d99e-4d21-82c7-44783190ed0b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="166.1" HigherBound="167.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sRoute" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7427346d-d58b-4615-8888-09774dc77566" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="167.1" HigherBound="168.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sRouteDescription" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3a01817a-2d44-40fc-b167-b8eac001b4f3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="168.1" HigherBound="169.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sDeviceId" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5ec8241a-3093-4605-8816-4c2f1e657791" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="169.1" HigherBound="170.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sRunsheetDate" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="36e58ba6-9404-49c5-b1c2-07560837463a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="170.1" HigherBound="171.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sRunsheetDateTo" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="caf8f957-739b-4a40-885a-514b86aa702e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="171.1" HigherBound="172.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Recipient" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="20050415-bb03-4024-a747-701879b7379e" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="155.1" HigherBound="156.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.SapZVMRUNSHEET01_ReceiveType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SapZVMRUNSHEET01_Receive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="3cfbe7f4-02cc-4894-955c-25a0d69d3f38" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="156.1" HigherBound="157.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.SapZVMRUNSHEET01_SendType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SapZVMRUNSHEET01_Send" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="a44047f8-c6d5-4797-81c2-43a647895e0a" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="157.1" HigherBound="158.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.EmailExceptionType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="EmailException" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="b4f72682-11e0-4ffd-88e6-1b643b2fc515" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="9a8f52da-79ed-4485-86f5-0f812db6a8c0" ParentLink="ServiceBody_Statement" LowerBound="174.1" HigherBound="188.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="SapIdocReceive_Port" />
                    <om:Property Name="MessageName" Value="SapZVMRUNSHEET01_Receive" />
                    <om:Property Name="OperationName" Value="Receive" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive Idoc" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Scope" OID="573c37bb-238c-4d5f-aa56-59d576032173" ParentLink="ServiceBody_Statement" LowerBound="188.1" HigherBound="612.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Main Scope" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="VariableAssignment" OID="43f7dbf1-dfed-4078-80fc-6116ff7a7fe6" ParentLink="ComplexStatement_Statement" LowerBound="199.1" HigherBound="231.1">
                        <om:Property Name="Expression" Value="RunsheetStatus = SapZVMRUNSHEET01_Receive(Visy.Middleware.Common.Schemas.SAP.ZVMRunsheet.Status);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;SAP.MTData&quot;, RunsheetStatus);&#xD;&#xA;xquery = &quot;string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='EDI_DC40']/*[local-name()='DOCNUM'])&quot;;&#xD;&#xA;idocNumber = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);&#xD;&#xA;&#xD;&#xA;xquery = &quot;string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='STATUS'])&quot;;&#xD;&#xA;sStatus = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);&#xD;&#xA;&#xD;&#xA;xquery = &quot;string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='ROUTE'])&quot;;&#xD;&#xA;sRoute = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);&#xD;&#xA;&#xD;&#xA;xquery = &quot;string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='RTE_DESC'])&quot;;&#xD;&#xA;sRouteDescription = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);&#xD;&#xA;&#xD;&#xA;xquery = &quot;string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='DEVICE_ID'])&quot;;&#xD;&#xA;sDeviceId = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);&#xD;&#xA;&#xD;&#xA;xquery = &quot;string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='RS_DATE'])&quot;;&#xD;&#xA;sRunsheetDate = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);&#xD;&#xA;&#xD;&#xA;xquery = &quot;string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='RS_DATE_TO'])&quot;;&#xD;&#xA;sRunsheetDateTo = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;xquery = &quot;string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='RS_NUMBER'])&quot;;&#xD;&#xA;rsNumber = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);&#xD;&#xA;&#xD;&#xA;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Get ZVMRUNSHEET01 Status" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Scope" OID="c83c4c22-3199-49d6-a9c7-8c1b55cd4c10" ParentLink="ComplexStatement_Statement" LowerBound="231.1" HigherBound="275.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CheckLogin Scope" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableDeclaration" OID="c7e1fbb6-387b-456a-8a44-59eb85483d4f" ParentLink="Scope_VariableDeclaration" LowerBound="237.1" HigherBound="238.1">
                            <om:Property Name="UseDefaultConstructor" Value="False" />
                            <om:Property Name="Type" Value="System.String" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="unencodedPassword" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="5657e784-ec86-463b-a13f-95ac7d90d270" ParentLink="ComplexStatement_Statement" LowerBound="241.1" HigherBound="247.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct Settings Message" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="457654ec-afc1-4451-9535-8bbb4e5dfb04" ParentLink="ComplexStatement_Statement" LowerBound="244.1" HigherBound="246.1">
                                <om:Property Name="Expression" Value="Settings.Body = Visy.Middleware.SAP.MTData.Components.MessageHelper.CreateSettingsMessage();" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="Get Settings template" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="3d366cc2-7cea-4c63-b0c5-22006502c0ee" ParentLink="Construct_MessageRef" LowerBound="242.39" HigherBound="242.47">
                                <om:Property Name="Ref" Value="Settings" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="057de582-496f-477c-b55b-7b1a7aac1faf" ParentLink="ComplexStatement_Statement" LowerBound="247.1" HigherBound="261.1">
                            <om:Property Name="Expression" Value="// Get the current Username value from the Settings document&#xD;&#xA;//xquery=&quot;string(/*[local-name()='KeyValueSet']/*[local-name()='KeyValue'][Key='Username']/*[local-name()='Value'])&quot;;&#xD;&#xA;Username = Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData(&quot;UserName&quot;, &quot;SAP.MTData&quot;);//xpath(Settings.Body, xquery);&#xD;&#xA;&#xD;&#xA;// Get the unencoded Password value from the Settings document&#xD;&#xA;//xquery=&quot;string(/*[local-name()='KeyValueSet']/*[local-name()='KeyValue'][Key='Password']/*[local-name()='Value'])&quot;;&#xD;&#xA;unencodedPassword =  Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData(&quot;Password&quot;, &quot;SAP.MTData&quot;);//xpath(Settings.Body, xquery);&#xD;&#xA;&#xD;&#xA;//xquery=&quot;string(/*[local-name()='KeyValueSet']/*[local-name()='KeyValue'][Key='Sender']/*[local-name()='Value'])&quot;;&#xD;&#xA;Sender = Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData(&quot;Sender&quot;, &quot;SAP.MTData&quot;);//xpath(Settings.Body, xquery);&#xD;&#xA;&#xD;&#xA;//xquery=&quot;string(/*[local-name()='KeyValueSet']/*[local-name()='KeyValue'][Key='Recipient']/*[local-name()='Value'])&quot;;&#xD;&#xA;Recipient = Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData(&quot;Recipient&quot;, &quot;SAP.MTData&quot;);//xpath(Settings.Body, xquery);&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Get Settings from Config" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="89e3bdfc-7553-45dd-bbea-f3b3323db1a8" ParentLink="ComplexStatement_Statement" LowerBound="261.1" HigherBound="264.1">
                            <om:Property Name="Expression" Value="// Encode the password, so it's not transmitted in plaintext&#xD;&#xA;Password = Visy.Middleware.SAP.MTData.Components.CredentialsHelper.EncodePassword(unencodedPassword);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Encode Password" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="a4270a42-ebac-447f-bb29-6dd74ad64a12" ParentLink="ComplexStatement_Statement" LowerBound="264.1" HigherBound="270.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct CheckLogin Request" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="2b0e811a-ea9d-4ec5-b5b2-4dc271c39d9d" ParentLink="ComplexStatement_Statement" LowerBound="267.1" HigherBound="269.1">
                                <om:Property Name="Expression" Value="CheckLoginRequest.Body = Visy.Middleware.SAP.MTData.Components.MessageHelper.CreateCheckLoginMessage(Username, Password);" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="Create message" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="21a5afc2-8d84-49b0-85df-ee87455a41c7" ParentLink="Construct_MessageRef" LowerBound="265.39" HigherBound="265.56">
                                <om:Property Name="Ref" Value="CheckLoginRequest" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="1db5cd54-b21a-4094-bf50-fd78c3759f71" ParentLink="ComplexStatement_Statement" LowerBound="270.1" HigherBound="273.1">
                            <om:Property Name="Expression" Value="UserId = 1;//CheckLoginResponse.Body.CheckLoginResult;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;SAP.MTData&quot;, RunsheetStatus);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Update UserId" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessageDeclaration" OID="7a8acd0c-b2ce-4c32-b5fb-addbd5914de9" ParentLink="Scope_MessageDeclaration" LowerBound="234.1" HigherBound="235.1">
                            <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.CheckLogin_RequestType" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CheckLoginRequest" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="MessageDeclaration" OID="dd6a0c9e-4f99-4915-9a26-d1c9611e1c2b" ParentLink="Scope_MessageDeclaration" LowerBound="235.1" HigherBound="236.1">
                            <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.CheckLogin_ResponseType" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CheckLoginResponse" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="MessageDeclaration" OID="b944f487-17b1-4777-abe7-2077e8467c57" ParentLink="Scope_MessageDeclaration" LowerBound="236.1" HigherBound="237.1">
                            <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.Settings_Type" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Settings" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Decision" OID="690caf6d-8f60-4085-9c81-ca7cbd3efa08" ParentLink="ComplexStatement_Statement" LowerBound="275.1" HigherBound="441.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Create or Save Job?" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="d7ee7fbe-ec46-4a90-8082-f655074730d5" ParentLink="ReallyComplexStatement_Branch" LowerBound="276.21" HigherBound="316.1">
                            <om:Property Name="Expression" Value="RunsheetStatus == &quot;CREATED&quot;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CreateNewJob" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Scope" OID="1d5f2eef-3975-4940-aaed-cb2a345b2187" ParentLink="ComplexStatement_Statement" LowerBound="278.1" HigherBound="315.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CreateNewJob Scope" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="fd86b35f-5eb3-4c09-b3bb-f77d9e26a673" ParentLink="ComplexStatement_Statement" LowerBound="288.1" HigherBound="302.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct CreateNewJob Request" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="ad0e7bc5-dfe7-445a-8baf-5f4400535e1b" ParentLink="Construct_MessageRef" LowerBound="289.43" HigherBound="289.62">
                                        <om:Property Name="Ref" Value="CreateNewJobRequest" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="dd3b66f4-68ea-4f01-b8bd-54495718007e" ParentLink="Construct_MessageRef" LowerBound="289.64" HigherBound="289.67">
                                        <om:Property Name="Ref" Value="Job" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="Transform" OID="8b69e900-fa31-4f96-bef6-6e8f6ccf988b" ParentLink="ComplexStatement_Statement" LowerBound="291.1" HigherBound="293.1">
                                        <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_Job" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ZVMRUNSHEET01_to_Job" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessagePartRef" OID="a497080c-44a8-42a1-86c4-5a5ffafcca28" ParentLink="Transform_InputMessagePartRef" LowerBound="292.114" HigherBound="292.143">
                                            <om:Property Name="MessageRef" Value="SapZVMRUNSHEET01_Receive" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_9" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessagePartRef" OID="0a1c5d9f-a0e2-453c-a215-f32226edd31d" ParentLink="Transform_OutputMessagePartRef" LowerBound="292.48" HigherBound="292.56">
                                            <om:Property Name="MessageRef" Value="Job" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_10" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Transform" OID="2fd2af7a-e443-4205-b5d6-219f6820f504" ParentLink="ComplexStatement_Statement" LowerBound="293.1" HigherBound="295.1">
                                        <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_CreateNewJob" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ZVMRUNSHEET01_to_CreateNewJob" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="MessagePartRef" OID="69135c41-0bfe-4a56-88c3-f55d1491ff39" ParentLink="Transform_InputMessagePartRef" LowerBound="294.139" HigherBound="294.168">
                                            <om:Property Name="MessageRef" Value="SapZVMRUNSHEET01_Receive" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_16" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessagePartRef" OID="41e8458b-3e24-4d4a-9b01-5b7ebbaeb835" ParentLink="Transform_OutputMessagePartRef" LowerBound="294.48" HigherBound="294.72">
                                            <om:Property Name="MessageRef" Value="CreateNewJobRequest" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_17" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="7d09a51e-d429-4c4e-b69b-225de8e5afde" ParentLink="ComplexStatement_Statement" LowerBound="295.1" HigherBound="301.1">
                                        <om:Property Name="Expression" Value="CreateNewJobRequest.Body.appCredentials.UserID = UserId;&#xD;&#xA;CreateNewJobRequest.Body.appCredentials.Username = Username;&#xD;&#xA;CreateNewJobRequest.Body.appCredentials.Password = Password;&#xD;&#xA;&#xD;&#xA;CreateNewJobRequest.Body.xml = Visy.Middleware.SAP.MTData.Components.MessageHelper.MessageToXml(Job.Body);&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="Update Xml parameter" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="11fd9ba1-9f51-4832-9481-37d444299898" ParentLink="ComplexStatement_Statement" LowerBound="302.1" HigherBound="304.1">
                                    <om:Property Name="PortName" Value="MTDataWebService_Port" />
                                    <om:Property Name="MessageName" Value="CreateNewJobRequest" />
                                    <om:Property Name="OperationName" Value="CreateNewJob" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send CreateNewJob Request" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="17c95b5f-4bff-4dc8-ac24-ce44ecee22d2" ParentLink="ComplexStatement_Statement" LowerBound="304.1" HigherBound="306.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="MTDataWebService_Port" />
                                    <om:Property Name="MessageName" Value="CreateNewJobResponse" />
                                    <om:Property Name="OperationName" Value="CreateNewJob" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive CreateNewJob Response" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="b15c1ad5-89d0-43b7-9d29-3ad25885f010" ParentLink="ComplexStatement_Statement" LowerBound="306.1" HigherBound="313.1">
                                    <om:Property Name="Expression" Value="dispatchId = System.Convert.ToInt32(&#xD;&#xA;    Visy.Middleware.SAP.MTData.Components.MessageHelper.ExtractReturnValue(&#xD;&#xA;    CreateNewJobResponse.Body.CreateNewJobResult,&#xD;&#xA;    &quot;/*[local-name()='Job']/*[local-name()='DispatchId']&quot;,&#xD;&#xA;    &quot;CreateNewJobResponse&quot;)&#xD;&#xA;    );" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Get DispatchId/ErrorMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="04c7e38e-31ca-4bf5-9220-9215d74a7d51" ParentLink="Scope_MessageDeclaration" LowerBound="281.1" HigherBound="282.1">
                                    <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.CreateNewJob_ResponseType" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CreateNewJobResponse" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="54dbc1f8-29cb-426d-8e72-5fefa479de7f" ParentLink="Scope_MessageDeclaration" LowerBound="282.1" HigherBound="283.1">
                                    <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.CreateNewJob_RequestType" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CreateNewJobRequest" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="c6e0470c-22e7-426c-bf96-8007283f9ed5" ParentLink="Scope_MessageDeclaration" LowerBound="283.1" HigherBound="284.1">
                                    <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.Job_Type" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Job" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="96b2c591-e7b0-41d4-a73a-8d30ae6bfe86" ParentLink="Scope_VariableDeclaration" LowerBound="284.1" HigherBound="285.1">
                                    <om:Property Name="UseDefaultConstructor" Value="True" />
                                    <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="xdoc" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="17f27603-b174-4f37-9117-217cac46fa8d" ParentLink="ReallyComplexStatement_Branch" LowerBound="316.26" HigherBound="352.1">
                            <om:Property Name="Expression" Value="RunsheetStatus == &quot;CANCEL&quot;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="CancelJob" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Scope" OID="09148475-dbdd-4018-a831-a19bab8e6194" ParentLink="ComplexStatement_Statement" LowerBound="318.1" HigherBound="351.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="CancelJob Scope" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="31d921fd-8eb9-4229-882e-d5b9f47ba011" ParentLink="ComplexStatement_Statement" LowerBound="325.1" HigherBound="336.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct CancelJob Request" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Transform" OID="90833af7-6dfd-47b0-ad32-fe154e7cd741" ParentLink="ComplexStatement_Statement" LowerBound="328.1" HigherBound="330.1">
                                        <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_CancelJob" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ZVMRUNSHEET01_to_CancelJob" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessagePartRef" OID="fad0ae51-446e-4528-bc6a-8cd149ce5c8c" ParentLink="Transform_InputMessagePartRef" LowerBound="329.133" HigherBound="329.162">
                                            <om:Property Name="MessageRef" Value="SapZVMRUNSHEET01_Receive" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_11" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessagePartRef" OID="dad30bf5-d355-4964-bc7e-e5308673145a" ParentLink="Transform_OutputMessagePartRef" LowerBound="329.48" HigherBound="329.69">
                                            <om:Property Name="MessageRef" Value="CancelJobRequest" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_13" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="31a6efd7-9efb-4536-ab86-a2a3db4b18ed" ParentLink="ComplexStatement_Statement" LowerBound="330.1" HigherBound="335.1">
                                        <om:Property Name="Expression" Value="CancelJobRequest.Body.appCredentials.UserID = UserId;&#xD;&#xA;CancelJobRequest.Body.appCredentials.Username = Username;&#xD;&#xA;CancelJobRequest.Body.appCredentials.Password = Password;&#xD;&#xA;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="Update Xml parameter" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="24fabf72-bf4b-4827-8765-4b3a040dc75a" ParentLink="Construct_MessageRef" LowerBound="326.43" HigherBound="326.59">
                                        <om:Property Name="Ref" Value="CancelJobRequest" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="e22d80d9-cc8b-4edd-a1ea-da4d93743ad8" ParentLink="ComplexStatement_Statement" LowerBound="336.1" HigherBound="338.1">
                                    <om:Property Name="PortName" Value="MTDataWebService_Port" />
                                    <om:Property Name="MessageName" Value="CancelJobRequest" />
                                    <om:Property Name="OperationName" Value="CancelJob" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send CancelJobRequest" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="1e87d978-2dc2-43af-9978-c4f6e6170933" ParentLink="ComplexStatement_Statement" LowerBound="338.1" HigherBound="340.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="MTDataWebService_Port" />
                                    <om:Property Name="MessageName" Value="CancelJobResponse" />
                                    <om:Property Name="OperationName" Value="CancelJob" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive CancelJob Response" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="6bbeb270-1b26-42e3-9fcf-4785333f469c" ParentLink="ComplexStatement_Statement" LowerBound="340.1" HigherBound="347.1">
                                    <om:Property Name="Expression" Value="dispatchId = System.Convert.ToInt32(&#xD;&#xA;    Visy.Middleware.SAP.MTData.Components.MessageHelper.ExtractReturnValue(&#xD;&#xA;    CancelJobResponse.Body.CancelJobResult,&#xD;&#xA;    &quot;/*[local-name()='Job']/*[local-name()='DispatchId']&quot;,&#xD;&#xA;    &quot;CreateNewJobResponse&quot;)&#xD;&#xA;    );" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Get DispatchId/ErrorMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Terminate" OID="8870b45f-bcf4-4aa1-a863-6e8a9b8499e7" ParentLink="ComplexStatement_Statement" LowerBound="347.1" HigherBound="349.1">
                                    <om:Property Name="ErrorMessage" Value="&quot;Cancel Job Successful&quot;;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Terminate_1" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="b5a59aca-383f-4b9a-8012-967eb7195873" ParentLink="Scope_MessageDeclaration" LowerBound="321.1" HigherBound="322.1">
                                    <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.CancelJob_RequestType" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CancelJobRequest" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="3ccd0e91-55c2-4964-a2b7-9bbeda2eaaca" ParentLink="Scope_MessageDeclaration" LowerBound="322.1" HigherBound="323.1">
                                    <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.CancelJob_ResponseType" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CancelJobResponse" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="f1d5ebf3-fcb1-4439-9a79-51211806debf" ParentLink="ReallyComplexStatement_Branch" LowerBound="352.26" HigherBound="388.1">
                            <om:Property Name="Expression" Value="RunsheetStatus == &quot;ASSIGN&quot;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="AssignJobToVehicle" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Scope" OID="393f2d79-db5f-47f4-9ba2-689599ee91e4" ParentLink="ComplexStatement_Statement" LowerBound="354.1" HigherBound="387.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="AssignJobToVehicle Scope" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="f1384aed-6ba9-454d-b456-965f1f27f0be" ParentLink="ComplexStatement_Statement" LowerBound="361.1" HigherBound="372.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct AssignJobToVehicle Request" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Transform" OID="50248aab-e771-4838-9be6-e6b57d612d12" ParentLink="ComplexStatement_Statement" LowerBound="364.1" HigherBound="366.1">
                                        <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_AssignJobToVehicle" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ZVMRUNSHEET01_to_AssignJobToVehicle" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessagePartRef" OID="90a44d58-b2a2-494f-bb73-9a853a9fe942" ParentLink="Transform_InputMessagePartRef" LowerBound="365.151" HigherBound="365.180">
                                            <om:Property Name="MessageRef" Value="SapZVMRUNSHEET01_Receive" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_14" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessagePartRef" OID="05222923-38eb-4a86-948f-6caec61068fe" ParentLink="Transform_OutputMessagePartRef" LowerBound="365.48" HigherBound="365.78">
                                            <om:Property Name="MessageRef" Value="AssignJobToVehicleRequest" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_15" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="adc82a98-66b9-46bc-bee1-c5edb37b7c0c" ParentLink="ComplexStatement_Statement" LowerBound="366.1" HigherBound="371.1">
                                        <om:Property Name="Expression" Value="AssignJobToVehicleRequest.Body.appCredentials.UserID = UserId;&#xD;&#xA;AssignJobToVehicleRequest.Body.appCredentials.Username = Username;&#xD;&#xA;AssignJobToVehicleRequest.Body.appCredentials.Password = Password;&#xD;&#xA;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="Update Xml parameter" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="5895d11c-d4c6-4758-85d6-8f80dabf34c7" ParentLink="Construct_MessageRef" LowerBound="362.43" HigherBound="362.68">
                                        <om:Property Name="Ref" Value="AssignJobToVehicleRequest" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="4fd21b9c-5d30-4f1d-b546-f6488e59aa0d" ParentLink="ComplexStatement_Statement" LowerBound="372.1" HigherBound="374.1">
                                    <om:Property Name="PortName" Value="MTDataWebService_Port" />
                                    <om:Property Name="MessageName" Value="AssignJobToVehicleRequest" />
                                    <om:Property Name="OperationName" Value="AssignJobToVehicle" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send AssignJobToVehicleRequest" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="bdb56149-b7f0-4714-9b24-8930dd3a9c21" ParentLink="ComplexStatement_Statement" LowerBound="374.1" HigherBound="376.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="MTDataWebService_Port" />
                                    <om:Property Name="MessageName" Value="AssignJobToVehicleResponse" />
                                    <om:Property Name="OperationName" Value="AssignJobToVehicle" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive AssignJobToVehicle Response" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="f2d6305b-8e68-4541-ab8d-eaaaf2cbd8be" ParentLink="ComplexStatement_Statement" LowerBound="376.1" HigherBound="383.1">
                                    <om:Property Name="Expression" Value="dispatchId = System.Convert.ToInt32(&#xD;&#xA;    Visy.Middleware.SAP.MTData.Components.MessageHelper.ExtractReturnValue(&#xD;&#xA;    AssignJobToVehicleResponse.Body.AssignJobToVehicleResult,&#xD;&#xA;    &quot;/*[local-name()='Job']/*[local-name()='DispatchId']&quot;,&#xD;&#xA;    &quot;AssignJobToVehicleResponse&quot;)&#xD;&#xA;    );" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Get DispatchId/ErrorMessage" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Terminate" OID="6976379e-0a24-4e66-b4f5-b28e25dd2a31" ParentLink="ComplexStatement_Statement" LowerBound="383.1" HigherBound="385.1">
                                    <om:Property Name="ErrorMessage" Value="&quot;Assign Job To Vehicle Successful&quot;;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Terminate_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="452e27ef-c3be-41f1-8a82-b313c318da91" ParentLink="Scope_MessageDeclaration" LowerBound="357.1" HigherBound="358.1">
                                    <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.AssignJobToVehicle_RequestType" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="AssignJobToVehicleRequest" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="499157c5-df28-4185-80bf-7230f1740d59" ParentLink="Scope_MessageDeclaration" LowerBound="358.1" HigherBound="359.1">
                                    <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.AssignJobToVehicle_ResponseType" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="AssignJobToVehicleResponse" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="c8e5130a-5182-4348-bbba-1f3f0ef6fe1a" ParentLink="ReallyComplexStatement_Branch" LowerBound="388.26" HigherBound="401.1">
                            <om:Property Name="Expression" Value="RunsheetStatus == &quot;REFRESH&quot;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Refresh" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Scope" OID="b8270910-a707-42b1-8ac3-996149c71956" ParentLink="ComplexStatement_Statement" LowerBound="390.1" HigherBound="400.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Refresh Scope" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="VariableAssignment" OID="18e89b5b-7277-48ea-a73a-8ed40d2439a1" ParentLink="ComplexStatement_Statement" LowerBound="395.1" HigherBound="398.1">
                                    <om:Property Name="Expression" Value="xquery = &quot;string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='EXT_REF'])&quot;;&#xD;&#xA;dispatchId = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Get DispatchId/ErrorMessage" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="3cffa773-2692-4066-8af3-a9a5da7ddeb8" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="SaveJob" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Scope" OID="6732ee04-6260-40eb-9347-b80767520348" ParentLink="ComplexStatement_Statement" LowerBound="403.1" HigherBound="440.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="SaveJob Scope" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="2ae9372a-b3b6-4e43-9ca7-276d3dd1664f" ParentLink="ComplexStatement_Statement" LowerBound="413.1" HigherBound="427.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct SaveJobRequest" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="5953c68d-61d5-48a5-8efa-1964bcb6e39e" ParentLink="Construct_MessageRef" LowerBound="414.43" HigherBound="414.57">
                                        <om:Property Name="Ref" Value="SaveJobRequest" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="a16ff8fd-da05-40af-8c10-dd69343f573d" ParentLink="Construct_MessageRef" LowerBound="414.59" HigherBound="414.62">
                                        <om:Property Name="Ref" Value="Job" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="Transform" OID="d01e7552-2394-4016-b3d4-1c29aef30469" ParentLink="ComplexStatement_Statement" LowerBound="416.1" HigherBound="418.1">
                                        <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_Job" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ZVMRUNSHEET01_to_Job" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="MessagePartRef" OID="d90d86e0-6614-42f5-9b82-fcc111c78c7d" ParentLink="Transform_OutputMessagePartRef" LowerBound="417.48" HigherBound="417.56">
                                            <om:Property Name="MessageRef" Value="Job" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_8" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessagePartRef" OID="6b81d05d-d2f8-4bd5-ad3e-022838ca6624" ParentLink="Transform_InputMessagePartRef" LowerBound="417.114" HigherBound="417.143">
                                            <om:Property Name="MessageRef" Value="SapZVMRUNSHEET01_Receive" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_7" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Transform" OID="19598a98-ffd8-4d22-be2b-ecb1091d8950" ParentLink="ComplexStatement_Statement" LowerBound="418.1" HigherBound="420.1">
                                        <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_SaveJob" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ZVMRUNSHEET01_to_SaveJob" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="MessagePartRef" OID="98e164a4-0cc4-481a-a4fe-614869315267" ParentLink="Transform_InputMessagePartRef" LowerBound="419.129" HigherBound="419.158">
                                            <om:Property Name="MessageRef" Value="SapZVMRUNSHEET01_Receive" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_1" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessagePartRef" OID="31cc74fa-bc6d-4622-83b7-51366eed2533" ParentLink="Transform_OutputMessagePartRef" LowerBound="419.48" HigherBound="419.67">
                                            <om:Property Name="MessageRef" Value="SaveJobRequest" />
                                            <om:Property Name="PartRef" Value="Body" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_2" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="3afcd8e9-abd3-4326-92f2-3622d22b644c" ParentLink="ComplexStatement_Statement" LowerBound="420.1" HigherBound="426.1">
                                        <om:Property Name="Expression" Value="SaveJobRequest.Body.appCredentials.UserID = UserId;&#xD;&#xA;SaveJobRequest.Body.appCredentials.Username = Username;&#xD;&#xA;SaveJobRequest.Body.appCredentials.Password = Password;&#xD;&#xA;&#xD;&#xA;SaveJobRequest.Body.xml = Visy.Middleware.SAP.MTData.Components.MessageHelper.MessageToXml(Job.Body);" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="Update Xml parameter" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="57df4b3d-6564-4599-9714-9b085deca7b6" ParentLink="ComplexStatement_Statement" LowerBound="427.1" HigherBound="429.1">
                                    <om:Property Name="PortName" Value="MTDataWebService_Port" />
                                    <om:Property Name="MessageName" Value="SaveJobRequest" />
                                    <om:Property Name="OperationName" Value="SaveJob" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send SaveJobRequest" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Receive" OID="4b229b79-3f38-4f3b-9ca3-4c36e9241523" ParentLink="ComplexStatement_Statement" LowerBound="429.1" HigherBound="431.1">
                                    <om:Property Name="Activate" Value="False" />
                                    <om:Property Name="PortName" Value="MTDataWebService_Port" />
                                    <om:Property Name="MessageName" Value="SaveJobResponse" />
                                    <om:Property Name="OperationName" Value="SaveJob" />
                                    <om:Property Name="OperationMessageName" Value="Response" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Receive SaveJob Response" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="bb1c218d-4b46-4c8a-9903-b1e5485343df" ParentLink="ComplexStatement_Statement" LowerBound="431.1" HigherBound="438.1">
                                    <om:Property Name="Expression" Value="dispatchId = System.Convert.ToInt32(&#xD;&#xA;    Visy.Middleware.SAP.MTData.Components.MessageHelper.ExtractReturnValue(&#xD;&#xA;    SaveJobResponse.Body.SaveJobResult,&#xD;&#xA;    &quot;/*[local-name()='Job']/*[local-name()='DispatchId']&quot;,&#xD;&#xA;    &quot;SaveJobResponse&quot;)&#xD;&#xA;    );" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Get DispatchId/ErrorMessage" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="2d3f2391-f69d-4f58-b9f7-80d10d2d66b5" ParentLink="Scope_MessageDeclaration" LowerBound="406.1" HigherBound="407.1">
                                    <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.SaveJob_ResponseType" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="SaveJobResponse" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="655f9e21-f24d-44cb-abbd-95e4feb7ba7b" ParentLink="Scope_MessageDeclaration" LowerBound="407.1" HigherBound="408.1">
                                    <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.SaveJob_RequestType" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="SaveJobRequest" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageDeclaration" OID="5393befe-4dc3-47b0-8087-4413b41fdae5" ParentLink="Scope_MessageDeclaration" LowerBound="408.1" HigherBound="409.1">
                                    <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.Job_Type" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Job" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableDeclaration" OID="5964a22a-3a1e-4687-91f1-a760f9ccb504" ParentLink="Scope_VariableDeclaration" LowerBound="409.1" HigherBound="410.1">
                                    <om:Property Name="UseDefaultConstructor" Value="True" />
                                    <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                                    <om:Property Name="ParamDirection" Value="In" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="xdoc" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Scope" OID="3ea71b05-f09f-4200-a478-0430a63cd04c" ParentLink="ComplexStatement_Statement" LowerBound="441.1" HigherBound="509.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="GetJob Scope" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableDeclaration" OID="c083fe9d-4e1b-45d1-bffc-0f85a4d87948" ParentLink="Scope_VariableDeclaration" LowerBound="448.1" HigherBound="449.1">
                            <om:Property Name="UseDefaultConstructor" Value="True" />
                            <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="xdoc" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableDeclaration" OID="6258c014-05e6-4c82-a020-6124ea842fbf" ParentLink="Scope_VariableDeclaration" LowerBound="449.1" HigherBound="450.1">
                            <om:Property Name="UseDefaultConstructor" Value="False" />
                            <om:Property Name="Type" Value="System.String" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="xml" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableDeclaration" OID="b274a08e-f049-443e-8c28-c23ff0ccaba4" ParentLink="Scope_VariableDeclaration" LowerBound="450.1" HigherBound="451.1">
                            <om:Property Name="UseDefaultConstructor" Value="False" />
                            <om:Property Name="Type" Value="System.String" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="destination" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableDeclaration" OID="fe688122-766f-4bc1-992e-4b9b98f69824" ParentLink="Scope_VariableDeclaration" LowerBound="451.1" HigherBound="452.1">
                            <om:Property Name="UseDefaultConstructor" Value="True" />
                            <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Components.MTDataException" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="destinationNotPopulatedException" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="e54fa324-b02c-4f20-a1b8-d200a2d662d7" ParentLink="ComplexStatement_Statement" LowerBound="458.1" HigherBound="470.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Create MessageHeader" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="09f49d8a-fdda-4238-8256-9076233855b1" ParentLink="ComplexStatement_Statement" LowerBound="461.1" HigherBound="469.1">
                                <om:Property Name="Expression" Value="MessageHeader.Body = Visy.Middleware.SAP.MTData.Components.MessageHelper.CreateMessageHeader(&#xD;&#xA;    &quot;Job&quot;, &#xD;&#xA;    &quot;1.0.0.0&quot;, &#xD;&#xA;    Microsoft.XLANGs.Core.Service.RootService.InstanceId.ToString(&quot;D&quot;),&#xD;&#xA;    Sender,&#xD;&#xA;    Recipient);&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="CreateMessageHeader" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="0be79346-bab3-4598-aaed-e595ba18f29d" ParentLink="Construct_MessageRef" LowerBound="459.39" HigherBound="459.52">
                                <om:Property Name="Ref" Value="MessageHeader" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Construct" OID="97a3b474-dece-4180-9c74-e517f3a16c35" ParentLink="ComplexStatement_Statement" LowerBound="470.1" HigherBound="482.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct GetJob Request" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Transform" OID="308dda85-e196-4768-87f9-bc497c0ea735" ParentLink="ComplexStatement_Statement" LowerBound="473.1" HigherBound="475.1">
                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_GetJobRequest" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ZVMRUNSHEET01_to_GetJobRequest" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="MessagePartRef" OID="285faf9e-f457-4bf4-9345-40c2582af465" ParentLink="Transform_InputMessagePartRef" LowerBound="474.130" HigherBound="474.159">
                                    <om:Property Name="MessageRef" Value="SapZVMRUNSHEET01_Receive" />
                                    <om:Property Name="PartRef" Value="Body" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_3" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessagePartRef" OID="45e00227-37c4-49a0-9539-14c787558b30" ParentLink="Transform_OutputMessagePartRef" LowerBound="474.44" HigherBound="474.62">
                                    <om:Property Name="MessageRef" Value="GetJobRequest" />
                                    <om:Property Name="PartRef" Value="Body" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_4" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="25937968-d12f-489c-92e7-2ebc09df084a" ParentLink="ComplexStatement_Statement" LowerBound="475.1" HigherBound="481.1">
                                <om:Property Name="Expression" Value="GetJobRequest.Body.appCredentials.UserID = UserId;&#xD;&#xA;GetJobRequest.Body.appCredentials.Username = Username;&#xD;&#xA;GetJobRequest.Body.appCredentials.Password = Password;&#xD;&#xA;&#xD;&#xA;GetJobRequest.Body.dispatchId = dispatchId;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="Update AppCredentials" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="f6833ec1-6fe1-4646-bf5e-8196672e3cea" ParentLink="Construct_MessageRef" LowerBound="471.39" HigherBound="471.52">
                                <om:Property Name="Ref" Value="GetJobRequest" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="fd86fbd7-1587-4230-9bd9-6e5f00b1482d" ParentLink="ComplexStatement_Statement" LowerBound="482.1" HigherBound="484.1">
                            <om:Property Name="PortName" Value="MTDataWebService_Port" />
                            <om:Property Name="MessageName" Value="GetJobRequest" />
                            <om:Property Name="OperationName" Value="GetJob" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send GetJob Request" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="6b526fdd-84c1-4a4f-a0f3-1dbc3790b70c" ParentLink="ComplexStatement_Statement" LowerBound="484.1" HigherBound="486.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="MTDataWebService_Port" />
                            <om:Property Name="MessageName" Value="GetJobResponse" />
                            <om:Property Name="OperationName" Value="GetJob" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Receive GetJob Response" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="d73348df-3e60-4e62-ae32-d2f08f858a14" ParentLink="ComplexStatement_Statement" LowerBound="486.1" HigherBound="490.1">
                            <om:Property Name="Expression" Value="System.Diagnostics.Trace.WriteLine(&quot;GetJobResponse Write Start&quot;);&#xD;&#xA;System.Diagnostics.Trace.WriteLine(GetJobResponse.Body.GetJobResult);&#xD;&#xA;System.Diagnostics.Trace.WriteLine(&quot;GetJobResponse Write End&quot;);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="TempTraceLog" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="0253e0c2-27cc-4285-bf91-7550599eec68" ParentLink="ComplexStatement_Statement" LowerBound="490.1" HigherBound="501.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct Job" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="52411989-984e-462f-83da-42df5a610fc1" ParentLink="ComplexStatement_Statement" LowerBound="493.1" HigherBound="500.1">
                                <om:Property Name="Expression" Value="Job.Body = Visy.Middleware.SAP.MTData.Components.MessageHelper.XmlToMessage(&#xD;&#xA;    GetJobResponse.Body.GetJobResult,&#xD;&#xA;    &quot;Job&quot;,&#xD;&#xA;    &quot;http://www.mtdata.com.au/integration/services/job/1.0.0&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="Extract Job Xml" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="e4537d1d-b23d-4086-a62c-e1c42831ea36" ParentLink="Construct_MessageRef" LowerBound="491.39" HigherBound="491.42">
                                <om:Property Name="Ref" Value="Job" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Construct" OID="0868f335-782d-4b60-9ac9-82a85589ab0c" ParentLink="ComplexStatement_Statement" LowerBound="501.1" HigherBound="507.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct ZVMRUNSHEET01 Update" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Transform" OID="6c86e23f-df7a-4953-af6d-9144113d2905" ParentLink="ComplexStatement_Statement" LowerBound="504.1" HigherBound="506.1">
                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Maps.MultipartJob_to_ZVMRUNSHEET01" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="GetJobResponse_to_ZVMRUNSHEET01" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="MessagePartRef" OID="6667c216-4e29-44f0-94d8-860d49a418c4" ParentLink="Transform_OutputMessagePartRef" LowerBound="505.44" HigherBound="505.70">
                                    <om:Property Name="MessageRef" Value="SapZVMRUNSHEET01_Send" />
                                    <om:Property Name="PartRef" Value="Body" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_6" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessagePartRef" OID="13f06467-ee93-4f6b-9ba0-6c72179dde87" ParentLink="Transform_InputMessagePartRef" LowerBound="505.137" HigherBound="505.155">
                                    <om:Property Name="MessageRef" Value="MessageHeader" />
                                    <om:Property Name="PartRef" Value="Body" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_5" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessagePartRef" OID="71d6d765-d3aa-4344-9570-aaf281e2ae96" ParentLink="Transform_InputMessagePartRef" LowerBound="505.157" HigherBound="505.165">
                                    <om:Property Name="MessageRef" Value="Job" />
                                    <om:Property Name="PartRef" Value="Body" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_12" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="MessageRef" OID="7b1a84fb-bdeb-4cf2-b32e-d6a62bbcb7f0" ParentLink="Construct_MessageRef" LowerBound="502.39" HigherBound="502.60">
                                <om:Property Name="Ref" Value="SapZVMRUNSHEET01_Send" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="MessageDeclaration" OID="0be331e7-eeba-45bf-9126-f68dc165edf6" ParentLink="Scope_MessageDeclaration" LowerBound="444.1" HigherBound="445.1">
                            <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.GetJob_ResponseType" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="GetJobResponse" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="MessageDeclaration" OID="bf8768fe-7900-4def-aad9-a9fcef2016c3" ParentLink="Scope_MessageDeclaration" LowerBound="445.1" HigherBound="446.1">
                            <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.GetJob_RequestType" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="GetJobRequest" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="MessageDeclaration" OID="6531a3bb-aad2-4eaa-af43-e6b2aa44ceba" ParentLink="Scope_MessageDeclaration" LowerBound="446.1" HigherBound="447.1">
                            <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.Job_Type" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Job" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="MessageDeclaration" OID="ab8f9509-e113-4aa8-86b7-297d47395c8f" ParentLink="Scope_MessageDeclaration" LowerBound="447.1" HigherBound="448.1">
                            <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.MessageHeader_Type" />
                            <om:Property Name="ParamDirection" Value="In" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="MessageHeader" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Send" OID="887f98ba-c8f5-4148-9ae9-31b1b0c4cbe9" ParentLink="ComplexStatement_Statement" LowerBound="509.1" HigherBound="511.1">
                        <om:Property Name="PortName" Value="SapIdocSend_Port" />
                        <om:Property Name="MessageName" Value="SapZVMRUNSHEET01_Send" />
                        <om:Property Name="OperationName" Value="Send" />
                        <om:Property Name="OperationMessageName" Value="Request" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Send Response" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="6301165d-3667-42d6-9b39-94e56d211e56" ParentLink="ComplexStatement_Statement" LowerBound="511.1" HigherBound="517.1">
                        <om:Property Name="Expression" Value="System.Diagnostics.Trace.WriteLine(&#xD;&#xA;    System.String.Format(&quot;{0}: Finished processing Idoc number \&quot;{1}\&quot;.&quot;,&#xD;&#xA;    Microsoft.XLANGs.Core.Service.RootService.Name,&#xD;&#xA;    idocNumber)&#xD;&#xA;    );" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Log completed processing" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableDeclaration" OID="e41cf355-93c6-4244-b3fb-d96e281d380a" ParentLink="Scope_VariableDeclaration" LowerBound="191.1" HigherBound="192.1">
                        <om:Property Name="UseDefaultConstructor" Value="False" />
                        <om:Property Name="Type" Value="System.String" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="xquery" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableDeclaration" OID="2023ed9c-c6d1-4a28-b9a8-3b4e4056107a" ParentLink="Scope_VariableDeclaration" LowerBound="192.1" HigherBound="193.1">
                        <om:Property Name="UseDefaultConstructor" Value="False" />
                        <om:Property Name="Type" Value="System.String" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="RunsheetStatus" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="VariableDeclaration" OID="ed4a6fc8-2787-46d3-97a8-68981a23fa7f" ParentLink="Scope_VariableDeclaration" LowerBound="193.1" HigherBound="194.1">
                        <om:Property Name="UseDefaultConstructor" Value="False" />
                        <om:Property Name="Type" Value="System.String" />
                        <om:Property Name="ParamDirection" Value="In" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Sender" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Catch" OID="10e9f150-26e8-4f59-a173-e10b1cafcfd5" ParentLink="Scope_Catch" LowerBound="520.1" HigherBound="610.1">
                        <om:Property Name="ExceptionName" Value="ex" />
                        <om:Property Name="ExceptionType" Value="System.Exception" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Catch .Net Exception" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Construct" OID="03074cdd-1179-4ca4-82a8-96a1b7a4c724" ParentLink="Catch_Statement" LowerBound="523.1" HigherBound="600.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructExceptionEmail" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="e9cb8a0e-f65e-414f-b374-75faf620d766" ParentLink="ComplexStatement_Statement" LowerBound="526.1" HigherBound="599.1">
                                <om:Property Name="Expression" Value="//Build HTML Message body&#xD;&#xA;sbMsgBody = new System.Text.StringBuilder();&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;html&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;head&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/head&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;body&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;p&gt;&lt;/p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;IDoc No:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(idocNumber);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Date of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(System.DateTime.Now.ToShortDateString());&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Time of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Status:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(sStatus);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Route:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(sRoute);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Route Description:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(sRouteDescription);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Device Id:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(sDeviceId);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Runsheet No:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(rsNumber);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Runsheet Date:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(sRunsheetDate);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Runsheet Date To:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(sRunsheetDateTo);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Exception:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(ex.Message);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Processing Server:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(System.Environment.MachineName);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/body&gt;&quot;);&#xD;&#xA;sbMsgBody.AppendLine(&quot;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;//Set Email Properties&#xD;&#xA;EmailException.MsgBody = new Visy.Middleware.SAP.MTData.Components.RawString(sbMsgBody.ToString());&#xD;&#xA;EmailException.MsgBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;EmailException(SMTP.Subject) = &quot;Outbound MTData &quot; + sStatus + &quot; JOB failed in BizTalk Server: &quot; + System.Environment.MachineName + &quot; (&quot; + Recipient + &quot;)&quot;;&#xD;&#xA;&#xD;&#xA;EmailException(SMTP.From) = &quot;webitadmin@visy.com.au&quot;;&#xD;&#xA;EmailException(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment_1" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="32003932-6c46-4972-a713-664eec5b32c7" ParentLink="Construct_MessageRef" LowerBound="524.35" HigherBound="524.49">
                                <om:Property Name="Ref" Value="EmailException" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="3c87e617-70c6-4cb0-86e5-9ccb3a3adcc3" ParentLink="Catch_Statement" LowerBound="600.1" HigherBound="602.1">
                            <om:Property Name="PortName" Value="SMTPExceptionSend_Port" />
                            <om:Property Name="MessageName" Value="EmailException" />
                            <om:Property Name="OperationName" Value="SendEmail" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send Exception Email" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Suspend" OID="2fcd3e99-dd00-4bfb-908d-7bbd7723854f" ParentLink="Catch_Statement" LowerBound="602.1" HigherBound="607.1">
                            <om:Property Name="ErrorMessage" Value="&quot;Processing of Idoc \&quot;&quot; + idocNumber + &quot;\&quot; encountered an exception and has been suspended. Resume this instance to retry&quot; &#xD;&#xA;    + System.Environment.NewLine&#xD;&#xA;    + &quot;Exception details: &quot;&#xD;&#xA;    + ex.Message;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Suspend before resubmit" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Send" OID="83b48dae-42f7-4e24-8a82-2ecb225e2787" ParentLink="Catch_Statement" LowerBound="607.1" HigherBound="609.1">
                            <om:Property Name="PortName" Value="SapIdocResubmit_Port" />
                            <om:Property Name="MessageName" Value="SapZVMRUNSHEET01_Receive" />
                            <om:Property Name="OperationName" Value="Resubmit" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send idoc for Resubmit" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="bbdcbffc-1f14-4bff-be88-dbf36d6f8027" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="145.1" HigherBound="147.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.SapIdocReceive_PortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SapIdocReceive_Port" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="ff6caf26-0a9c-4232-91e1-2bb307671b2d" ParentLink="PortDeclaration_CLRAttribute" LowerBound="145.1" HigherBound="146.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="58696c41-6a2b-41df-a6af-67ef200d0b72" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="147.1" HigherBound="149.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="104" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.MTDataWebService_PortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MTDataWebService_Port" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="a2ba9ddd-049e-473e-ab29-bdbe20938a02" ParentLink="PortDeclaration_CLRAttribute" LowerBound="147.1" HigherBound="148.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="f834b62a-895b-4fe6-ba77-73589a420b62" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="149.1" HigherBound="151.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="197" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.SapIdocSend_PortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SapIdocSend_Port" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="fa9a5e06-c290-49a6-a219-b77d5cf16ec3" ParentLink="PortDeclaration_CLRAttribute" LowerBound="149.1" HigherBound="150.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="b8ff3563-d9d4-45f4-92f2-486b3629c99b" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="151.1" HigherBound="153.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="221" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.SapIdocResubmit_PortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SapIdocResubmit_Port" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="d518d1fb-42b1-40c4-bf75-69292d51c61f" ParentLink="PortDeclaration_CLRAttribute" LowerBound="151.1" HigherBound="152.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="100fda88-1ddd-4fc8-8244-da39b7fbea61" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="153.1" HigherBound="155.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="220" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.MTData.Orchestrations.SMTPExceptionSend_PortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SMTPExceptionSend_Port" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="775b3eb7-75b3-4f15-8b7b-9a6fdb18ce53" ParentLink="PortDeclaration_CLRAttribute" LowerBound="153.1" HigherBound="154.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="e6ecd4d5-8712-4f7e-b4a8-7e37eec0e569" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="8.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SaveJob_ResponseType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="5a910d60-3264-47b7-af0e-7fe0d6b7c468" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.SaveJobResponse" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="956ca7a1-0e15-4266-b06d-1fb7624119dc" ParentLink="Module_MessageType" LowerBound="8.1" HigherBound="12.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SaveJob_RequestType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="398f1f4d-26a5-4f9b-8e7a-01a69a91f86a" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="10.1" HigherBound="11.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.SaveJob" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="be08f8e7-ee53-4205-93bb-8d8cbab4e52e" ParentLink="Module_MessageType" LowerBound="12.1" HigherBound="16.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SapZVMRUNSHEET01_ReceiveType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="bda59283-44d6-4385-bd65-e48b8ada7ee8" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="14.1" HigherBound="15.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.Common.Schemas.SAP.ZVMRunsheet.IDocOperation_ZVMRUNSHEET01_620_3_Receive" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="92a09ded-f094-43b5-95b0-15de44c1afc3" ParentLink="Module_MessageType" LowerBound="16.1" HigherBound="20.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="CreateNewJob_RequestType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="b1f7668b-0c91-41ce-8eac-d94ff131e5ba" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="18.1" HigherBound="19.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CreateNewJob" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="d1d29b85-5841-4c5f-9333-2d3f538bc36a" ParentLink="Module_MessageType" LowerBound="20.1" HigherBound="24.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="CreateNewJob_ResponseType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="cf5c34cf-79bc-4bc5-b5f0-c19677a5b5b6" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="22.1" HigherBound="23.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CreateNewJobResponse" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="6f6740de-f3c5-41cd-9030-75e62b2a7461" ParentLink="Module_MessageType" LowerBound="24.1" HigherBound="28.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="CheckLogin_RequestType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="358414c2-f48b-4b6e-8531-f5232ca8b431" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="26.1" HigherBound="27.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CheckLogin" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="07de8472-7ae1-4132-aa1a-5c8e99fea1b4" ParentLink="Module_MessageType" LowerBound="28.1" HigherBound="32.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="CheckLogin_ResponseType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="f83651ab-a4a9-4558-9ce3-7a5584e2b644" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="30.1" HigherBound="31.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CheckLoginResponse" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="a088fe13-c943-4033-a82e-14c1c2cbbf10" ParentLink="Module_MessageType" LowerBound="32.1" HigherBound="36.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="GetJob_RequestType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="0fa55b23-e322-4c2c-89c6-affe84faa5e1" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="34.1" HigherBound="35.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.GetJob" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="c4a7fd5f-73fe-44ae-b32a-af5d3d094a65" ParentLink="Module_MessageType" LowerBound="36.1" HigherBound="40.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="GetJob_ResponseType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="25e39f81-630d-4b6a-b5ff-558d29dcef79" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="38.1" HigherBound="39.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.GetJobResponse" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="b06d2cd1-246d-431d-8a7a-62cf09d5f5bd" ParentLink="Module_MessageType" LowerBound="40.1" HigherBound="44.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SapZVMRUNSHEET01_SendType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="3f12f78a-e1c1-4795-be5e-eb61125b6caa" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="42.1" HigherBound="43.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.Common.Schemas.SAP.ZVMRunsheet.IDocOperation_ZVMRUNSHEET01_620_3_Send" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="77535778-eaec-4bab-87ed-4b69fb49fb3b" ParentLink="Module_MessageType" LowerBound="44.1" HigherBound="48.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="Settings_Type" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="cb70aa8d-8a6c-4dd0-831e-2c94b70a1a64" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="46.1" HigherBound="47.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.KeyValueSet" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="edcbad8f-b367-45b8-8c49-ba54259ebf1b" ParentLink="Module_MessageType" LowerBound="48.1" HigherBound="52.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="Job_Type" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="bf80b8a2-415b-41ed-a3df-d550b55b2202" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="50.1" HigherBound="51.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.JobSchema" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="10cea8c1-8d96-48c3-b4ba-2ae1b952d979" ParentLink="Module_MessageType" LowerBound="52.1" HigherBound="56.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MessageHeader_Type" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="a7049c1f-c6d5-47a4-bf9c-dd8c5801c14e" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="54.1" HigherBound="55.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.MTDataMessageHeader.MessageHeader" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="258cf85c-8ef9-48f9-81ef-585dcb389336" ParentLink="Module_MessageType" LowerBound="56.1" HigherBound="60.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="EmailExceptionType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="610aeb49-8929-4304-aa8a-e5f73c679a9d" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="58.1" HigherBound="59.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Components.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MsgBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="9a325625-572e-4437-b6e9-201b7acaafaa" ParentLink="Module_MessageType" LowerBound="60.1" HigherBound="64.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="CancelJob_RequestType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="b73befd7-d5f7-4dd2-bc54-2feaf4b235b6" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="62.1" HigherBound="63.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CancelJob" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="4c8293c1-14c5-40e7-9887-09dc846322e7" ParentLink="Module_MessageType" LowerBound="64.1" HigherBound="68.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="CancelJob_ResponseType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="f3949197-983c-4082-9254-1628841e4107" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="66.1" HigherBound="67.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CancelJobResponse" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="9fed87f8-a8b0-4719-a9a8-e6ea06869742" ParentLink="Module_MessageType" LowerBound="68.1" HigherBound="72.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="AssignJobToVehicle_RequestType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="30f5b47a-0a57-4e00-9f50-33b85d21e60e" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="70.1" HigherBound="71.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.AssignJobToVehicle" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="caa185be-a6e8-4f16-9a03-c9d77d9d0909" ParentLink="Module_MessageType" LowerBound="72.1" HigherBound="76.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="AssignJobToVehicle_ResponseType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="9f7168d2-2ee3-4fd9-921e-9a793a0e54cc" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="74.1" HigherBound="75.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.AssignJobToVehicleResponse" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="bbc34776-2697-4456-a08b-facddeabcc4a" ParentLink="Module_PortType" LowerBound="76.1" HigherBound="83.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SapIdocReceive_PortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="a72fe090-b417-441b-8e0c-b92c7d2c2ff0" ParentLink="PortType_OperationDeclaration" LowerBound="78.1" HigherBound="82.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Receive" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="e9160183-5fd3-4737-82fa-35f727c7434b" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="80.13" HigherBound="80.41">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.SapZVMRUNSHEET01_ReceiveType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="6b2cce25-25c9-49a0-b485-421eaf34a6cb" ParentLink="Module_PortType" LowerBound="83.1" HigherBound="110.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MTDataWebService_PortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="b861892a-1e19-439c-a5e8-4b4bccb14638" ParentLink="PortType_OperationDeclaration" LowerBound="85.1" HigherBound="89.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CreateNewJob" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="7b3aca94-e9b4-4b33-b50d-d65667eae0dc" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="87.13" HigherBound="87.37">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.CreateNewJob_RequestType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="60e6ba32-6b11-41e7-ab9c-94b410dca2df" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="87.39" HigherBound="87.64">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.CreateNewJob_ResponseType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="OperationDeclaration" OID="35356e37-f9c1-4642-ba4b-7b5fcde0b80d" ParentLink="PortType_OperationDeclaration" LowerBound="89.1" HigherBound="93.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SaveJob" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="6bba7a32-9560-4d8d-98d1-0c5f2fb4ca07" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="91.34" HigherBound="91.54">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.SaveJob_ResponseType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="ea98d1b7-0cfa-4e4c-993f-73f9cbd09cfa" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="91.13" HigherBound="91.32">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.SaveJob_RequestType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
            <om:Element Type="OperationDeclaration" OID="a6552a69-d5dd-41c0-a00d-b8c92526e2ca" ParentLink="PortType_OperationDeclaration" LowerBound="93.1" HigherBound="97.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CheckLogin" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="9343c3bb-881e-4bd8-8b1b-65b2fa40d197" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="95.37" HigherBound="95.60">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.CheckLogin_ResponseType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="1cf30421-22d1-4241-85f5-c6616e2139a6" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="95.13" HigherBound="95.35">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.CheckLogin_RequestType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
            <om:Element Type="OperationDeclaration" OID="29ba9dc2-8b49-4b76-8556-2fa8dfc68e9e" ParentLink="PortType_OperationDeclaration" LowerBound="97.1" HigherBound="101.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="GetJob" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="af55d9af-ffef-4f4f-8298-43b38f044450" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="99.13" HigherBound="99.31">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.GetJob_RequestType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="636288dd-e651-45e4-9a3e-cc501200e485" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="99.33" HigherBound="99.52">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.GetJob_ResponseType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
            <om:Element Type="OperationDeclaration" OID="2b5b8566-f99c-4b3f-85b3-5af73a0d67d2" ParentLink="PortType_OperationDeclaration" LowerBound="101.1" HigherBound="105.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CancelJob" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="1df2a7c1-2783-49e1-b8f1-b32e0368f4d4" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="103.36" HigherBound="103.58">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.CancelJob_ResponseType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="091ac2a6-fd58-4434-822d-a7861957a12b" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="103.13" HigherBound="103.34">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.CancelJob_RequestType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
            <om:Element Type="OperationDeclaration" OID="3db7cc87-831b-4109-bbf8-3c6c28f17622" ParentLink="PortType_OperationDeclaration" LowerBound="105.1" HigherBound="109.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="AssignJobToVehicle" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="624249c6-1393-4015-9c70-b76bad7acb4e" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="107.13" HigherBound="107.43">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.AssignJobToVehicle_RequestType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="2554f5f5-3da7-4d40-aa8b-ffccc4ebf64a" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="107.45" HigherBound="107.76">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.AssignJobToVehicle_ResponseType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="a31abb75-d47e-4ca2-add3-624e08552f75" ParentLink="Module_PortType" LowerBound="110.1" HigherBound="121.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="AuditResponse_PortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="c71ee2f0-67a4-4f6f-b991-69f493fbc634" ParentLink="PortType_OperationDeclaration" LowerBound="112.1" HigherBound="116.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="e0f15b2d-6a01-4080-ab17-790aaa3c3b26" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="114.13" HigherBound="114.38">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.CreateNewJob_ResponseType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="OperationDeclaration" OID="3df70c4e-508d-40fd-862d-02d4686528a6" ParentLink="PortType_OperationDeclaration" LowerBound="116.1" HigherBound="120.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_2" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="a115a58e-26ae-49bb-8e5b-387dd1ca42b8" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="118.13" HigherBound="118.33">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.SaveJob_ResponseType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="13192243-0a99-4fea-80c8-7e02d1cd0891" ParentLink="Module_PortType" LowerBound="121.1" HigherBound="128.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SapIdocSend_PortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="756381a0-e24a-4ec1-8ab8-71685eb65190" ParentLink="PortType_OperationDeclaration" LowerBound="123.1" HigherBound="127.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Send" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="47fe1590-b193-49ea-b7e0-cfd2a85765bd" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="125.13" HigherBound="125.38">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.SapZVMRUNSHEET01_SendType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="616eafa0-d815-4890-920c-38e9b67eaacc" ParentLink="Module_PortType" LowerBound="128.1" HigherBound="135.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SapIdocResubmit_PortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="ef551a1d-fe7d-4b02-aede-0554982ad1ad" ParentLink="PortType_OperationDeclaration" LowerBound="130.1" HigherBound="134.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Resubmit" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="16b7c197-e107-4ef7-bf25-b51df5c13ac9" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="132.13" HigherBound="132.41">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.SapZVMRUNSHEET01_ReceiveType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="781a9a56-1058-4343-9d61-12364e24c910" ParentLink="Module_PortType" LowerBound="135.1" HigherBound="142.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SMTPExceptionSend_PortType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="c2955d9e-a8a2-4a0e-9caa-07a08f87d3a4" ParentLink="PortType_OperationDeclaration" LowerBound="137.1" HigherBound="141.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SendEmail" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="20f386d3-bc43-45ce-b5bf-c6d3d22d1b9d" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="139.13" HigherBound="139.31">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.MTData.Orchestrations.EmailExceptionType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module Visy.Middleware.SAP.MTData.Orchestrations
{
    internal messagetype SaveJob_ResponseType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.SaveJobResponse Body;
    };
    internal messagetype SaveJob_RequestType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.SaveJob Body;
    };
    internal messagetype SapZVMRUNSHEET01_ReceiveType
    {
        body Visy.Middleware.Common.Schemas.SAP.ZVMRunsheet.IDocOperation_ZVMRUNSHEET01_620_3_Receive Body;
    };
    internal messagetype CreateNewJob_RequestType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CreateNewJob Body;
    };
    internal messagetype CreateNewJob_ResponseType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CreateNewJobResponse Body;
    };
    internal messagetype CheckLogin_RequestType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CheckLogin Body;
    };
    internal messagetype CheckLogin_ResponseType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CheckLoginResponse Body;
    };
    internal messagetype GetJob_RequestType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.GetJob Body;
    };
    internal messagetype GetJob_ResponseType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.GetJobResponse Body;
    };
    internal messagetype SapZVMRUNSHEET01_SendType
    {
        body Visy.Middleware.Common.Schemas.SAP.ZVMRunsheet.IDocOperation_ZVMRUNSHEET01_620_3_Send Body;
    };
    internal messagetype Settings_Type
    {
        body Visy.Middleware.SAP.MTData.Schemas.KeyValueSet Body;
    };
    internal messagetype Job_Type
    {
        body Visy.Middleware.SAP.MTData.Schemas.JobSchema Body;
    };
    internal messagetype MessageHeader_Type
    {
        body Visy.Middleware.SAP.MTData.Schemas.MTDataMessageHeader.MessageHeader Body;
    };
    internal messagetype EmailExceptionType
    {
        body Visy.Middleware.SAP.MTData.Components.RawString MsgBody;
    };
    internal messagetype CancelJob_RequestType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CancelJob Body;
    };
    internal messagetype CancelJob_ResponseType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.CancelJobResponse Body;
    };
    internal messagetype AssignJobToVehicle_RequestType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.AssignJobToVehicle Body;
    };
    internal messagetype AssignJobToVehicle_ResponseType
    {
        body Visy.Middleware.SAP.MTData.Schemas.WebServiceSchema.AssignJobToVehicleResponse Body;
    };
    internal porttype SapIdocReceive_PortType
    {
        oneway Receive
        {
            SapZVMRUNSHEET01_ReceiveType
        };
    };
    internal porttype MTDataWebService_PortType
    {
        requestresponse CreateNewJob
        {
            CreateNewJob_RequestType, CreateNewJob_ResponseType
        };
        requestresponse SaveJob
        {
            SaveJob_RequestType, SaveJob_ResponseType
        };
        requestresponse CheckLogin
        {
            CheckLogin_RequestType, CheckLogin_ResponseType
        };
        requestresponse GetJob
        {
            GetJob_RequestType, GetJob_ResponseType
        };
        requestresponse CancelJob
        {
            CancelJob_RequestType, CancelJob_ResponseType
        };
        requestresponse AssignJobToVehicle
        {
            AssignJobToVehicle_RequestType, AssignJobToVehicle_ResponseType
        };
    };
    internal porttype AuditResponse_PortType
    {
        oneway Operation_1
        {
            CreateNewJob_ResponseType
        };
        oneway Operation_2
        {
            SaveJob_ResponseType
        };
    };
    internal porttype SapIdocSend_PortType
    {
        oneway Send
        {
            SapZVMRUNSHEET01_SendType
        };
    };
    internal porttype SapIdocResubmit_PortType
    {
        oneway Resubmit
        {
            SapZVMRUNSHEET01_ReceiveType
        };
    };
    internal porttype SMTPExceptionSend_PortType
    {
        oneway SendEmail
        {
            EmailExceptionType
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service CreateOrSaveJobAgent
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements SapIdocReceive_PortType SapIdocReceive_Port;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses MTDataWebService_PortType MTDataWebService_Port;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses SapIdocSend_PortType SapIdocSend_Port;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses SapIdocResubmit_PortType SapIdocResubmit_Port;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses SMTPExceptionSend_PortType SMTPExceptionSend_Port;
        message SapZVMRUNSHEET01_ReceiveType SapZVMRUNSHEET01_Receive;
        message SapZVMRUNSHEET01_SendType SapZVMRUNSHEET01_Send;
        message EmailExceptionType EmailException;
        System.String Username;
        System.String Password;
        System.Int32 UserId;
        System.Int32 dispatchId;
        System.String idocNumber;
        System.Text.StringBuilder sbMsgBody;
        System.String rsNumber;
        System.String sStatus;
        System.String sRoute;
        System.String sRouteDescription;
        System.String sDeviceId;
        System.String sRunsheetDate;
        System.String sRunsheetDateTo;
        System.String Recipient;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9a8f52da-79ed-4485-86f5-0f812db6a8c0")]
            activate receive (SapIdocReceive_Port.Receive, SapZVMRUNSHEET01_Receive);
            Username = "";
            Password = "";
            idocNumber = "";
            sbMsgBody = new System.Text.StringBuilder();
            rsNumber = "";
            sStatus = "";
            sRoute = "";
            sRouteDescription = "";
            sDeviceId = "";
            sRunsheetDate = "";
            sRunsheetDateTo = "";
            Recipient = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("573c37bb-238c-4d5f-aa56-59d576032173")]
            scope
            {
                System.String xquery;
                System.String RunsheetStatus;
                System.String Sender;
                body
                {
                    xquery = "";
                    RunsheetStatus = "";
                    Sender = "";
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("43f7dbf1-dfed-4078-80fc-6116ff7a7fe6")]
                    RunsheetStatus = SapZVMRUNSHEET01_Receive(Visy.Middleware.Common.Schemas.SAP.ZVMRunsheet.Status);
                    System.Diagnostics.EventLog.WriteEntry("SAP.MTData", RunsheetStatus);
                    xquery = "string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='EDI_DC40']/*[local-name()='DOCNUM'])";
                    idocNumber = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);
                    
                    xquery = "string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='STATUS'])";
                    sStatus = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);
                    
                    xquery = "string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='ROUTE'])";
                    sRoute = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);
                    
                    xquery = "string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='RTE_DESC'])";
                    sRouteDescription = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);
                    
                    xquery = "string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='DEVICE_ID'])";
                    sDeviceId = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);
                    
                    xquery = "string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='RS_DATE'])";
                    sRunsheetDate = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);
                    
                    xquery = "string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='RS_DATE_TO'])";
                    sRunsheetDateTo = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);
                    
                    
                    
                    
                    
                    
                    xquery = "string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='RS_NUMBER'])";
                    rsNumber = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);
                    
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c83c4c22-3199-49d6-a9c7-8c1b55cd4c10")]
                    scope
                    {
                        message CheckLogin_RequestType CheckLoginRequest;
                        message CheckLogin_ResponseType CheckLoginResponse;
                        message Settings_Type Settings;
                        System.String unencodedPassword;
                        body
                        {
                            unencodedPassword = "";
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5657e784-ec86-463b-a13f-95ac7d90d270")]
                            construct Settings
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("457654ec-afc1-4451-9535-8bbb4e5dfb04")]
                                Settings.Body = Visy.Middleware.SAP.MTData.Components.MessageHelper.CreateSettingsMessage();
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("057de582-496f-477c-b55b-7b1a7aac1faf")]
                            // Get the current Username value from the Settings document
                            //xquery="string(/*[local-name()='KeyValueSet']/*[local-name()='KeyValue'][Key='Username']/*[local-name()='Value'])";
                            Username = Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData("UserName", "SAP.MTData");//xpath(Settings.Body, xquery);
                            
                            // Get the unencoded Password value from the Settings document
                            //xquery="string(/*[local-name()='KeyValueSet']/*[local-name()='KeyValue'][Key='Password']/*[local-name()='Value'])";
                            unencodedPassword =  Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData("Password", "SAP.MTData");//xpath(Settings.Body, xquery);
                            
                            //xquery="string(/*[local-name()='KeyValueSet']/*[local-name()='KeyValue'][Key='Sender']/*[local-name()='Value'])";
                            Sender = Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData("Sender", "SAP.MTData");//xpath(Settings.Body, xquery);
                            
                            //xquery="string(/*[local-name()='KeyValueSet']/*[local-name()='KeyValue'][Key='Recipient']/*[local-name()='Value'])";
                            Recipient = Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData("Recipient", "SAP.MTData");//xpath(Settings.Body, xquery);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("89e3bdfc-7553-45dd-bbea-f3b3323db1a8")]
                            // Encode the password, so it's not transmitted in plaintext
                            Password = Visy.Middleware.SAP.MTData.Components.CredentialsHelper.EncodePassword(unencodedPassword);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a4270a42-ebac-447f-bb29-6dd74ad64a12")]
                            construct CheckLoginRequest
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("2b0e811a-ea9d-4ec5-b5b2-4dc271c39d9d")]
                                CheckLoginRequest.Body = Visy.Middleware.SAP.MTData.Components.MessageHelper.CreateCheckLoginMessage(Username, Password);
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1db5cd54-b21a-4094-bf50-fd78c3759f71")]
                            UserId = 1;//CheckLoginResponse.Body.CheckLoginResult;
                            System.Diagnostics.EventLog.WriteEntry("SAP.MTData", RunsheetStatus);
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("690caf6d-8f60-4085-9c81-ca7cbd3efa08")]
                    if (RunsheetStatus == "CREATED")
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1d5f2eef-3975-4940-aaed-cb2a345b2187")]
                        scope
                        {
                            message CreateNewJob_ResponseType CreateNewJobResponse;
                            message CreateNewJob_RequestType CreateNewJobRequest;
                            message Job_Type Job;
                            System.Xml.XmlDocument xdoc;
                            body
                            {
                                xdoc = new System.Xml.XmlDocument();
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("fd86b35f-5eb3-4c09-b3bb-f77d9e26a673")]
                                construct CreateNewJobRequest, Job
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8b69e900-fa31-4f96-bef6-6e8f6ccf988b")]
                                    transform (Job.Body) = Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_Job (SapZVMRUNSHEET01_Receive.Body);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("2fd2af7a-e443-4205-b5d6-219f6820f504")]
                                    transform (CreateNewJobRequest.Body) = Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_CreateNewJob (SapZVMRUNSHEET01_Receive.Body);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7d09a51e-d429-4c4e-b69b-225de8e5afde")]
                                    CreateNewJobRequest.Body.appCredentials.UserID = UserId;
                                    CreateNewJobRequest.Body.appCredentials.Username = Username;
                                    CreateNewJobRequest.Body.appCredentials.Password = Password;
                                    
                                    CreateNewJobRequest.Body.xml = Visy.Middleware.SAP.MTData.Components.MessageHelper.MessageToXml(Job.Body);
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("11fd9ba1-9f51-4832-9481-37d444299898")]
                                send (MTDataWebService_Port.CreateNewJob, CreateNewJobRequest);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("17c95b5f-4bff-4dc8-ac24-ce44ecee22d2")]
                                receive (MTDataWebService_Port.CreateNewJob, CreateNewJobResponse);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b15c1ad5-89d0-43b7-9d29-3ad25885f010")]
                                dispatchId = System.Convert.ToInt32(
                                    Visy.Middleware.SAP.MTData.Components.MessageHelper.ExtractReturnValue(
                                    CreateNewJobResponse.Body.CreateNewJobResult,
                                    "/*[local-name()='Job']/*[local-name()='DispatchId']",
                                    "CreateNewJobResponse")
                                    );
                            }
                        }
                    }
                    else if (RunsheetStatus == "CANCEL")
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("09148475-dbdd-4018-a831-a19bab8e6194")]
                        scope
                        {
                            message CancelJob_RequestType CancelJobRequest;
                            message CancelJob_ResponseType CancelJobResponse;
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("31d921fd-8eb9-4229-882e-d5b9f47ba011")]
                                construct CancelJobRequest
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("90833af7-6dfd-47b0-ad32-fe154e7cd741")]
                                    transform (CancelJobRequest.Body) = Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_CancelJob (SapZVMRUNSHEET01_Receive.Body);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("31a6efd7-9efb-4536-ab86-a2a3db4b18ed")]
                                    CancelJobRequest.Body.appCredentials.UserID = UserId;
                                    CancelJobRequest.Body.appCredentials.Username = Username;
                                    CancelJobRequest.Body.appCredentials.Password = Password;
                                    
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("e22d80d9-cc8b-4edd-a1ea-da4d93743ad8")]
                                send (MTDataWebService_Port.CancelJob, CancelJobRequest);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("1e87d978-2dc2-43af-9978-c4f6e6170933")]
                                receive (MTDataWebService_Port.CancelJob, CancelJobResponse);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("6bbeb270-1b26-42e3-9fcf-4785333f469c")]
                                dispatchId = System.Convert.ToInt32(
                                    Visy.Middleware.SAP.MTData.Components.MessageHelper.ExtractReturnValue(
                                    CancelJobResponse.Body.CancelJobResult,
                                    "/*[local-name()='Job']/*[local-name()='DispatchId']",
                                    "CreateNewJobResponse")
                                    );
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("8870b45f-bcf4-4aa1-a863-6e8a9b8499e7")]
                                terminate "Cancel Job Successful";;
                            }
                        }
                    }
                    else if (RunsheetStatus == "ASSIGN")
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("393f2d79-db5f-47f4-9ba2-689599ee91e4")]
                        scope
                        {
                            message AssignJobToVehicle_RequestType AssignJobToVehicleRequest;
                            message AssignJobToVehicle_ResponseType AssignJobToVehicleResponse;
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("f1384aed-6ba9-454d-b456-965f1f27f0be")]
                                construct AssignJobToVehicleRequest
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("50248aab-e771-4838-9be6-e6b57d612d12")]
                                    transform (AssignJobToVehicleRequest.Body) = Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_AssignJobToVehicle (SapZVMRUNSHEET01_Receive.Body);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("adc82a98-66b9-46bc-bee1-c5edb37b7c0c")]
                                    AssignJobToVehicleRequest.Body.appCredentials.UserID = UserId;
                                    AssignJobToVehicleRequest.Body.appCredentials.Username = Username;
                                    AssignJobToVehicleRequest.Body.appCredentials.Password = Password;
                                    
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4fd21b9c-5d30-4f1d-b546-f6488e59aa0d")]
                                send (MTDataWebService_Port.AssignJobToVehicle, AssignJobToVehicleRequest);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bdb56149-b7f0-4714-9b24-8930dd3a9c21")]
                                receive (MTDataWebService_Port.AssignJobToVehicle, AssignJobToVehicleResponse);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("f2d6305b-8e68-4541-ab8d-eaaaf2cbd8be")]
                                dispatchId = System.Convert.ToInt32(
                                    Visy.Middleware.SAP.MTData.Components.MessageHelper.ExtractReturnValue(
                                    AssignJobToVehicleResponse.Body.AssignJobToVehicleResult,
                                    "/*[local-name()='Job']/*[local-name()='DispatchId']",
                                    "AssignJobToVehicleResponse")
                                    );
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("6976379e-0a24-4e66-b4f5-b28e25dd2a31")]
                                terminate "Assign Job To Vehicle Successful";;
                            }
                        }
                    }
                    else if (RunsheetStatus == "REFRESH")
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b8270910-a707-42b1-8ac3-996149c71956")]
                        scope
                        {
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("18e89b5b-7277-48ea-a73a-8ed40d2439a1")]
                                xquery = "string(/*[local-name()='Receive']/*[local-name()='idocData']/*[local-name()='ZVMRHDR000GRP']/*[local-name()='ZVMRHDR000']/*[local-name()='EXT_REF'])";
                                dispatchId = xpath(SapZVMRUNSHEET01_Receive.Body, xquery);
                            }
                        }
                    }
                    else 
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6732ee04-6260-40eb-9347-b80767520348")]
                        scope
                        {
                            message SaveJob_ResponseType SaveJobResponse;
                            message SaveJob_RequestType SaveJobRequest;
                            message Job_Type Job;
                            System.Xml.XmlDocument xdoc;
                            body
                            {
                                xdoc = new System.Xml.XmlDocument();
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("2ae9372a-b3b6-4e43-9ca7-276d3dd1664f")]
                                construct SaveJobRequest, Job
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d01e7552-2394-4016-b3d4-1c29aef30469")]
                                    transform (Job.Body) = Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_Job (SapZVMRUNSHEET01_Receive.Body);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("19598a98-ffd8-4d22-be2b-ecb1091d8950")]
                                    transform (SaveJobRequest.Body) = Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_SaveJob (SapZVMRUNSHEET01_Receive.Body);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("3afcd8e9-abd3-4326-92f2-3622d22b644c")]
                                    SaveJobRequest.Body.appCredentials.UserID = UserId;
                                    SaveJobRequest.Body.appCredentials.Username = Username;
                                    SaveJobRequest.Body.appCredentials.Password = Password;
                                    
                                    SaveJobRequest.Body.xml = Visy.Middleware.SAP.MTData.Components.MessageHelper.MessageToXml(Job.Body);
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("57df4b3d-6564-4599-9714-9b085deca7b6")]
                                send (MTDataWebService_Port.SaveJob, SaveJobRequest);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4b229b79-3f38-4f3b-9ca3-4c36e9241523")]
                                receive (MTDataWebService_Port.SaveJob, SaveJobResponse);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bb1c218d-4b46-4c8a-9903-b1e5485343df")]
                                dispatchId = System.Convert.ToInt32(
                                    Visy.Middleware.SAP.MTData.Components.MessageHelper.ExtractReturnValue(
                                    SaveJobResponse.Body.SaveJobResult,
                                    "/*[local-name()='Job']/*[local-name()='DispatchId']",
                                    "SaveJobResponse")
                                    );
                            }
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("3ea71b05-f09f-4200-a478-0430a63cd04c")]
                    scope
                    {
                        message GetJob_ResponseType GetJobResponse;
                        message GetJob_RequestType GetJobRequest;
                        message Job_Type Job;
                        message MessageHeader_Type MessageHeader;
                        System.Xml.XmlDocument xdoc;
                        System.String xml;
                        System.String destination;
                        Visy.Middleware.SAP.MTData.Components.MTDataException destinationNotPopulatedException;
                        body
                        {
                            xdoc = new System.Xml.XmlDocument();
                            xml = "";
                            destination = "";
                            destinationNotPopulatedException = new Visy.Middleware.SAP.MTData.Components.MTDataException();
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e54fa324-b02c-4f20-a1b8-d200a2d662d7")]
                            construct MessageHeader
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("09f49d8a-fdda-4238-8256-9076233855b1")]
                                MessageHeader.Body = Visy.Middleware.SAP.MTData.Components.MessageHelper.CreateMessageHeader(
                                    "Job", 
                                    "1.0.0.0", 
                                    Microsoft.XLANGs.Core.Service.RootService.InstanceId.ToString("D"),
                                    Sender,
                                    Recipient);
                                
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("97a3b474-dece-4180-9c74-e517f3a16c35")]
                            construct GetJobRequest
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("308dda85-e196-4768-87f9-bc497c0ea735")]
                                transform (GetJobRequest.Body) = Visy.Middleware.SAP.MTData.Maps.ZVMRUNSHEET01_to_GetJobRequest (SapZVMRUNSHEET01_Receive.Body);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("25937968-d12f-489c-92e7-2ebc09df084a")]
                                GetJobRequest.Body.appCredentials.UserID = UserId;
                                GetJobRequest.Body.appCredentials.Username = Username;
                                GetJobRequest.Body.appCredentials.Password = Password;
                                
                                GetJobRequest.Body.dispatchId = dispatchId;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("fd86fbd7-1587-4230-9bd9-6e5f00b1482d")]
                            send (MTDataWebService_Port.GetJob, GetJobRequest);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6b526fdd-84c1-4a4f-a0f3-1dbc3790b70c")]
                            receive (MTDataWebService_Port.GetJob, GetJobResponse);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d73348df-3e60-4e62-ae32-d2f08f858a14")]
                            System.Diagnostics.Trace.WriteLine("GetJobResponse Write Start");
                            System.Diagnostics.Trace.WriteLine(GetJobResponse.Body.GetJobResult);
                            System.Diagnostics.Trace.WriteLine("GetJobResponse Write End");
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0253e0c2-27cc-4285-bf91-7550599eec68")]
                            construct Job
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("52411989-984e-462f-83da-42df5a610fc1")]
                                Job.Body = Visy.Middleware.SAP.MTData.Components.MessageHelper.XmlToMessage(
                                    GetJobResponse.Body.GetJobResult,
                                    "Job",
                                    "http://www.mtdata.com.au/integration/services/job/1.0.0");
                                
                                
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0868f335-782d-4b60-9ac9-82a85589ab0c")]
                            construct SapZVMRUNSHEET01_Send
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("6c86e23f-df7a-4953-af6d-9144113d2905")]
                                transform (SapZVMRUNSHEET01_Send.Body) = Visy.Middleware.SAP.MTData.Maps.MultipartJob_to_ZVMRUNSHEET01 (MessageHeader.Body, Job.Body);
                            }
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("887f98ba-c8f5-4148-9ae9-31b1b0c4cbe9")]
                    send (SapIdocSend_Port.Send, SapZVMRUNSHEET01_Send);
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6301165d-3667-42d6-9b39-94e56d211e56")]
                    System.Diagnostics.Trace.WriteLine(
                        System.String.Format("{0}: Finished processing Idoc number \"{1}\".",
                        Microsoft.XLANGs.Core.Service.RootService.Name,
                        idocNumber)
                        );
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("10e9f150-26e8-4f59-a173-e10b1cafcfd5")]
                    catch (System.Exception ex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("03074cdd-1179-4ca4-82a8-96a1b7a4c724")]
                        construct EmailException
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e9cb8a0e-f65e-414f-b374-75faf620d766")]
                            //Build HTML Message body
                            sbMsgBody = new System.Text.StringBuilder();
                            
                            sbMsgBody.AppendLine("<html>");
                            sbMsgBody.AppendLine("<head>");
                            sbMsgBody.AppendLine("</head>");
                            sbMsgBody.AppendLine("<body>");
                            sbMsgBody.AppendLine("<p></p>");
                            
                            sbMsgBody.AppendLine("<table>");
                            
                            sbMsgBody.AppendLine("<tr><td>IDoc No:</td><td>");
                            sbMsgBody.AppendLine(idocNumber);
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("<tr><td>Date of Error:</td><td>");
                            sbMsgBody.AppendLine(System.DateTime.Now.ToShortDateString());
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("<tr><td>Time of Error:</td><td>");
                            sbMsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("<tr><td>Status:</td><td>");
                            sbMsgBody.AppendLine(sStatus);
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("<tr><td>Route:</td><td>");
                            sbMsgBody.AppendLine(sRoute);
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("<tr><td>Route Description:</td><td>");
                            sbMsgBody.AppendLine(sRouteDescription);
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("<tr><td>Device Id:</td><td>");
                            sbMsgBody.AppendLine(sDeviceId);
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("<tr><td>Runsheet No:</td><td>");
                            sbMsgBody.AppendLine(rsNumber);
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("<tr><td>Runsheet Date:</td><td>");
                            sbMsgBody.AppendLine(sRunsheetDate);
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("<tr><td>Runsheet Date To:</td><td>");
                            sbMsgBody.AppendLine(sRunsheetDateTo);
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("<tr><td>Exception:</td><td>");
                            sbMsgBody.AppendLine(ex.Message);
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("<tr><td>Processing Server:</td><td>");
                            sbMsgBody.AppendLine(System.Environment.MachineName);
                            sbMsgBody.AppendLine("</td></tr>");
                            
                            sbMsgBody.AppendLine("</table>");
                            
                            sbMsgBody.AppendLine("</body>");
                            sbMsgBody.AppendLine("</html>");
                            
                            //Set Email Properties
                            EmailException.MsgBody = new Visy.Middleware.SAP.MTData.Components.RawString(sbMsgBody.ToString());
                            EmailException.MsgBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                            EmailException(SMTP.Subject) = "Outbound MTData " + sStatus + " JOB failed in BizTalk Server: " + System.Environment.MachineName + " (" + Recipient + ")";
                            
                            EmailException(SMTP.From) = "webitadmin@visy.com.au";
                            EmailException(SMTP.EmailBodyFileCharset) = "UTF-8";
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3c87e617-70c6-4cb0-86e5-9ccb3a3adcc3")]
                        send (SMTPExceptionSend_Port.SendEmail, EmailException);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2fcd3e99-dd00-4bfb-908d-7bbd7723854f")]
                        suspend "Processing of Idoc \"" + idocNumber + "\" encountered an exception and has been suspended. Resume this instance to retry" 
                                + System.Environment.NewLine
                                + "Exception details: "
                                + ex.Message;
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("83b48dae-42f7-4e24-8a82-2ecb225e2787")]
                        send (SapIdocResubmit_Port.Resubmit, SapZVMRUNSHEET01_Receive);
                    }
                }
            }
        }
    }
}

