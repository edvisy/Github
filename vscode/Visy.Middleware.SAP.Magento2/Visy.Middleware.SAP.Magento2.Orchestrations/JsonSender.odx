#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="205f8b07-21a9-4e9d-b4aa-1aa38438745a" LowerBound="1.1" HigherBound="324.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="Visy.Middleware.SAP.Magento2.Orchestrations" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="69289145-712a-4c78-87be-897430e8d243" ParentLink="Module_PortType" LowerBound="9.1" HigherBound="16.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_JsonStaging" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="ea33940c-c217-4fe4-81a6-75c61a23d5c5" ParentLink="PortType_OperationDeclaration" LowerBound="11.1" HigherBound="15.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Json" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="c50ede8f-f232-4f71-812c-f721db749d05" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="13.13" HigherBound="13.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="27511362-c636-4781-a2a6-b0ccdfd50ef0" ParentLink="Module_PortType" LowerBound="16.1" HigherBound="23.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_JsonReqArchive" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="be93eb77-bd18-438a-bc0d-805c23334564" ParentLink="PortType_OperationDeclaration" LowerBound="18.1" HigherBound="22.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="8ca5ac7f-b7d6-42b2-aa91-3b5ac6b0b187" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="20.13" HigherBound="20.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="8422f1d6-c173-45aa-83ad-77b8d198f483" ParentLink="Module_PortType" LowerBound="23.1" HigherBound="30.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Public" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Send_Request" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="b90bd7a6-f684-4f11-a866-1c8029f0423d" ParentLink="PortType_OperationDeclaration" LowerBound="25.1" HigherBound="29.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="WCF" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="716a78d1-096b-4767-baea-6f8a39d66aca" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="27.13" HigherBound="27.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="0a6232ce-1879-45ca-8360-a1c078a77382" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="27.37" HigherBound="27.59">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="9bdf1815-3096-4cf2-9da8-52bb55006ba1" ParentLink="Module_PortType" LowerBound="30.1" HigherBound="37.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Public" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ValidaitonNotification" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="88c4f5f3-4dd6-4d22-8712-c70c3e01c426" ParentLink="PortType_OperationDeclaration" LowerBound="32.1" HigherBound="36.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SMTP" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="b7b05ca3-19ca-4956-bd04-397cfb7a4396" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="34.13" HigherBound="34.24">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.Magento2.Orchestrations.m_EmailPart" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="f13b0ab3-0c17-47f3-9547-7df99740530b" ParentLink="Module_ServiceDeclaration" LowerBound="37.1" HigherBound="323.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="JsonSender" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="VariableDeclaration" OID="32828836-a53a-4aa4-8640-27a8b74ef67a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="50.1" HigherBound="51.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="v_FileName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="5945d2ac-1ba0-4410-b1ed-58a49732d8f6" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="51.1" HigherBound="52.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="v_TempString" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="909288d8-f47c-419d-afa0-94f22c0cbaa4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="52.1" HigherBound="53.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="v_RefId" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d730b097-94ca-44d6-b505-55ce868235c8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="53.1" HigherBound="54.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="v_XmlDocument" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7db3f66b-1fe9-4f6b-9e26-16804db7474a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="54.1" HigherBound="55.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="v_Resp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4bf61b64-8849-408b-814f-0c32a8453988" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="46.1" HigherBound="47.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msg_JsonData" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e73b166d-81bf-499a-a063-438087389200" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="47.1" HigherBound="48.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msg_JsonDataReq" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="62135243-63ae-4e88-9e3e-5b1aed194baa" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="48.1" HigherBound="49.1">
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msg_Resp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2d35ce0b-8fce-4aa8-ba10-2c1b9b878f42" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="49.1" HigherBound="50.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Magento2.Orchestrations.m_EmailPart" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="m_Email" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="e043bcea-0da7-40ed-b34a-a6ca658a4b18" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="83f2e3b9-0ffd-4c4e-9e0f-79eab53a2691" ParentLink="ServiceBody_Statement" LowerBound="57.1" HigherBound="64.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Port_JsonStaging" />
                    <om:Property Name="MessageName" Value="msg_JsonData" />
                    <om:Property Name="OperationName" Value="Json" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Rcv_Json" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Send" OID="78aaa6df-0ffc-4b57-8682-23897c0f33c9" ParentLink="ServiceBody_Statement" LowerBound="64.1" HigherBound="66.1">
                    <om:Property Name="PortName" Value="Port_JsonReqArchive" />
                    <om:Property Name="MessageName" Value="msg_JsonData" />
                    <om:Property Name="OperationName" Value="Archive" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Send_Archive" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="VariableAssignment" OID="73b116e0-8af6-4908-9af3-ed72aa947ab7" ParentLink="ServiceBody_Statement" LowerBound="66.1" HigherBound="80.1">
                    <om:Property Name="Expression" Value="&#xD;&#xA;v_TempString = msg_JsonData(FILE.ReceivedFileName);&#xD;&#xA;v_TempString = v_TempString.Substring(v_TempString.IndexOf(&quot;json.&quot;)+5); &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;v_FileName = v_TempString.Substring(0,v_TempString.IndexOf(&quot;.&quot;));&#xD;&#xA;v_RefId = Visy.Middleware.SAP.Magento2.Components.OrchestrationHelper.GetSplittedStringVal(v_FileName, '-', 1);&#xD;&#xA;&#xD;&#xA;v_FileName = Visy.Middleware.SAP.Magento2.Components.OrchestrationHelper.GetSplittedStringVal(v_FileName, '-', 0);&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Magento2-&gt; Filename Property: &quot; + v_FileName);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Magento2-&gt; Reference Id Property: &quot; + v_RefId);&#xD;&#xA;&#xD;&#xA;" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Extract_Property" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="Decision" OID="7fa3b528-9911-4bbb-88e2-c2ec2b21af26" ParentLink="ServiceBody_Statement" LowerBound="80.1" HigherBound="321.1">
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="CallType" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="DecisionBranch" OID="91205766-8e5a-4f59-8d10-9e45d81f4633" ParentLink="ReallyComplexStatement_Branch" LowerBound="81.13" HigherBound="148.1">
                        <om:Property Name="Expression" Value="v_FileName == &quot;shipment&quot;" />
                        <om:Property Name="IsGhostBranch" Value="True" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="shipment" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Scope" OID="6438172c-7022-41e5-be32-7e8a8635e1f1" ParentLink="ComplexStatement_Statement" LowerBound="83.1" HigherBound="116.1">
                            <om:Property Name="InitializedTransactionType" Value="True" />
                            <om:Property Name="IsSynchronized" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Scope_HttpError" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="VariableAssignment" OID="66de0881-351e-44c7-ab14-78e82ca35a1a" ParentLink="ComplexStatement_Statement" LowerBound="88.1" HigherBound="91.1">
                                <om:Property Name="Expression" Value="v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento(v_FileName, msg_JsonData, v_RefId);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Magento-&gt;Response: &quot; + v_Resp);&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="SendJsonData" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Catch" OID="b3cfff0d-6353-482f-a2fa-6356f6a41ddb" ParentLink="Scope_Catch" LowerBound="94.1" HigherBound="114.1">
                                <om:Property Name="ExceptionName" Value="ex" />
                                <om:Property Name="ExceptionType" Value="System.SystemException" />
                                <om:Property Name="IsFaultMessage" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="System Exc" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="f937af7c-b108-472c-9d20-1e40209d0ea0" ParentLink="Catch_Statement" LowerBound="97.1" HigherBound="109.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="cm_EmailNotification" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="7887a09a-83f1-46c6-a02d-b0dbe17111d2" ParentLink="ComplexStatement_Statement" LowerBound="100.1" HigherBound="108.1">
                                        <om:Property Name="Expression" Value="&#xD;&#xA;m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(ex.Message.ToString());&#xD;&#xA;m_Email.Attachment = msg_JsonData;&#xD;&#xA;m_Email(SMTP.MessagePartsAttachments) = 2;&#xD;&#xA;m_Email.Attachment(MIME.FileName) = &quot;req_&quot; + msg_JsonData(BTS.InterchangeID) + &quot;.json&quot;;&#xD;&#xA;&#xD;&#xA;m_Email(SMTP.Subject) = &quot;Magento-2 Shipment HTTP Connection error&quot;;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="msg_resp" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="92ef1183-d2f8-4d45-8b3c-5a1ffe1102a5" ParentLink="Construct_MessageRef" LowerBound="98.39" HigherBound="98.46">
                                        <om:Property Name="Ref" Value="m_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="9fca60e5-2ba4-478a-bbb6-b7d218e111ca" ParentLink="Catch_Statement" LowerBound="109.1" HigherBound="111.1">
                                    <om:Property Name="PortName" Value="Port_ValidationNotification" />
                                    <om:Property Name="MessageName" Value="m_Email" />
                                    <om:Property Name="OperationName" Value="SMTP" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Resp" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Suspend" OID="734bd043-0bd8-489a-afc3-beaf7c481961" ParentLink="Catch_Statement" LowerBound="111.1" HigherBound="113.1">
                                    <om:Property Name="ErrorMessage" Value="ex.InnerException.ToString();" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Suspend" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="87695967-1ba1-4bb8-a360-d416485eb239" ParentLink="ComplexStatement_Statement" LowerBound="116.1" HigherBound="147.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Validation_error" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="31544565-73b7-43cf-b0b8-d87255139fb7" ParentLink="ReallyComplexStatement_Branch" LowerBound="117.17" HigherBound="136.1">
                                <om:Property Name="Expression" Value="v_Resp.Contains(&quot;Shipment Document Validation Error&quot;)==true || v_Resp.Contains(&quot;message&quot;)==true" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Failed" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="6a7a5dc5-d40c-4b4e-bac6-2f629d758371" ParentLink="ComplexStatement_Statement" LowerBound="119.1" HigherBound="133.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="cm_EmailNotification" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="f1c9c824-2e95-4323-a889-684f91b9d353" ParentLink="ComplexStatement_Statement" LowerBound="122.1" HigherBound="132.1">
                                        <om:Property Name="Expression" Value="&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(v_Resp);&#xD;&#xA;m_Email.Attachment = msg_JsonData;&#xD;&#xA;m_Email(SMTP.MessagePartsAttachments) = 2;&#xD;&#xA;m_Email.Attachment(MIME.FileName) = &quot;req_&quot; + msg_JsonData(BTS.InterchangeID) + &quot;.json&quot;;&#xD;&#xA;&#xD;&#xA;m_Email(SMTP.Subject) = &quot;Magento-2 Shipment validation failed message&quot;;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="msg_resp" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="38a57a4e-8bc0-459a-b0cf-7297ff3947c3" ParentLink="Construct_MessageRef" LowerBound="120.31" HigherBound="120.38">
                                        <om:Property Name="Ref" Value="m_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="c760b7c2-80c6-44c9-b953-4b98b960a788" ParentLink="ComplexStatement_Statement" LowerBound="133.1" HigherBound="135.1">
                                    <om:Property Name="PortName" Value="Port_ValidationNotification" />
                                    <om:Property Name="MessageName" Value="m_Email" />
                                    <om:Property Name="OperationName" Value="SMTP" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Resp" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="445ba1cf-ef50-447d-80cf-9906931c592d" ParentLink="ReallyComplexStatement_Branch" LowerBound="136.22" HigherBound="142.1">
                                <om:Property Name="Expression" Value="Visy.Middleware.SAP.Magento2.Components.OrchestrationHelper.IsNumeric(v_Resp.Replace(&quot;\&quot;&quot;, &quot;&quot;))" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="IsNumeric" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="VariableAssignment" OID="5fe4518d-a8cb-444c-97f0-94d6c2a1a218" ParentLink="ComplexStatement_Statement" LowerBound="138.1" HigherBound="141.1">
                                    <om:Property Name="Expression" Value="v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento(&quot;shipmentemail&quot;, msg_JsonData, v_Resp.Replace(&quot;\&quot;&quot;, &quot;&quot;));&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Magento-&gt;Response: &quot; + v_Resp.Replace(&quot;\&quot;&quot;, &quot;&quot;));&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="SendJsonData" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="686feead-9689-4c92-a6b3-090b30813d5e" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Suspend" OID="7e112950-8292-42b9-b46a-e2e20cb8f652" ParentLink="ComplexStatement_Statement" LowerBound="144.1" HigherBound="146.1">
                                    <om:Property Name="ErrorMessage" Value="v_Resp;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Suspend_Shipment" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="DecisionBranch" OID="acae303c-3021-42e0-b1af-bf6cc33942f9" ParentLink="ReallyComplexStatement_Branch" LowerBound="148.18" HigherBound="212.1">
                        <om:Property Name="Expression" Value="v_FileName == &quot;invoice&quot;" />
                        <om:Property Name="IsGhostBranch" Value="True" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="invoice" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Scope" OID="b0c8f15a-99f5-43ea-8ba0-53942a5204a1" ParentLink="ComplexStatement_Statement" LowerBound="150.1" HigherBound="182.1">
                            <om:Property Name="InitializedTransactionType" Value="True" />
                            <om:Property Name="IsSynchronized" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Scope_HttpError" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Catch" OID="1a0d901f-a0e2-43e3-9fbf-93ed9bfd0388" ParentLink="Scope_Catch" LowerBound="161.1" HigherBound="180.1">
                                <om:Property Name="ExceptionName" Value="ex" />
                                <om:Property Name="ExceptionType" Value="System.SystemException" />
                                <om:Property Name="IsFaultMessage" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="System Exc" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="5780de99-cc48-463a-ad2a-a9c9795022b5" ParentLink="Catch_Statement" LowerBound="164.1" HigherBound="175.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="cm_EmailNotification" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="b5f5b44f-22d2-4a4f-80a8-e1e3526af1df" ParentLink="Construct_MessageRef" LowerBound="165.39" HigherBound="165.46">
                                        <om:Property Name="Ref" Value="m_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="5177a6a5-0e78-4358-b7dc-bda1c6c356c4" ParentLink="ComplexStatement_Statement" LowerBound="167.1" HigherBound="174.1">
                                        <om:Property Name="Expression" Value="&#xD;&#xA;m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(ex.Message.ToString());&#xD;&#xA;m_Email.Attachment = msg_JsonData;&#xD;&#xA;m_Email(SMTP.MessagePartsAttachments) = 2;&#xD;&#xA;m_Email.Attachment(MIME.FileName) = &quot;req_&quot; + msg_JsonData(BTS.InterchangeID) + &quot;.json&quot;;&#xD;&#xA;m_Email(SMTP.Subject) = &quot;Magento-2 Invoice API HTTP Connection error&quot;;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="msg_resp" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="af5674b7-4d75-41d3-8ecf-040bdd2fb06c" ParentLink="Catch_Statement" LowerBound="175.1" HigherBound="177.1">
                                    <om:Property Name="PortName" Value="Port_ValidationNotification" />
                                    <om:Property Name="MessageName" Value="m_Email" />
                                    <om:Property Name="OperationName" Value="SMTP" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Resp" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Suspend" OID="7c952375-6a15-4349-9fee-1f77286fce5f" ParentLink="Catch_Statement" LowerBound="177.1" HigherBound="179.1">
                                    <om:Property Name="ErrorMessage" Value="ex.InnerException.ToString();" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Suspend" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="f86ca1c5-411c-424e-9ab1-1f4871bb0a0e" ParentLink="ComplexStatement_Statement" LowerBound="155.1" HigherBound="158.1">
                                <om:Property Name="Expression" Value="v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento(v_FileName, msg_JsonData, v_RefId);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Magento-&gt;Response: &quot; + v_Resp);&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="SendJsonData" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="ffa71847-ea63-4f23-a783-56207f57870b" ParentLink="ComplexStatement_Statement" LowerBound="182.1" HigherBound="211.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Validation_error" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="8165421c-034f-4705-abac-2a56c366af9b" ParentLink="ReallyComplexStatement_Branch" LowerBound="183.17" HigherBound="200.1">
                                <om:Property Name="Expression" Value="v_Resp.Contains(&quot;Invoice Document Validation Error&quot;)==true || v_Resp.Contains(&quot;message&quot;)==true" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Failed" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="a645552f-7561-43e3-a05a-c0b1a367dbcf" ParentLink="ComplexStatement_Statement" LowerBound="185.1" HigherBound="197.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="cm_EmailNotification" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="8c57e810-f3e0-4235-bfd8-4fce1bec9ec2" ParentLink="ComplexStatement_Statement" LowerBound="188.1" HigherBound="196.1">
                                        <om:Property Name="Expression" Value="&#xD;&#xA;&#xD;&#xA;m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(v_Resp);&#xD;&#xA;m_Email.Attachment = msg_JsonData;&#xD;&#xA;m_Email(SMTP.MessagePartsAttachments) = 2;&#xD;&#xA;m_Email.Attachment(MIME.FileName) = &quot;req_&quot; + msg_JsonData(BTS.InterchangeID) + &quot;.json&quot;;&#xD;&#xA;m_Email(SMTP.Subject) = &quot;Magento-2 Invoice validation failed message&quot;;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="msg_resp" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="aaef1475-4204-43fb-a63a-d7c1d5b429a2" ParentLink="Construct_MessageRef" LowerBound="186.31" HigherBound="186.38">
                                        <om:Property Name="Ref" Value="m_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="a22c49bd-b078-40a0-801a-d1b69f6c0285" ParentLink="ComplexStatement_Statement" LowerBound="197.1" HigherBound="199.1">
                                    <om:Property Name="PortName" Value="Port_ValidationNotification" />
                                    <om:Property Name="MessageName" Value="m_Email" />
                                    <om:Property Name="OperationName" Value="SMTP" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Resp" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="092d8e18-1812-43c8-a2b1-fbf61566fe7d" ParentLink="ReallyComplexStatement_Branch" LowerBound="200.22" HigherBound="206.1">
                                <om:Property Name="Expression" Value="Visy.Middleware.SAP.Magento2.Components.OrchestrationHelper.IsNumeric(v_Resp.Replace(&quot;\&quot;&quot;, &quot;&quot;))" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="IsNumeric" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="VariableAssignment" OID="7e6dd9ae-c8ff-4672-ae13-f11fc13874d6" ParentLink="ComplexStatement_Statement" LowerBound="202.1" HigherBound="205.1">
                                    <om:Property Name="Expression" Value="v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento(&quot;invoiceemail&quot;, msg_JsonData, v_Resp.Replace(&quot;\&quot;&quot;, &quot;&quot;));&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Magento-&gt;Response: &quot; + v_Resp);&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="SendJsonData" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="c3ff523d-f1fb-4e92-be82-99f1bab1c205" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Suspend" OID="c5d5c26f-39ba-431a-bc32-1bd10b09d7a6" ParentLink="ComplexStatement_Statement" LowerBound="208.1" HigherBound="210.1">
                                    <om:Property Name="ErrorMessage" Value="v_Resp;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Suspend_Invoice" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="DecisionBranch" OID="9ccb69bb-cd60-4980-b988-068791151396" ParentLink="ReallyComplexStatement_Branch" LowerBound="212.18" HigherBound="267.1">
                        <om:Property Name="Expression" Value="v_FileName == &quot;customer&quot;" />
                        <om:Property Name="IsGhostBranch" Value="True" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="customer" />
                        <om:Property Name="Signal" Value="False" />
                        <om:Element Type="Scope" OID="84a2ff56-26c7-4fa8-a585-38a31a4352e7" ParentLink="ComplexStatement_Statement" LowerBound="214.1" HigherBound="247.1">
                            <om:Property Name="InitializedTransactionType" Value="True" />
                            <om:Property Name="IsSynchronized" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Scope_HttpError" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Catch" OID="000d58f5-23cd-4324-98d7-210e12acc4fc" ParentLink="Scope_Catch" LowerBound="225.1" HigherBound="245.1">
                                <om:Property Name="ExceptionName" Value="ex" />
                                <om:Property Name="ExceptionType" Value="System.SystemException" />
                                <om:Property Name="IsFaultMessage" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="System Exc" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="26453293-9ea7-406d-9a93-8e6a4971d15d" ParentLink="Catch_Statement" LowerBound="228.1" HigherBound="240.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="cm_EmailNotification" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="dbb8fc19-cbfc-4882-bc79-1a1ea4e624cc" ParentLink="Construct_MessageRef" LowerBound="229.39" HigherBound="229.46">
                                        <om:Property Name="Ref" Value="m_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="7c16e788-5399-4e34-8dd0-6edf108e3036" ParentLink="ComplexStatement_Statement" LowerBound="231.1" HigherBound="239.1">
                                        <om:Property Name="Expression" Value="&#xD;&#xA;m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(ex.Message.ToString());&#xD;&#xA;m_Email.Attachment = msg_JsonData;&#xD;&#xA;m_Email(SMTP.MessagePartsAttachments) = 2;&#xD;&#xA;m_Email.Attachment(MIME.FileName) = &quot;req_&quot; + msg_JsonData(BTS.InterchangeID) + &quot;.json&quot;;&#xD;&#xA;&#xD;&#xA;m_Email(SMTP.Subject) = &quot;Magento-2 Customer API HTTP Connection error&quot;;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="msg_resp" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="6cbfb569-9b1b-4624-ad6e-8a7c600edf1d" ParentLink="Catch_Statement" LowerBound="240.1" HigherBound="242.1">
                                    <om:Property Name="PortName" Value="Port_ValidationNotification" />
                                    <om:Property Name="MessageName" Value="m_Email" />
                                    <om:Property Name="OperationName" Value="SMTP" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Resp" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Suspend" OID="7a3a34d0-04dc-499e-8c8d-5f9d735576c6" ParentLink="Catch_Statement" LowerBound="242.1" HigherBound="244.1">
                                    <om:Property Name="ErrorMessage" Value="ex.InnerException.ToString();" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Suspend" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="1668f27f-eca1-4458-98e8-540c12e73a9c" ParentLink="ComplexStatement_Statement" LowerBound="219.1" HigherBound="222.1">
                                <om:Property Name="Expression" Value="v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento(v_FileName, msg_JsonData, v_RefId);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Magento-&gt;Response: &quot; + v_Resp);&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="SendJsonData" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="c2c0c7b5-e771-454c-86db-49291c6ab605" ParentLink="ComplexStatement_Statement" LowerBound="247.1" HigherBound="266.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Validation_error" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="7a3eecbc-2c7a-462c-ac15-d0f2186ebe6d" ParentLink="ReallyComplexStatement_Branch" LowerBound="248.17" HigherBound="266.1">
                                <om:Property Name="Expression" Value="v_Resp.Contains(&quot;{\&quot;message\&quot;:&quot;)==true" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Failed" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="67e31e8f-d5a0-4dc3-8a31-63264874e2d0" ParentLink="ComplexStatement_Statement" LowerBound="250.1" HigherBound="263.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="cm_EmailNotification" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="7c05303e-64d8-4536-98b5-d6b206276878" ParentLink="ComplexStatement_Statement" LowerBound="253.1" HigherBound="262.1">
                                        <om:Property Name="Expression" Value="&#xD;&#xA;m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(v_Resp);&#xD;&#xA;m_Email.Attachment = msg_JsonData;&#xD;&#xA;m_Email(SMTP.MessagePartsAttachments) = 2;&#xD;&#xA;m_Email.Attachment(MIME.FileName) = &quot;req_&quot; + msg_JsonData(BTS.InterchangeID) + &quot;.json&quot;;&#xD;&#xA;m_Email(SMTP.Subject) = &quot;Magento-2 Customer validation failed message&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="msg_resp" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="f91f742d-849d-47de-8953-acc8acb971e1" ParentLink="Construct_MessageRef" LowerBound="251.31" HigherBound="251.38">
                                        <om:Property Name="Ref" Value="m_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="b664d309-c085-4042-baec-3eb5da5c16e4" ParentLink="ComplexStatement_Statement" LowerBound="263.1" HigherBound="265.1">
                                    <om:Property Name="PortName" Value="Port_ValidationNotification" />
                                    <om:Property Name="MessageName" Value="m_Email" />
                                    <om:Property Name="OperationName" Value="SMTP" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Resp" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="732d9da8-4131-4d41-a8f8-26d2b6d8e45d" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="DecisionBranch" OID="8805d847-210f-45e4-94fc-d6a9478fc61f" ParentLink="ReallyComplexStatement_Branch">
                        <om:Property Name="IsGhostBranch" Value="True" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Else" />
                        <om:Property Name="Signal" Value="False" />
                        <om:Element Type="Scope" OID="519785fa-0ded-4a76-b16c-84ed03cd7811" ParentLink="ComplexStatement_Statement" LowerBound="269.1" HigherBound="302.1">
                            <om:Property Name="InitializedTransactionType" Value="True" />
                            <om:Property Name="IsSynchronized" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Scope_HttpError" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Catch" OID="1e396038-e0f9-4059-b58b-324837a33ecc" ParentLink="Scope_Catch" LowerBound="280.1" HigherBound="300.1">
                                <om:Property Name="ExceptionName" Value="ex" />
                                <om:Property Name="ExceptionType" Value="System.SystemException" />
                                <om:Property Name="IsFaultMessage" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="System Exc" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="d81f19a5-9a98-4fa2-9884-57737afc523e" ParentLink="Catch_Statement" LowerBound="283.1" HigherBound="295.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="cm_EmailNotification" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="eb4112bf-14ec-4438-ab49-161a88810131" ParentLink="Construct_MessageRef" LowerBound="284.39" HigherBound="284.46">
                                        <om:Property Name="Ref" Value="m_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="375060b7-aa4e-4717-aa52-d29dbd4a6115" ParentLink="ComplexStatement_Statement" LowerBound="286.1" HigherBound="294.1">
                                        <om:Property Name="Expression" Value="&#xD;&#xA;m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(ex.Message.ToString());&#xD;&#xA;m_Email.Attachment = msg_JsonData;&#xD;&#xA;m_Email(SMTP.MessagePartsAttachments) = 2;&#xD;&#xA;m_Email.Attachment(MIME.FileName) = &quot;req_&quot; + msg_JsonData(BTS.InterchangeID) + &quot;.json&quot;;&#xD;&#xA;&#xD;&#xA;m_Email(SMTP.Subject) = &quot;Magento-2 Product HTTP Connection error&quot;;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="msg_resp" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="7a833204-6767-4e43-bb6e-9be1111cb22d" ParentLink="Catch_Statement" LowerBound="295.1" HigherBound="297.1">
                                    <om:Property Name="PortName" Value="Port_ValidationNotification" />
                                    <om:Property Name="MessageName" Value="m_Email" />
                                    <om:Property Name="OperationName" Value="SMTP" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Resp" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Suspend" OID="9f5005fa-b7d3-469c-8805-ac303c4a7ed9" ParentLink="Catch_Statement" LowerBound="297.1" HigherBound="299.1">
                                    <om:Property Name="ErrorMessage" Value="ex.InnerException.ToString();" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Suspend" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="04f8ac3b-7572-408e-9530-94a629fba94e" ParentLink="ComplexStatement_Statement" LowerBound="274.1" HigherBound="277.1">
                                <om:Property Name="Expression" Value="v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento(v_FileName, msg_JsonData, v_RefId);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Magento-&gt;Response: &quot; + v_Resp);&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="SendJsonData" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Decision" OID="44305510-4b7c-4749-a56d-c1106abf7191" ParentLink="ComplexStatement_Statement" LowerBound="302.1" HigherBound="320.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Validation_error" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="f498efda-979c-4527-b4de-1b8572fac4a8" ParentLink="ReallyComplexStatement_Branch" LowerBound="303.17" HigherBound="320.1">
                                <om:Property Name="Expression" Value="v_Resp.Contains(&quot;{\&quot;message\&quot;:&quot;)==true" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Failed" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Construct" OID="a9350ce1-bebd-4664-aedb-67b2700f2936" ParentLink="ComplexStatement_Statement" LowerBound="305.1" HigherBound="317.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="cm_EmailNotification" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="fc14f729-6d48-4cc8-9237-f42874b01b72" ParentLink="ComplexStatement_Statement" LowerBound="308.1" HigherBound="316.1">
                                        <om:Property Name="Expression" Value="m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(v_Resp);&#xD;&#xA;m_Email.Attachment = msg_JsonData;&#xD;&#xA;m_Email(SMTP.MessagePartsAttachments) = 2;&#xD;&#xA;m_Email.Attachment(MIME.FileName) = &quot;req_&quot; + msg_JsonData(BTS.InterchangeID) + &quot;.json&quot;;&#xD;&#xA;m_Email(SMTP.Subject) = &quot;Magento-2 Catalog validation failed message&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="msg_resp" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="bae547c3-4b75-486b-a987-abe1cb1525ca" ParentLink="Construct_MessageRef" LowerBound="306.31" HigherBound="306.38">
                                        <om:Property Name="Ref" Value="m_Email" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="1dc843f0-ab96-44bf-970b-77583c3e51b4" ParentLink="ComplexStatement_Statement" LowerBound="317.1" HigherBound="319.1">
                                    <om:Property Name="PortName" Value="Port_ValidationNotification" />
                                    <om:Property Name="MessageName" Value="m_Email" />
                                    <om:Property Name="OperationName" Value="SMTP" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Resp" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="a57860cb-8d11-4556-a654-18ef9e59c7dc" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="37210822-28ee-491e-b791-dd1b2449fbc9" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="40.1" HigherBound="42.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Magento2.Orchestrations.PortType_JsonStaging" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_JsonStaging" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="44143a40-a469-4ccd-ab1b-36023033b798" ParentLink="PortDeclaration_CLRAttribute" LowerBound="40.1" HigherBound="41.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="6b6fed14-18ee-4ec9-a691-5676be27044d" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="42.1" HigherBound="44.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Magento2.Orchestrations.PortType_JsonReqArchive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_JsonReqArchive" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="f51d376e-08d2-40ac-87b9-796c00484c46" ParentLink="PortDeclaration_CLRAttribute" LowerBound="42.1" HigherBound="43.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="e85c57db-bc24-42b1-9939-dcff6e30e82b" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="44.1" HigherBound="46.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="30" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Magento2.Orchestrations.PortType_ValidaitonNotification" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_ValidationNotification" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="9425ca9d-f783-45aa-9803-f1acaba1f081" ParentLink="PortDeclaration_CLRAttribute" LowerBound="44.1" HigherBound="45.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="620d903d-b82e-4c18-906b-1f03b5193fdf" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="9.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="m_EmailPart" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="afcebf10-55a1-4fcb-aacb-9ceae4d8e410" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.Components.Utilities.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Body" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="PartDeclaration" OID="9fc709b0-d772-4876-ab5d-d67ffc849d15" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="7.1" HigherBound="8.1">
                <om:Property Name="ClassName" Value="System.Xml.XmlDocument" />
                <om:Property Name="IsBodyPart" Value="False" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Attachment" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module Visy.Middleware.SAP.Magento2.Orchestrations
{
    internal messagetype m_EmailPart
    {
        body Visy.Middleware.Components.Utilities.RawString Body;
        System.Xml.XmlDocument Attachment;
    };
    internal porttype PortType_JsonStaging
    {
        oneway Json
        {
            System.Xml.XmlDocument
        };
    };
    internal porttype PortType_JsonReqArchive
    {
        oneway Archive
        {
            System.Xml.XmlDocument
        };
    };
    public porttype PortType_Send_Request
    {
        requestresponse WCF
        {
            System.Xml.XmlDocument, System.Xml.XmlDocument
        };
    };
    public porttype PortType_ValidaitonNotification
    {
        oneway SMTP
        {
            m_EmailPart
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service JsonSender
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PortType_JsonStaging Port_JsonStaging;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_JsonReqArchive Port_JsonReqArchive;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ValidaitonNotification Port_ValidationNotification;
        message System.Xml.XmlDocument msg_JsonData;
        message System.Xml.XmlDocument msg_JsonDataReq;
        message System.String msg_Resp;
        message m_EmailPart m_Email;
        System.String v_FileName;
        System.String v_TempString;
        System.String v_RefId;
        System.Xml.XmlDocument v_XmlDocument;
        System.String v_Resp;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("83f2e3b9-0ffd-4c4e-9e0f-79eab53a2691")]
            activate receive (Port_JsonStaging.Json, msg_JsonData);
            v_FileName = "";
            v_TempString = "";
            v_RefId = "";
            v_XmlDocument = new System.Xml.XmlDocument();
            v_Resp = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("78aaa6df-0ffc-4b57-8682-23897c0f33c9")]
            send (Port_JsonReqArchive.Archive, msg_JsonData);
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("73b116e0-8af6-4908-9af3-ed72aa947ab7")]
            
            v_TempString = msg_JsonData(FILE.ReceivedFileName);
            v_TempString = v_TempString.Substring(v_TempString.IndexOf("json.")+5); 
            
            
            v_FileName = v_TempString.Substring(0,v_TempString.IndexOf("."));
            v_RefId = Visy.Middleware.SAP.Magento2.Components.OrchestrationHelper.GetSplittedStringVal(v_FileName, '-', 1);
            
            v_FileName = Visy.Middleware.SAP.Magento2.Components.OrchestrationHelper.GetSplittedStringVal(v_FileName, '-', 0);
            
            System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Magento2-> Filename Property: " + v_FileName);
            System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Magento2-> Reference Id Property: " + v_RefId);
            
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7fa3b528-9911-4bbb-88e2-c2ec2b21af26")]
            if (v_FileName == "shipment")
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("6438172c-7022-41e5-be32-7e8a8635e1f1")]
                scope
                {
                    body
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("66de0881-351e-44c7-ab14-78e82ca35a1a")]
                        v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento(v_FileName, msg_JsonData, v_RefId);
                        System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Magento->Response: " + v_Resp);
                    }
                    exceptions
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b3cfff0d-6353-482f-a2fa-6356f6a41ddb")]
                        catch (System.SystemException ex)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f937af7c-b108-472c-9d20-1e40209d0ea0")]
                            construct m_Email
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("7887a09a-83f1-46c6-a02d-b0dbe17111d2")]
                                
                                m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(ex.Message.ToString());
                                m_Email.Attachment = msg_JsonData;
                                m_Email(SMTP.MessagePartsAttachments) = 2;
                                m_Email.Attachment(MIME.FileName) = "req_" + msg_JsonData(BTS.InterchangeID) + ".json";
                                
                                m_Email(SMTP.Subject) = "Magento-2 Shipment HTTP Connection error";
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9fca60e5-2ba4-478a-bbb6-b7d218e111ca")]
                            send (Port_ValidationNotification.SMTP, m_Email);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("734bd043-0bd8-489a-afc3-beaf7c481961")]
                            suspend ex.InnerException.ToString();
                        }
                    }
                }
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("87695967-1ba1-4bb8-a360-d416485eb239")]
                if (v_Resp.Contains("Shipment Document Validation Error")==true || v_Resp.Contains("message")==true)
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6a7a5dc5-d40c-4b4e-bac6-2f629d758371")]
                    construct m_Email
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f1c9c824-2e95-4323-a889-684f91b9d353")]
                        
                        
                        
                        m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(v_Resp);
                        m_Email.Attachment = msg_JsonData;
                        m_Email(SMTP.MessagePartsAttachments) = 2;
                        m_Email.Attachment(MIME.FileName) = "req_" + msg_JsonData(BTS.InterchangeID) + ".json";
                        
                        m_Email(SMTP.Subject) = "Magento-2 Shipment validation failed message";
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c760b7c2-80c6-44c9-b953-4b98b960a788")]
                    send (Port_ValidationNotification.SMTP, m_Email);
                }
                else if (Visy.Middleware.SAP.Magento2.Components.OrchestrationHelper.IsNumeric(v_Resp.Replace("\"", "")))
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("5fe4518d-a8cb-444c-97f0-94d6c2a1a218")]
                    v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento("shipmentemail", msg_JsonData, v_Resp.Replace("\"", ""));
                    System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Magento->Response: " + v_Resp.Replace("\"", ""));
                }
                else 
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7e112950-8292-42b9-b46a-e2e20cb8f652")]
                    suspend v_Resp;
                }
            }
            else if (v_FileName == "invoice")
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("b0c8f15a-99f5-43ea-8ba0-53942a5204a1")]
                scope
                {
                    body
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f86ca1c5-411c-424e-9ab1-1f4871bb0a0e")]
                        v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento(v_FileName, msg_JsonData, v_RefId);
                        System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Magento->Response: " + v_Resp);
                    }
                    exceptions
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1a0d901f-a0e2-43e3-9fbf-93ed9bfd0388")]
                        catch (System.SystemException ex)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5780de99-cc48-463a-ad2a-a9c9795022b5")]
                            construct m_Email
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5177a6a5-0e78-4358-b7dc-bda1c6c356c4")]
                                
                                m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(ex.Message.ToString());
                                m_Email.Attachment = msg_JsonData;
                                m_Email(SMTP.MessagePartsAttachments) = 2;
                                m_Email.Attachment(MIME.FileName) = "req_" + msg_JsonData(BTS.InterchangeID) + ".json";
                                m_Email(SMTP.Subject) = "Magento-2 Invoice API HTTP Connection error";
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("af5674b7-4d75-41d3-8ecf-040bdd2fb06c")]
                            send (Port_ValidationNotification.SMTP, m_Email);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7c952375-6a15-4349-9fee-1f77286fce5f")]
                            suspend ex.InnerException.ToString();
                        }
                    }
                }
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ffa71847-ea63-4f23-a783-56207f57870b")]
                if (v_Resp.Contains("Invoice Document Validation Error")==true || v_Resp.Contains("message")==true)
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a645552f-7561-43e3-a05a-c0b1a367dbcf")]
                    construct m_Email
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8c57e810-f3e0-4235-bfd8-4fce1bec9ec2")]
                        
                        
                        m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(v_Resp);
                        m_Email.Attachment = msg_JsonData;
                        m_Email(SMTP.MessagePartsAttachments) = 2;
                        m_Email.Attachment(MIME.FileName) = "req_" + msg_JsonData(BTS.InterchangeID) + ".json";
                        m_Email(SMTP.Subject) = "Magento-2 Invoice validation failed message";
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a22c49bd-b078-40a0-801a-d1b69f6c0285")]
                    send (Port_ValidationNotification.SMTP, m_Email);
                }
                else if (Visy.Middleware.SAP.Magento2.Components.OrchestrationHelper.IsNumeric(v_Resp.Replace("\"", "")))
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7e6dd9ae-c8ff-4672-ae13-f11fc13874d6")]
                    v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento("invoiceemail", msg_JsonData, v_Resp.Replace("\"", ""));
                    System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Magento->Response: " + v_Resp);
                }
                else 
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c5d5c26f-39ba-431a-bc32-1bd10b09d7a6")]
                    suspend v_Resp;
                }
            }
            else if (v_FileName == "customer")
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("84a2ff56-26c7-4fa8-a585-38a31a4352e7")]
                scope
                {
                    body
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1668f27f-eca1-4458-98e8-540c12e73a9c")]
                        v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento(v_FileName, msg_JsonData, v_RefId);
                        System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Magento->Response: " + v_Resp);
                    }
                    exceptions
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("000d58f5-23cd-4324-98d7-210e12acc4fc")]
                        catch (System.SystemException ex)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("26453293-9ea7-406d-9a93-8e6a4971d15d")]
                            construct m_Email
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("7c16e788-5399-4e34-8dd0-6edf108e3036")]
                                
                                m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(ex.Message.ToString());
                                m_Email.Attachment = msg_JsonData;
                                m_Email(SMTP.MessagePartsAttachments) = 2;
                                m_Email.Attachment(MIME.FileName) = "req_" + msg_JsonData(BTS.InterchangeID) + ".json";
                                
                                m_Email(SMTP.Subject) = "Magento-2 Customer API HTTP Connection error";
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6cbfb569-9b1b-4624-ad6e-8a7c600edf1d")]
                            send (Port_ValidationNotification.SMTP, m_Email);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7a3a34d0-04dc-499e-8c8d-5f9d735576c6")]
                            suspend ex.InnerException.ToString();
                        }
                    }
                }
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("c2c0c7b5-e771-454c-86db-49291c6ab605")]
                if (v_Resp.Contains("{\"message\":")==true)
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("67e31e8f-d5a0-4dc3-8a31-63264874e2d0")]
                    construct m_Email
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("7c05303e-64d8-4536-98b5-d6b206276878")]
                        
                        m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(v_Resp);
                        m_Email.Attachment = msg_JsonData;
                        m_Email(SMTP.MessagePartsAttachments) = 2;
                        m_Email.Attachment(MIME.FileName) = "req_" + msg_JsonData(BTS.InterchangeID) + ".json";
                        m_Email(SMTP.Subject) = "Magento-2 Customer validation failed message";
                        
                        
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b664d309-c085-4042-baec-3eb5da5c16e4")]
                    send (Port_ValidationNotification.SMTP, m_Email);
                }
            }
            else 
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("519785fa-0ded-4a76-b16c-84ed03cd7811")]
                scope
                {
                    body
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("04f8ac3b-7572-408e-9530-94a629fba94e")]
                        v_Resp = Visy.Middleware.SAP.Magento2.Components.oAuthHelper.SendToMagento(v_FileName, msg_JsonData, v_RefId);
                        System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Magento->Response: " + v_Resp);
                    }
                    exceptions
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1e396038-e0f9-4059-b58b-324837a33ecc")]
                        catch (System.SystemException ex)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d81f19a5-9a98-4fa2-9884-57737afc523e")]
                            construct m_Email
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("375060b7-aa4e-4717-aa52-d29dbd4a6115")]
                                
                                m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(ex.Message.ToString());
                                m_Email.Attachment = msg_JsonData;
                                m_Email(SMTP.MessagePartsAttachments) = 2;
                                m_Email.Attachment(MIME.FileName) = "req_" + msg_JsonData(BTS.InterchangeID) + ".json";
                                
                                m_Email(SMTP.Subject) = "Magento-2 Product HTTP Connection error";
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7a833204-6767-4e43-bb6e-9be1111cb22d")]
                            send (Port_ValidationNotification.SMTP, m_Email);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9f5005fa-b7d3-469c-8805-ac303c4a7ed9")]
                            suspend ex.InnerException.ToString();
                        }
                    }
                }
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("44305510-4b7c-4749-a56d-c1106abf7191")]
                if (v_Resp.Contains("{\"message\":")==true)
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a9350ce1-bebd-4664-aedb-67b2700f2936")]
                    construct m_Email
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("fc14f729-6d48-4cc8-9237-f42874b01b72")]
                        m_Email.Body=new Visy.Middleware.Components.Utilities.RawString(v_Resp);
                        m_Email.Attachment = msg_JsonData;
                        m_Email(SMTP.MessagePartsAttachments) = 2;
                        m_Email.Attachment(MIME.FileName) = "req_" + msg_JsonData(BTS.InterchangeID) + ".json";
                        m_Email(SMTP.Subject) = "Magento-2 Catalog validation failed message";
                        
                        
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1dc843f0-ab96-44bf-970b-77583c3e51b4")]
                    send (Port_ValidationNotification.SMTP, m_Email);
                }
            }
        }
    }
}

