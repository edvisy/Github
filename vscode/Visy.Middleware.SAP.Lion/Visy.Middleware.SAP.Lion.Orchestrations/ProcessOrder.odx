#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="818656c5-97a5-4f37-a162-5a4e2dc0c12c" LowerBound="1.1" HigherBound="365.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="Visy.Middleware.SAP.Lion.Orchestrations" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="22a39741-0c14-4db9-9ced-191b6e715874" ParentLink="Module_PortType" LowerBound="24.1" HigherBound="31.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Public" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Receive_Order_From_Ariba" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="1fcf89c7-f623-4411-8c5e-2814fb55bdc6" ParentLink="PortType_OperationDeclaration" LowerBound="26.1" HigherBound="30.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_Receive_Order_From_Ariba" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="05b2d9b7-3eb6-44e1-97b0-59e475ed2e5c" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="28.13" HigherBound="28.36">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_LionOrder" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="10edcd26-b5ce-47bb-ad71-0cd98cc38be7" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="28.38" HigherBound="28.60">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="347d0015-710e-479e-9ce2-d08881192a5b" ParentLink="Module_PortType" LowerBound="31.1" HigherBound="38.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Send_Order_To_SAP" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="3f19260f-f19a-488f-96e1-3dbed57850de" ParentLink="PortType_OperationDeclaration" LowerBound="33.1" HigherBound="37.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_Send_Order_To_SAP" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="0e0c56ad-bf20-4508-8856-eb60a3159484" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="35.13" HigherBound="35.35">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_SAPOrder" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="61b64d5b-5e70-4e43-9125-5c9553abe4d3" ParentLink="Module_PortType" LowerBound="38.1" HigherBound="45.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Send_SinglecXML" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="01d25a57-ce60-4b8c-a4cb-6aa4506065e2" ParentLink="PortType_OperationDeclaration" LowerBound="40.1" HigherBound="44.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_Send_SinglecXML" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="99d9e9dd-a1f5-4413-b63b-a8a4174a26ed" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="42.13" HigherBound="42.36">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_LionOrder" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="611d34f7-9d6e-4505-a5b8-e74ebf51c736" ParentLink="Module_PortType" LowerBound="45.1" HigherBound="52.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SendReceive_Rfc" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="0aff660c-17a2-43a6-923a-3898fd00bba6" ParentLink="PortType_OperationDeclaration" LowerBound="47.1" HigherBound="51.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Z_GET_CUSTOMER_MATERIAL" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="3ca83609-61f4-4fe0-8c06-a4e5196291b5" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="49.13" HigherBound="49.41">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_Rfc_CustMatReq" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="61c52d47-f91c-4af2-b7bd-5cf139ca155d" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="49.43" HigherBound="49.72">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_Rfc_CustMatResp" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="5d45179e-02c3-49e8-8704-4cb44ea7e7c4" ParentLink="Module_PortType" LowerBound="52.1" HigherBound="59.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Send_AlertEmail" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="29c6a782-dba8-489c-8cd8-85797e1b5a10" ParentLink="PortType_OperationDeclaration" LowerBound="54.1" HigherBound="58.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_Send_AlertEmail" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="f8b5fb6f-aa10-4ec7-be15-0263dff83fb3" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="56.13" HigherBound="56.36">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_Exception" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="8a20950f-395a-44b3-ba02-913f982f5e2f" ParentLink="Module_PortType" LowerBound="59.1" HigherBound="66.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_Send_SinglecXMLArchive" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="6746d2fd-e1e5-4f46-9a4c-1b9c8f4a07a2" ParentLink="PortType_OperationDeclaration" LowerBound="61.1" HigherBound="65.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_Send_SinglecXMLArchive" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="b4d2a225-7656-41d3-aae2-a854205b96d0" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="63.13" HigherBound="63.36">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_LionOrder" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="1316cff6-bc39-4f12-ba43-61eea58c15d7" ParentLink="Module_ServiceDeclaration" LowerBound="66.1" HigherBound="364.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="ProcessOrder" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="a2bb4e73-56d7-4844-a54e-4ea84f19c443" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="87.1" HigherBound="88.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vReleaseType" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f0e48f6a-ce35-4509-93b5-8cf52aa6b648" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="88.1" HigherBound="89.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vKUNNR" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4c90e9bb-7873-4948-a345-f982d24e1c47" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="89.1" HigherBound="90.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vOrderType" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="52c5d737-76a0-48d9-ab44-35307e7ce4a0" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="90.1" HigherBound="91.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vType" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="830eb1ac-b10f-4816-aacf-6c3aa88060f5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="91.1" HigherBound="92.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vXmlSingleOrder" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8e2b883f-7ffc-435c-b632-20711624a119" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="92.1" HigherBound="93.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Exception" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vExpObj" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8a7d59e6-9396-4cdf-a275-9b4b30eff154" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="93.1" HigherBound="94.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vHasValue" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="259a025b-dac2-4f31-8dac-cdaac3358775" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="94.1" HigherBound="95.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vMaterialCode" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="43411ae7-6ab7-4c93-8a73-89508420903e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="95.1" HigherBound="96.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vLineNumber" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="91c8b6da-10e7-4826-b2e1-7faf65ca51e5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="96.1" HigherBound="97.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vStrbuilder_MsgBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="dcc8d601-30e9-48e3-afaa-1b05e7cf2267" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="97.1" HigherBound="98.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vIntegrationPoint" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="20557a31-a29a-4d5d-b318-698e1b9f8569" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="98.1" HigherBound="99.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vExcMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="81d56bb6-345a-4129-937a-0e2c8ea6ceef" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="99.1" HigherBound="100.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vWERKS" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7e617614-8b92-4f32-bf5d-4b6e8c205f44" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="100.1" HigherBound="101.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xDoc" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f0cc3d7a-33fa-4c7c-9020-80b93ef207c7" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="101.1" HigherBound="102.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xPath" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d77256a0-29a9-40d4-bf94-76568597226e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="102.1" HigherBound="103.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="nTotal" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2734807e-a506-4a80-bb4a-d3e74d52c01a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="103.1" HigherBound="104.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="nCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4ae03bff-9c61-4a2d-916e-7737fdcd714d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="104.1" HigherBound="105.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Guid" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vGUID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0763fd4f-b505-4651-b22b-bd46e8380d59" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="105.1" HigherBound="106.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vXmlResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d1123d66-609f-45e1-ab75-4bfcdc30dd60" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="106.1" HigherBound="107.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sGUID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c3c89a6e-6f23-4de9-a3bd-e86f7567d857" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="107.1" HigherBound="108.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sXmlResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9a051676-52a5-49a4-975b-cf1dd5579e26" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="108.1" HigherBound="109.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sTimeStamp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b9606122-371e-4eeb-83dd-e17d911886fb" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="109.1" HigherBound="110.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="vPONumber" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="48ab251a-a2e5-41a4-b8d5-6990d6749936" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="79.1" HigherBound="80.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_Exception" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="mEmailException" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="5d5072c3-bfa9-4de4-8355-bd773dfa6711" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="80.1" HigherBound="81.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_LionOrder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="mLionOrderSingleWerks" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4fa8418e-3708-4f7d-a424-ecd8c098cfb2" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="81.1" HigherBound="82.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_LionOrder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="mLionOrderSingle" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="a24c39c7-e57c-452c-acb4-72af75441859" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="82.1" HigherBound="83.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_LionOrder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="mLionOrder" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="b3ee226e-6275-4730-b609-59d5c3197c8e" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="83.1" HigherBound="84.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="mLionOrderAck" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="83c0b480-d4a1-4a48-8404-90e147a98b95" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="84.1" HigherBound="85.1">
                <om:Property Name="Type" Value="Visy.Middleware.Schemas.cXML_1_2_031.cXML_1_2_031.ItemOut" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="mItemOut" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="119f2714-8c4d-4161-a4ef-34161fce1e74" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="85.1" HigherBound="86.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_Rfc_CustMatReq" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="mRfcReq" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="82826a13-2dcc-4cfe-8963-1cd1edade899" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="86.1" HigherBound="87.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Lion.Orchestrations.MultipartType_Rfc_CustMatResp" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="mRfcResp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="4f2fdf9c-2942-4014-9f66-5522b9924938" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="58c84069-34f3-4fe6-a85e-0b0aee86a1b4" ParentLink="ServiceBody_Statement" LowerBound="112.1" HigherBound="134.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Operation_Receive_Order_From_Ariba" />
                    <om:Property Name="MessageName" Value="mLionOrder" />
                    <om:Property Name="OperationName" Value="Operation_Receive_Order_From_Ariba" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive_Lion_Order" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Construct" OID="bd3d9dc0-3796-4562-a38b-baa8158e6e49" ParentLink="ServiceBody_Statement" LowerBound="134.1" HigherBound="155.1">
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Construct_cXML_Response" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="MessageAssignment" OID="d3a9900a-e2db-4b58-bc4f-715932a07b91" ParentLink="ComplexStatement_Statement" LowerBound="137.1" HigherBound="154.1">
                        <om:Property Name="Expression" Value="vGUID = System.Guid.NewGuid();&#xD;&#xA;sGUID = vGUID.ToString();&#xD;&#xA;&#xD;&#xA;sTimeStamp = System.DateTime.Now.ToString(&quot;yyyy-MM-ddTHH:mm:sszzz&quot;);&#xD;&#xA;&#xD;&#xA;sXmlResponse = &quot;&lt;?xml version=\&quot;1.0\&quot; encoding=\&quot;UTF-8\&quot;?&gt;&quot;;&#xD;&#xA;sXmlResponse = sXmlResponse + &quot;&lt;cXML payloadID=\&quot;&quot;;&#xD;&#xA;sXmlResponse = sXmlResponse + sGUID;&#xD;&#xA;sXmlResponse = sXmlResponse + &quot;\&quot; timestamp=\&quot;&quot;;&#xD;&#xA;sXmlResponse = sXmlResponse + sTimeStamp;&#xD;&#xA;sXmlResponse = sXmlResponse + &quot;\&quot;&gt;&lt;Response&gt;&lt;Status code=\&quot;200\&quot; text=\&quot;OK\&quot;/&gt;&lt;/Response&gt;&lt;/cXML&gt;&quot;;&#xD;&#xA;&#xD;&#xA;vXmlResponse = new System.Xml.XmlDocument();&#xD;&#xA;vXmlResponse.LoadXml(sXmlResponse);&#xD;&#xA;&#xD;&#xA;mLionOrderAck = vXmlResponse;" />
                        <om:Property Name="ReportToAnalyst" Value="False" />
                        <om:Property Name="Name" Value="MessageAssignment_mResponse" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="MessageRef" OID="9c439d5d-d3ab-45d5-a988-d25640f2bcdc" ParentLink="Construct_MessageRef" LowerBound="135.23" HigherBound="135.36">
                        <om:Property Name="Ref" Value="mLionOrderAck" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="Send" OID="cafd1edf-0e22-45b5-86ea-08822fd1487d" ParentLink="ServiceBody_Statement" LowerBound="155.1" HigherBound="157.1">
                    <om:Property Name="PortName" Value="Operation_Receive_Order_From_Ariba" />
                    <om:Property Name="MessageName" Value="mLionOrderAck" />
                    <om:Property Name="OperationName" Value="Operation_Receive_Order_From_Ariba" />
                    <om:Property Name="OperationMessageName" Value="Response" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Send_Lion_Ack" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="VariableAssignment" OID="ba29bc09-cc0b-4dcb-a278-5686e19bac9c" ParentLink="ServiceBody_Statement" LowerBound="157.1" HigherBound="161.1">
                    <om:Property Name="Expression" Value="nCount = 1;&#xD;&#xA;nTotal = 0;&#xD;&#xA;vIntegrationPoint = &quot;Visy.Middleware.SAP.Lion.Orchestrations.ProcessOrder&quot;;" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Initialize_Variables" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="VariableAssignment" OID="c720ae77-1d3f-4300-8096-9c57ba1e2bfa" ParentLink="ServiceBody_Statement" LowerBound="161.1" HigherBound="165.1">
                    <om:Property Name="Expression" Value="nTotal = System.Convert.ToInt32(xpath(mLionOrder.MessagePart_LionOrder, &quot;count(/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031'])&quot;));&#xD;&#xA;&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;nTotal&quot;, nTotal.ToString());" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Get_Total_ItemOutNode" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="While" OID="df7f184b-5f8d-418d-ab8c-4a942a31c869" ParentLink="ServiceBody_Statement" LowerBound="165.1" HigherBound="362.1">
                    <om:Property Name="Expression" Value="nCount &lt;= nTotal" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Loop_Each_ItemOutNode" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="Scope" OID="f295aeae-b8d0-420a-bc40-23771a2177e2" ParentLink="ComplexStatement_Statement" LowerBound="168.1" HigherBound="359.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Scope_Process_SingleItemOutNode" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="ea935f3c-ef7e-44c6-a679-e664754d93c6" ParentLink="ComplexStatement_Statement" LowerBound="173.1" HigherBound="189.1">
                            <om:Property Name="Expression" Value="// INITIALIZE VALUE&#xD;&#xA;vHasValue = true;&#xD;&#xA;&#xD;&#xA;vPONumber = mLionOrder(Visy.Middleware.Schemas.cXML_1_2_031.PropertySchema.orderID);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;vPONumber &quot; + nCount.ToString(), vPONumber);&#xD;&#xA;&#xD;&#xA;xPath = System.String.Format(&quot;/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031'][{0}]/@*[local-name()='lineNumber' and namespace-uri()='']&quot;, nCount);&#xD;&#xA;vLineNumber = xpath(mLionOrder.MessagePart_LionOrder, xPath);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;vLineNumber &quot; + nCount.ToString(), vLineNumber);&#xD;&#xA;&#xD;&#xA;xPath = System.String.Format(&quot;string(/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031'][{0}]/*[local-name()='ItemID' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='BuyerPartID' and namespace-uri()='http://tempuri.org/cXML_1.2.031'])&quot;, nCount);&#xD;&#xA;vMaterialCode = xpath(mLionOrder.MessagePart_LionOrder, xPath);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;vMaterialCode &quot; + nCount.ToString(), vMaterialCode);&#xD;&#xA;&#xD;&#xA;if (vMaterialCode == null || vMaterialCode.Length == 0) {vHasValue = false;}" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Initialize_Variables" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Decision" OID="022653e5-e8a7-4ddc-98a3-85c1e6cbbd66" ParentLink="ComplexStatement_Statement" LowerBound="189.1" HigherBound="198.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Decide_ThrowingException" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="48fc9933-9d15-4960-919b-95cad8370ef6" ParentLink="ReallyComplexStatement_Branch" LowerBound="190.25" HigherBound="198.1">
                                <om:Property Name="Expression" Value="vHasValue == false&#xD;&#xA;" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Material Code is Missing" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="VariableAssignment" OID="aa2f30fb-ab9b-4f53-80a2-19635d327dd9" ParentLink="ComplexStatement_Statement" LowerBound="192.1" HigherBound="195.1">
                                    <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;SAP.Lion&quot;,&quot;Initialize Exception object - Missing Material Code&quot;);&#xD;&#xA;vExpObj = new System.Exception(System.String.Format(&quot;Missing Material Code for PO# &quot; + vPONumber));" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Initialize Error Message" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Throw" OID="b000d40c-ef1f-43eb-bff8-d8072eaab245" ParentLink="ComplexStatement_Statement" LowerBound="195.1" HigherBound="197.1">
                                    <om:Property Name="ThrownReference" Value="vExpObj" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ThrowException_Instance_LGXAPI0_Scope" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="45210ccc-68e6-4a83-85a4-fa351304aa57" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Construct" OID="a237cd7d-e042-4ce5-8233-c29e02555cd6" ParentLink="ComplexStatement_Statement" LowerBound="198.1" HigherBound="215.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct_SinglecXML" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="dcfc9983-cf95-42d4-a38a-8c2ea6f08f74" ParentLink="ComplexStatement_Statement" LowerBound="201.1" HigherBound="212.1">
                                <om:Property Name="Expression" Value="xPath = System.String.Format(&quot;/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031'][{0}]&quot;,nCount);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;nCount&quot;, nCount.ToString());&#xD;&#xA;&#xD;&#xA;xDoc = new System.Xml.XmlDocument();&#xD;&#xA;&#xD;&#xA;xDoc = xpath(mLionOrder.MessagePart_LionOrder, xPath);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;xDoc &quot; + nCount.ToString(), xDoc.OuterXml);&#xD;&#xA;&#xD;&#xA;mItemOut = xDoc;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="Create_SingleItemOutNode" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Transform" OID="b0c33d17-13f1-418a-b55a-bd445f24fdc3" ParentLink="ComplexStatement_Statement" LowerBound="212.1" HigherBound="214.1">
                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.Lion.Maps.Map_cXMLMultiLine_To_cXMLSingleLine" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Transform_OriginalcXML_To_SinglecXML " />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessagePartRef" OID="2726b5b7-d662-4b58-9678-c5812ca2bba2" ParentLink="Transform_InputMessagePartRef" LowerBound="213.149" HigherBound="213.181">
                                    <om:Property Name="MessageRef" Value="mLionOrder" />
                                    <om:Property Name="PartRef" Value="MessagePart_LionOrder" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_3" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessagePartRef" OID="578b1874-2837-4aa7-be9c-e7fe38b5c532" ParentLink="Transform_InputMessagePartRef" LowerBound="213.183" HigherBound="213.191">
                                    <om:Property Name="MessageRef" Value="mItemOut" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_4" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessagePartRef" OID="c00d234d-be0b-43b0-b5d6-49f7cebbd27e" ParentLink="Transform_OutputMessagePartRef" LowerBound="213.40" HigherBound="213.78">
                                    <om:Property Name="MessageRef" Value="mLionOrderSingle" />
                                    <om:Property Name="PartRef" Value="MessagePart_LionOrder" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_5" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="MessageRef" OID="868a2282-26f6-4fc0-a9fd-1eed2d28f94a" ParentLink="Construct_MessageRef" LowerBound="199.35" HigherBound="199.51">
                                <om:Property Name="Ref" Value="mLionOrderSingle" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="e0751b90-78dd-4132-9b4e-3d3dc78c3b21" ParentLink="Construct_MessageRef" LowerBound="199.53" HigherBound="199.61">
                                <om:Property Name="Ref" Value="mItemOut" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Construct" OID="fedaa8fa-03d2-452c-abdd-576d4954a935" ParentLink="ComplexStatement_Statement" LowerBound="215.1" HigherBound="221.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct_RfcRequest" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Transform" OID="ae892f08-7509-4343-9424-9c9f64f1f15f" ParentLink="ComplexStatement_Statement" LowerBound="218.1" HigherBound="220.1">
                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.Lion.Maps.Map_cXMLSingleLine_To_RfcGetCusMat" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Create_RfcRequest" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="MessagePartRef" OID="c7fbf97e-1e75-4e6c-b4d0-24a91b73811a" ParentLink="Transform_InputMessagePartRef" LowerBound="219.144" HigherBound="219.182">
                                    <om:Property Name="MessageRef" Value="mLionOrderSingle" />
                                    <om:Property Name="PartRef" Value="MessagePart_LionOrder" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_1" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessagePartRef" OID="46e51124-9691-4089-a250-69eb0ef516a0" ParentLink="Transform_OutputMessagePartRef" LowerBound="219.40" HigherBound="219.74">
                                    <om:Property Name="MessageRef" Value="mRfcReq" />
                                    <om:Property Name="PartRef" Value="MessagePart_Rfc_CustMatReq" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_2" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="MessageRef" OID="77cd9585-9361-4934-8ea7-e57370fd4697" ParentLink="Construct_MessageRef" LowerBound="216.35" HigherBound="216.42">
                                <om:Property Name="Ref" Value="mRfcReq" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="50a94525-1742-49e3-8736-51bc76ae293d" ParentLink="ComplexStatement_Statement" LowerBound="221.1" HigherBound="223.1">
                            <om:Property Name="PortName" Value="GetCusMat_RfcPort" />
                            <om:Property Name="MessageName" Value="mRfcReq" />
                            <om:Property Name="OperationName" Value="Z_GET_CUSTOMER_MATERIAL" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_RfcRequest" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Receive" OID="c03ee116-9d4e-4c24-a0a0-44aad5d6cfb4" ParentLink="ComplexStatement_Statement" LowerBound="223.1" HigherBound="225.1">
                            <om:Property Name="Activate" Value="False" />
                            <om:Property Name="PortName" Value="GetCusMat_RfcPort" />
                            <om:Property Name="MessageName" Value="mRfcResp" />
                            <om:Property Name="OperationName" Value="Z_GET_CUSTOMER_MATERIAL" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Receive_RfcResponse" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="3e75c0c8-3343-497a-ab6b-979c08276f7d" ParentLink="ComplexStatement_Statement" LowerBound="225.1" HigherBound="238.1">
                            <om:Property Name="Expression" Value="// INITIALIZE VALUE&#xD;&#xA;vHasValue = true;&#xD;&#xA;&#xD;&#xA;xPath = &quot;string(string(/*[local-name()='Z_GET_CUSTOMER_MATERIALResponse' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Rfc/']/*[local-name()='CUST_MAT' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Rfc/']/*[local-name()='ZST_CUSTMAT' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/'][1]/*[local-name()='WERKS' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/']))&quot;;&#xD;&#xA;vWERKS = xpath(mRfcResp.MessagePart_Rfc_CustMatResp, xPath);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;vWERKS&quot;, vWERKS);&#xD;&#xA;&#xD;&#xA;xPath = &quot;string(string(/*[local-name()='Z_GET_CUSTOMER_MATERIALResponse' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Rfc/']/*[local-name()='KUNNR_TAB' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Rfc/']/*[local-name()='ZST_KUNNR' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/'][1]/*[local-name()='KUNNR' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/']))&quot;;&#xD;&#xA;vKUNNR = xpath(mRfcResp.MessagePart_Rfc_CustMatResp, xPath);&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;vKUNNR&quot;, vKUNNR);&#xD;&#xA;&#xD;&#xA;if (vWERKS == null || vWERKS.Length == 0) {vHasValue = false;}" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Initialize_Variables" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Construct" OID="4a818e13-122d-49f6-b889-edcc68f8bc57" ParentLink="ComplexStatement_Statement" LowerBound="238.1" HigherBound="269.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Construct_SinglecXMLwithPlantCode" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Transform" OID="7692f664-530c-4e87-8de3-cd08d05bb681" ParentLink="ComplexStatement_Statement" LowerBound="241.1" HigherBound="243.1">
                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.Lion.Maps.Map_cXMLSingleLine_SAPRfcResp_To_cXMLSingleLineWERKS" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Transform_SinglecXML L_To_SinglecXMLWithPlantCode" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="MessagePartRef" OID="56677c61-8c87-4976-909f-3ad9c5f57af5" ParentLink="Transform_InputMessagePartRef" LowerBound="242.171" HigherBound="242.209">
                                    <om:Property Name="MessageRef" Value="mLionOrderSingle" />
                                    <om:Property Name="PartRef" Value="MessagePart_LionOrder" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_6" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessagePartRef" OID="efe6345d-17c7-4641-93af-716d20bbad03" ParentLink="Transform_InputMessagePartRef" LowerBound="242.211" HigherBound="242.247">
                                    <om:Property Name="MessageRef" Value="mRfcResp" />
                                    <om:Property Name="PartRef" Value="MessagePart_Rfc_CustMatResp" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_7" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessagePartRef" OID="69b25db1-bcbd-4e35-a613-ccd00f4f5363" ParentLink="Transform_OutputMessagePartRef" LowerBound="242.40" HigherBound="242.83">
                                    <om:Property Name="MessageRef" Value="mLionOrderSingleWerks" />
                                    <om:Property Name="PartRef" Value="MessagePart_LionOrder" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="MessagePartReference_8" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="MessageAssignment" OID="9c0fe8c5-811e-4c09-9325-9f5a2c4a9a8b" ParentLink="ComplexStatement_Statement" LowerBound="243.1" HigherBound="268.1">
                                <om:Property Name="Expression" Value="vXmlSingleOrder = new System.Xml.XmlDocument();&#xD;&#xA;vXmlSingleOrder = mLionOrderSingleWerks.MessagePart_LionOrder;&#xD;&#xA;vGUID = System.Guid.NewGuid();&#xD;&#xA;&#xD;&#xA;vOrderType = (xpath(mLionOrderSingleWerks.MessagePart_LionOrder, &quot;/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequestHeader' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/@*[local-name()='orderType' and namespace-uri()='']&quot;));&#xD;&#xA;vOrderType = vOrderType.ToUpper();&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Lion.ProcessOrder: OrderType: &quot; + vOrderType);&#xD;&#xA;&#xD;&#xA;vType = xpath(mLionOrderSingleWerks.MessagePart_LionOrder, &quot;/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequestHeader' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/@*[local-name()='type' and namespace-uri()='']&quot;);&#xD;&#xA;vType = vType.ToUpper();&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Lion.ProcessOrder: Type: &quot; + vType);&#xD;&#xA;&#xD;&#xA;//vReleaseType = xpath(mLionOrderSingleWerks.MessagePart_LionOrder, &quot;/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ReleaseInfo' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/@*[local-name()='releaseType' and namespace-uri()='']&quot;);&#xD;&#xA;//vReleaseType = vReleaseType.ToUpper();&#xD;&#xA;//System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Lion.ProcessOrder: Type: &quot; + vReleaseType);&#xD;&#xA;&#xD;&#xA;xPath = &quot;string(string(/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ReleaseInfo' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/@*[local-name()='releaseType' and namespace-uri()='']))&quot;;&#xD;&#xA;vReleaseType = xpath(mLionOrderSingleWerks.MessagePart_LionOrder, xPath);&#xD;&#xA;vReleaseType = vReleaseType.ToUpper();&#xD;&#xA;System.Diagnostics.EventLog.WriteEntry(&quot;BizTalkApp&quot;, &quot;SAP.Lion.ProcessOrder: ReleaseType: &quot; + vReleaseType);&#xD;&#xA;&#xD;&#xA;mLionOrderSingleWerks(FILE.ReceivedFileName) = vReleaseType + vOrderType + &quot;.&quot; + vType + &quot;.&quot; + vPONumber + &quot;.&quot; + vLineNumber + &quot;.&quot; + vGUID.ToString() + &quot;.xml&quot;;&#xD;&#xA;&#xD;&#xA;//if (!(vReleaseType == null) || vReleaseType.Length &gt; 0) {mLionOrderSingleWerks(FILE.ReceivedFileName) = vReleaseType + &quot;.&quot; + vOrderType + &quot;.&quot; + vType + &quot;.&quot; + vPONumber + &quot;.&quot; + vLineNumber + &quot;.&quot; + vGUID.ToString() + &quot;.xml&quot;;}" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="MessageAssignment" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="b0e8a985-2bbe-47a2-9ba9-02c6bcf279b6" ParentLink="Construct_MessageRef" LowerBound="239.35" HigherBound="239.56">
                                <om:Property Name="Ref" Value="mLionOrderSingleWerks" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="d42874a1-a047-4db0-85ed-3f8c5d0d493c" ParentLink="ComplexStatement_Statement" LowerBound="269.1" HigherBound="271.1">
                            <om:Property Name="PortName" Value="Port_Send_SinglecXML_Archive" />
                            <om:Property Name="MessageName" Value="mLionOrderSingleWerks" />
                            <om:Property Name="OperationName" Value="Operation_Send_SinglecXMLArchive" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_SinglecXMLArchive" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Decision" OID="5e683892-437a-4677-9b85-d47bb1fc832f" ParentLink="ComplexStatement_Statement" LowerBound="271.1" HigherBound="280.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Decide_ThrowingException" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="7c414597-3a05-45ff-b838-036cfd0c806f" ParentLink="ReallyComplexStatement_Branch" LowerBound="272.25" HigherBound="280.1">
                                <om:Property Name="Expression" Value="vHasValue == false&#xD;&#xA;" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Plant Code is Missing" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="VariableAssignment" OID="94280702-93f5-46c8-8818-61f50ddd6b5d" ParentLink="ComplexStatement_Statement" LowerBound="274.1" HigherBound="277.1">
                                    <om:Property Name="Expression" Value="System.Diagnostics.EventLog.WriteEntry(&quot;SAP.Lion&quot;,&quot;Initialize Exception object - Missing Plant Code&quot;);&#xD;&#xA;vExpObj = new System.Exception(System.String.Format(&quot;Missing Plant Code from SAP response for Customer Code &quot; + vKUNNR + &quot; and Material Code &quot; + vMaterialCode + &quot; in PO# &quot; + vPONumber));" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Initialize Error Message" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Throw" OID="74b2441f-73be-4bac-a2cd-8c9384f52b0b" ParentLink="ComplexStatement_Statement" LowerBound="277.1" HigherBound="279.1">
                                    <om:Property Name="ThrownReference" Value="vExpObj" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ThrowException_Instance_LGXAPI0_Scope" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="4c3095e4-7471-4350-b475-31dbe280d42c" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="cb7e65dd-4ea5-4df2-ab3b-97dcbd5cfe2a" ParentLink="ComplexStatement_Statement" LowerBound="280.1" HigherBound="282.1">
                            <om:Property Name="PortName" Value="Port_Send_SinglecXML" />
                            <om:Property Name="MessageName" Value="mLionOrderSingleWerks" />
                            <om:Property Name="OperationName" Value="Operation_Send_SinglecXML" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Send_SinglecXML" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Catch" OID="3e8d7eb3-dbfc-48f8-84c7-8e12169286b9" ParentLink="Scope_Catch" LowerBound="285.1" HigherBound="357.1">
                            <om:Property Name="ExceptionName" Value="CatchSystemException" />
                            <om:Property Name="ExceptionType" Value="System.Exception" />
                            <om:Property Name="IsFaultMessage" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Catch_System_Exception" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Construct" OID="56c8a2a3-c889-4f10-9107-87465757c44e" ParentLink="Catch_Statement" LowerBound="288.1" HigherBound="354.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Construct_ExceptionEmail" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="bd543ea1-5ab9-435b-8166-b9e81d8e8da8" ParentLink="Construct_MessageRef" LowerBound="289.39" HigherBound="289.54">
                                    <om:Property Name="Ref" Value="mEmailException" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="1e6c91e8-da8b-45f1-b239-ffc6101574ab" ParentLink="ComplexStatement_Statement" LowerBound="291.1" HigherBound="353.1">
                                    <om:Property Name="Expression" Value="vExcMsg = CatchSystemException.ToString();&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.Clear();&#xD;&#xA;&#xD;&#xA;//Build HTML Message bodystrbuilder_MsgBody = new System.Text.StringBuilder();&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;html&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;head&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/head&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;body&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;p&gt;&lt;B&gt;Ariba-Lion Order Processing Error&lt;/B&gt;&lt;/p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Date of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToString());&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Time of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Failure Point:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(vIntegrationPoint);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Exception:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(vExcMsg);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;PO Number:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(vPONumber.ToString());&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Line Number:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(vLineNumber.ToString());&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Material Code:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(vMaterialCode.ToString());&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Processing Server:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(System.Environment.MachineName);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;PO Line Item Details:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(vXmlSingleOrder.OuterXml);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/body&gt;&quot;);&#xD;&#xA;vStrbuilder_MsgBody.AppendLine(&quot;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;//Set Email Properties&#xD;&#xA;mEmailException.MessagePart_EmailBody = new Visy.Middleware.Components.Utilities.RawString(vStrbuilder_MsgBody.ToString());&#xD;&#xA;mEmailException.MessagePart_EmailBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;mEmailException(SMTP.Subject) = &quot;BT2016 SAP.Lion ProcessOrder Failed , Server: &quot; + System.Environment.MachineName;&#xD;&#xA;mEmailException(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="Assignment_ExceptionMessage" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="bbca15a9-16ed-4788-a356-4e1e849eac0e" ParentLink="Catch_Statement" LowerBound="354.1" HigherBound="356.1">
                                <om:Property Name="PortName" Value="Port_Send_AlertEmail" />
                                <om:Property Name="MessageName" Value="mEmailException" />
                                <om:Property Name="OperationName" Value="Operation_Send_AlertEmail" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_AlertEmail" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="VariableAssignment" OID="ae9dc2f3-fe36-4861-8234-45d9ef08ba65" ParentLink="ComplexStatement_Statement" LowerBound="359.1" HigherBound="361.1">
                        <om:Property Name="Expression" Value="nCount = nCount + 1;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="nCount++" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="d7d563de-df9e-4f33-917b-c639e9ca41df" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="69.1" HigherBound="71.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Unbound" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Lion.Orchestrations.PortType_Receive_Order_From_Ariba" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_Receive_Order_From_Ariba" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="b51d2294-7731-4efb-945e-f2ae863e56d7" ParentLink="PortDeclaration_CLRAttribute" LowerBound="69.1" HigherBound="70.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="7ab78a7b-e3af-42f3-8d08-13d07264b00e" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="71.1" HigherBound="73.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="99" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Lion.Orchestrations.PortType_SendReceive_Rfc" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="GetCusMat_RfcPort" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="1dd64f59-2296-4a5d-9931-61a61316ba0f" ParentLink="PortDeclaration_CLRAttribute" LowerBound="71.1" HigherBound="72.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="54f9ee1e-b6a8-4d2d-a63e-afc7c4e155f5" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="73.1" HigherBound="75.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="165" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Lion.Orchestrations.PortType_Send_AlertEmail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_Send_AlertEmail" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="6748699e-86ab-4621-81dd-5b3b810c5d58" ParentLink="PortDeclaration_CLRAttribute" LowerBound="73.1" HigherBound="74.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="5b837eae-b2d5-4139-b2d4-d2a23f5d8b7d" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="75.1" HigherBound="77.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="124" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Lion.Orchestrations.PortType_Send_SinglecXMLArchive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_Send_SinglecXML_Archive" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="7ec8e9d9-ca47-4804-adec-88bb7eb1904c" ParentLink="PortDeclaration_CLRAttribute" LowerBound="75.1" HigherBound="76.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="b5de0c1c-b335-4b76-8c19-abf239e0f131" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="77.1" HigherBound="79.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="147" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Lion.Orchestrations.PortType_Send_SinglecXML" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_Send_SinglecXML" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="977cb82b-1a04-4114-9684-e86562bed5e1" ParentLink="PortDeclaration_CLRAttribute" LowerBound="77.1" HigherBound="78.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="a6efb642-e57d-4598-82fe-e9bd5d5addb9" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="8.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_Exception" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="6858c9b5-a05c-4b7c-85cb-71f0ceea0b4e" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.Components.Utilities.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_EmailBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="4b6da7ac-cc84-41e6-a4bb-8adeffb9049f" ParentLink="Module_MessageType" LowerBound="8.1" HigherBound="12.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_Rfc_CustMatResp" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="69fe5922-73ef-4946-bad8-809cc2a44177" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="10.1" HigherBound="11.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.Common.Schemas.SAP.RFC_CUSMAT.Rfc.Z_GET_CUSTOMER_MATERIALResponse" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_Rfc_CustMatResp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="f0fdb6cf-cd09-4959-b83b-ca9a8a0a9330" ParentLink="Module_MessageType" LowerBound="12.1" HigherBound="16.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_Rfc_CustMatReq" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="20524dd6-c7dc-417d-bd9e-3c7070ac2a25" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="14.1" HigherBound="15.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.Common.Schemas.SAP.RFC_CUSMAT.Rfc.Z_GET_CUSTOMER_MATERIAL" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_Rfc_CustMatReq" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="3519b4c5-9a37-4074-9d93-5e23123604b3" ParentLink="Module_MessageType" LowerBound="16.1" HigherBound="20.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_SAPOrder" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="75fbef29-71d4-40c7-92a3-9f5e2515ebb0" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="18.1" HigherBound="19.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.Common.Schemas.SAP.Orders.Z3ORDERS05" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_SAPOrder" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="5abf8ae2-c6d9-440a-bbb2-66673efd2841" ParentLink="Module_MessageType" LowerBound="20.1" HigherBound="24.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="MultipartType_LionOrder" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="4cd04162-b81d-421f-b99e-94707cd47d69" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="22.1" HigherBound="23.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.Schemas.cXML_1_2_031.cXML_1_2_031.cXML" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MessagePart_LionOrder" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module Visy.Middleware.SAP.Lion.Orchestrations
{
    internal messagetype MultipartType_Exception
    {
        body Visy.Middleware.Components.Utilities.RawString MessagePart_EmailBody;
    };
    internal messagetype MultipartType_Rfc_CustMatResp
    {
        body Visy.Middleware.Common.Schemas.SAP.RFC_CUSMAT.Rfc.Z_GET_CUSTOMER_MATERIALResponse MessagePart_Rfc_CustMatResp;
    };
    internal messagetype MultipartType_Rfc_CustMatReq
    {
        body Visy.Middleware.Common.Schemas.SAP.RFC_CUSMAT.Rfc.Z_GET_CUSTOMER_MATERIAL MessagePart_Rfc_CustMatReq;
    };
    internal messagetype MultipartType_SAPOrder
    {
        body Visy.Middleware.Common.Schemas.SAP.Orders.Z3ORDERS05 MessagePart_SAPOrder;
    };
    internal messagetype MultipartType_LionOrder
    {
        body Visy.Middleware.Schemas.cXML_1_2_031.cXML_1_2_031.cXML MessagePart_LionOrder;
    };
    public porttype PortType_Receive_Order_From_Ariba
    {
        requestresponse Operation_Receive_Order_From_Ariba
        {
            MultipartType_LionOrder, System.Xml.XmlDocument
        };
    };
    internal porttype PortType_Send_Order_To_SAP
    {
        oneway Operation_Send_Order_To_SAP
        {
            MultipartType_SAPOrder
        };
    };
    internal porttype PortType_Send_SinglecXML
    {
        oneway Operation_Send_SinglecXML
        {
            MultipartType_LionOrder
        };
    };
    internal porttype PortType_SendReceive_Rfc
    {
        requestresponse Z_GET_CUSTOMER_MATERIAL
        {
            MultipartType_Rfc_CustMatReq, MultipartType_Rfc_CustMatResp
        };
    };
    internal porttype PortType_Send_AlertEmail
    {
        oneway Operation_Send_AlertEmail
        {
            MultipartType_Exception
        };
    };
    internal porttype PortType_Send_SinglecXMLArchive
    {
        oneway Operation_Send_SinglecXMLArchive
        {
            MultipartType_LionOrder
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service ProcessOrder
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements PortType_Receive_Order_From_Ariba Operation_Receive_Order_From_Ariba;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SendReceive_Rfc GetCusMat_RfcPort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_Send_AlertEmail Port_Send_AlertEmail;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_Send_SinglecXMLArchive Port_Send_SinglecXML_Archive;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_Send_SinglecXML Port_Send_SinglecXML;
        message MultipartType_Exception mEmailException;
        message MultipartType_LionOrder mLionOrderSingleWerks;
        message MultipartType_LionOrder mLionOrderSingle;
        message MultipartType_LionOrder mLionOrder;
        message System.Xml.XmlDocument mLionOrderAck;
        message Visy.Middleware.Schemas.cXML_1_2_031.cXML_1_2_031.ItemOut mItemOut;
        message MultipartType_Rfc_CustMatReq mRfcReq;
        message MultipartType_Rfc_CustMatResp mRfcResp;
        System.String vReleaseType;
        System.String vKUNNR;
        System.String vOrderType;
        System.String vType;
        System.Xml.XmlDocument vXmlSingleOrder;
        System.Exception vExpObj;
        System.Boolean vHasValue;
        System.String vMaterialCode;
        System.String vLineNumber;
        System.Text.StringBuilder vStrbuilder_MsgBody;
        System.String vIntegrationPoint;
        System.String vExcMsg;
        System.String vWERKS;
        System.Xml.XmlDocument xDoc;
        System.String xPath;
        System.Int32 nTotal;
        System.Int32 nCount;
        System.Guid vGUID;
        System.Xml.XmlDocument vXmlResponse;
        System.String sGUID;
        System.String sXmlResponse;
        System.String sTimeStamp;
        System.String vPONumber;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("58c84069-34f3-4fe6-a85e-0b0aee86a1b4")]
            activate receive (Operation_Receive_Order_From_Ariba.Operation_Receive_Order_From_Ariba, mLionOrder);
            vReleaseType = "";
            vKUNNR = "";
            vOrderType = "";
            vType = "";
            vXmlSingleOrder = new System.Xml.XmlDocument();
            vExpObj = new System.Exception();
            vHasValue = true;
            vMaterialCode = "";
            vLineNumber = "";
            vStrbuilder_MsgBody = new System.Text.StringBuilder();
            vIntegrationPoint = "";
            vExcMsg = "";
            vWERKS = "";
            xDoc = new System.Xml.XmlDocument();
            xPath = "";
            vXmlResponse = new System.Xml.XmlDocument();
            sGUID = "";
            sXmlResponse = "";
            sTimeStamp = "";
            vPONumber = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("bd3d9dc0-3796-4562-a38b-baa8158e6e49")]
            construct mLionOrderAck
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d3a9900a-e2db-4b58-bc4f-715932a07b91")]
                vGUID = System.Guid.NewGuid();
                sGUID = vGUID.ToString();
                
                sTimeStamp = System.DateTime.Now.ToString("yyyy-MM-ddTHH:mm:sszzz");
                
                sXmlResponse = "<?xml version=\"1.0\" encoding=\"UTF-8\"?>";
                sXmlResponse = sXmlResponse + "<cXML payloadID=\"";
                sXmlResponse = sXmlResponse + sGUID;
                sXmlResponse = sXmlResponse + "\" timestamp=\"";
                sXmlResponse = sXmlResponse + sTimeStamp;
                sXmlResponse = sXmlResponse + "\"><Response><Status code=\"200\" text=\"OK\"/></Response></cXML>";
                
                vXmlResponse = new System.Xml.XmlDocument();
                vXmlResponse.LoadXml(sXmlResponse);
                
                mLionOrderAck = vXmlResponse;
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("cafd1edf-0e22-45b5-86ea-08822fd1487d")]
            send (Operation_Receive_Order_From_Ariba.Operation_Receive_Order_From_Ariba, mLionOrderAck);
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ba29bc09-cc0b-4dcb-a278-5686e19bac9c")]
            nCount = 1;
            nTotal = 0;
            vIntegrationPoint = "Visy.Middleware.SAP.Lion.Orchestrations.ProcessOrder";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c720ae77-1d3f-4300-8096-9c57ba1e2bfa")]
            nTotal = System.Convert.ToInt32(xpath(mLionOrder.MessagePart_LionOrder, "count(/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031'])"));
            
            System.Diagnostics.EventLog.WriteEntry("nTotal", nTotal.ToString());
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("df7f184b-5f8d-418d-ab8c-4a942a31c869")]
            while (nCount <= nTotal)
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("f295aeae-b8d0-420a-bc40-23771a2177e2")]
                scope
                {
                    body
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ea935f3c-ef7e-44c6-a679-e664754d93c6")]
                        // INITIALIZE VALUE
                        vHasValue = true;
                        
                        vPONumber = mLionOrder(Visy.Middleware.Schemas.cXML_1_2_031.PropertySchema.orderID);
                        System.Diagnostics.EventLog.WriteEntry("vPONumber " + nCount.ToString(), vPONumber);
                        
                        xPath = System.String.Format("/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031'][{0}]/@*[local-name()='lineNumber' and namespace-uri()='']", nCount);
                        vLineNumber = xpath(mLionOrder.MessagePart_LionOrder, xPath);
                        System.Diagnostics.EventLog.WriteEntry("vLineNumber " + nCount.ToString(), vLineNumber);
                        
                        xPath = System.String.Format("string(/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031'][{0}]/*[local-name()='ItemID' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='BuyerPartID' and namespace-uri()='http://tempuri.org/cXML_1.2.031'])", nCount);
                        vMaterialCode = xpath(mLionOrder.MessagePart_LionOrder, xPath);
                        System.Diagnostics.EventLog.WriteEntry("vMaterialCode " + nCount.ToString(), vMaterialCode);
                        
                        if (vMaterialCode == null || vMaterialCode.Length == 0) {vHasValue = false;}
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("022653e5-e8a7-4ddc-98a3-85c1e6cbbd66")]
                        if (vHasValue == false)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("aa2f30fb-ab9b-4f53-80a2-19635d327dd9")]
                            System.Diagnostics.EventLog.WriteEntry("SAP.Lion","Initialize Exception object - Missing Material Code");
                            vExpObj = new System.Exception(System.String.Format("Missing Material Code for PO# " + vPONumber));
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b000d40c-ef1f-43eb-bff8-d8072eaab245")]
                            throw vExpObj;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a237cd7d-e042-4ce5-8233-c29e02555cd6")]
                        construct mLionOrderSingle, mItemOut
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("dcfc9983-cf95-42d4-a38a-8c2ea6f08f74")]
                            xPath = System.String.Format("/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031'][{0}]",nCount);
                            System.Diagnostics.EventLog.WriteEntry("nCount", nCount.ToString());
                            
                            xDoc = new System.Xml.XmlDocument();
                            
                            xDoc = xpath(mLionOrder.MessagePart_LionOrder, xPath);
                            System.Diagnostics.EventLog.WriteEntry("xDoc " + nCount.ToString(), xDoc.OuterXml);
                            
                            mItemOut = xDoc;
                            
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("b0c33d17-13f1-418a-b55a-bd445f24fdc3")]
                            transform (mLionOrderSingle.MessagePart_LionOrder) = Visy.Middleware.SAP.Lion.Maps.Map_cXMLMultiLine_To_cXMLSingleLine (mLionOrder.MessagePart_LionOrder, mItemOut);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("fedaa8fa-03d2-452c-abdd-576d4954a935")]
                        construct mRfcReq
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ae892f08-7509-4343-9424-9c9f64f1f15f")]
                            transform (mRfcReq.MessagePart_Rfc_CustMatReq) = Visy.Middleware.SAP.Lion.Maps.Map_cXMLSingleLine_To_RfcGetCusMat (mLionOrderSingle.MessagePart_LionOrder);
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("50a94525-1742-49e3-8736-51bc76ae293d")]
                        send (GetCusMat_RfcPort.Z_GET_CUSTOMER_MATERIAL, mRfcReq);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("c03ee116-9d4e-4c24-a0a0-44aad5d6cfb4")]
                        receive (GetCusMat_RfcPort.Z_GET_CUSTOMER_MATERIAL, mRfcResp);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3e75c0c8-3343-497a-ab6b-979c08276f7d")]
                        // INITIALIZE VALUE
                        vHasValue = true;
                        
                        xPath = "string(string(/*[local-name()='Z_GET_CUSTOMER_MATERIALResponse' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Rfc/']/*[local-name()='CUST_MAT' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Rfc/']/*[local-name()='ZST_CUSTMAT' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/'][1]/*[local-name()='WERKS' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/']))";
                        vWERKS = xpath(mRfcResp.MessagePart_Rfc_CustMatResp, xPath);
                        System.Diagnostics.EventLog.WriteEntry("vWERKS", vWERKS);
                        
                        xPath = "string(string(/*[local-name()='Z_GET_CUSTOMER_MATERIALResponse' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Rfc/']/*[local-name()='KUNNR_TAB' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Rfc/']/*[local-name()='ZST_KUNNR' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/'][1]/*[local-name()='KUNNR' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Rfc/']))";
                        vKUNNR = xpath(mRfcResp.MessagePart_Rfc_CustMatResp, xPath);
                        System.Diagnostics.EventLog.WriteEntry("vKUNNR", vKUNNR);
                        
                        if (vWERKS == null || vWERKS.Length == 0) {vHasValue = false;}
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4a818e13-122d-49f6-b889-edcc68f8bc57")]
                        construct mLionOrderSingleWerks
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7692f664-530c-4e87-8de3-cd08d05bb681")]
                            transform (mLionOrderSingleWerks.MessagePart_LionOrder) = Visy.Middleware.SAP.Lion.Maps.Map_cXMLSingleLine_SAPRfcResp_To_cXMLSingleLineWERKS (mLionOrderSingle.MessagePart_LionOrder, mRfcResp.MessagePart_Rfc_CustMatResp);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9c0fe8c5-811e-4c09-9325-9f5a2c4a9a8b")]
                            vXmlSingleOrder = new System.Xml.XmlDocument();
                            vXmlSingleOrder = mLionOrderSingleWerks.MessagePart_LionOrder;
                            vGUID = System.Guid.NewGuid();
                            
                            vOrderType = (xpath(mLionOrderSingleWerks.MessagePart_LionOrder, "/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequestHeader' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/@*[local-name()='orderType' and namespace-uri()='']"));
                            vOrderType = vOrderType.ToUpper();
                            System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Lion.ProcessOrder: OrderType: " + vOrderType);
                            
                            vType = xpath(mLionOrderSingleWerks.MessagePart_LionOrder, "/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequestHeader' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/@*[local-name()='type' and namespace-uri()='']");
                            vType = vType.ToUpper();
                            System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Lion.ProcessOrder: Type: " + vType);
                            
                            //vReleaseType = xpath(mLionOrderSingleWerks.MessagePart_LionOrder, "/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ReleaseInfo' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/@*[local-name()='releaseType' and namespace-uri()='']");
                            //vReleaseType = vReleaseType.ToUpper();
                            //System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Lion.ProcessOrder: Type: " + vReleaseType);
                            
                            xPath = "string(string(/*[local-name()='cXML' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='Request' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='OrderRequest' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ItemOut' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/*[local-name()='ReleaseInfo' and namespace-uri()='http://tempuri.org/cXML_1.2.031']/@*[local-name()='releaseType' and namespace-uri()='']))";
                            vReleaseType = xpath(mLionOrderSingleWerks.MessagePart_LionOrder, xPath);
                            vReleaseType = vReleaseType.ToUpper();
                            System.Diagnostics.EventLog.WriteEntry("BizTalkApp", "SAP.Lion.ProcessOrder: ReleaseType: " + vReleaseType);
                            
                            mLionOrderSingleWerks(FILE.ReceivedFileName) = vReleaseType + vOrderType + "." + vType + "." + vPONumber + "." + vLineNumber + "." + vGUID.ToString() + ".xml";
                            
                            //if (!(vReleaseType == null) || vReleaseType.Length > 0) {mLionOrderSingleWerks(FILE.ReceivedFileName) = vReleaseType + "." + vOrderType + "." + vType + "." + vPONumber + "." + vLineNumber + "." + vGUID.ToString() + ".xml";}
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d42874a1-a047-4db0-85ed-3f8c5d0d493c")]
                        send (Port_Send_SinglecXML_Archive.Operation_Send_SinglecXMLArchive, mLionOrderSingleWerks);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("5e683892-437a-4677-9b85-d47bb1fc832f")]
                        if (vHasValue == false)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("94280702-93f5-46c8-8818-61f50ddd6b5d")]
                            System.Diagnostics.EventLog.WriteEntry("SAP.Lion","Initialize Exception object - Missing Plant Code");
                            vExpObj = new System.Exception(System.String.Format("Missing Plant Code from SAP response for Customer Code " + vKUNNR + " and Material Code " + vMaterialCode + " in PO# " + vPONumber));
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("74b2441f-73be-4bac-a2cd-8c9384f52b0b")]
                            throw vExpObj;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("cb7e65dd-4ea5-4df2-ab3b-97dcbd5cfe2a")]
                        send (Port_Send_SinglecXML.Operation_Send_SinglecXML, mLionOrderSingleWerks);
                    }
                    exceptions
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3e8d7eb3-dbfc-48f8-84c7-8e12169286b9")]
                        catch (System.Exception CatchSystemException)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("56c8a2a3-c889-4f10-9107-87465757c44e")]
                            construct mEmailException
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("1e6c91e8-da8b-45f1-b239-ffc6101574ab")]
                                vExcMsg = CatchSystemException.ToString();
                                
                                vStrbuilder_MsgBody.Clear();
                                
                                //Build HTML Message bodystrbuilder_MsgBody = new System.Text.StringBuilder();
                                vStrbuilder_MsgBody.AppendLine("<html>");
                                vStrbuilder_MsgBody.AppendLine("<head>");
                                vStrbuilder_MsgBody.AppendLine("</head>");
                                vStrbuilder_MsgBody.AppendLine("<body>");
                                vStrbuilder_MsgBody.AppendLine("<p><B>Ariba-Lion Order Processing Error</B></p>");
                                
                                vStrbuilder_MsgBody.AppendLine("<table>");
                                
                                vStrbuilder_MsgBody.AppendLine("<tr><td>Date of Error:</td><td>");
                                vStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToString());
                                vStrbuilder_MsgBody.AppendLine("</td></tr>");
                                
                                
                                vStrbuilder_MsgBody.AppendLine("<tr><td>Time of Error:</td><td>");
                                vStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());
                                vStrbuilder_MsgBody.AppendLine("</td></tr>");
                                
                                
                                vStrbuilder_MsgBody.AppendLine("<tr><td>Failure Point:</td><td>");
                                vStrbuilder_MsgBody.AppendLine(vIntegrationPoint);
                                vStrbuilder_MsgBody.AppendLine("</td></tr>");
                                
                                vStrbuilder_MsgBody.AppendLine("<tr><td>Exception:</td><td>");
                                vStrbuilder_MsgBody.AppendLine(vExcMsg);
                                vStrbuilder_MsgBody.AppendLine("</td></tr>");
                                
                                vStrbuilder_MsgBody.AppendLine("<tr><td>PO Number:</td><td>");
                                vStrbuilder_MsgBody.AppendLine(vPONumber.ToString());
                                vStrbuilder_MsgBody.AppendLine("</td></tr>");
                                
                                vStrbuilder_MsgBody.AppendLine("<tr><td>Line Number:</td><td>");
                                vStrbuilder_MsgBody.AppendLine(vLineNumber.ToString());
                                vStrbuilder_MsgBody.AppendLine("</td></tr>");
                                
                                vStrbuilder_MsgBody.AppendLine("<tr><td>Material Code:</td><td>");
                                vStrbuilder_MsgBody.AppendLine(vMaterialCode.ToString());
                                vStrbuilder_MsgBody.AppendLine("</td></tr>");
                                
                                vStrbuilder_MsgBody.AppendLine("<tr><td>Processing Server:</td><td>");
                                vStrbuilder_MsgBody.AppendLine(System.Environment.MachineName);
                                vStrbuilder_MsgBody.AppendLine("</td></tr>");
                                
                                vStrbuilder_MsgBody.AppendLine("<tr><td>PO Line Item Details:</td><td>");
                                vStrbuilder_MsgBody.AppendLine(vXmlSingleOrder.OuterXml);
                                vStrbuilder_MsgBody.AppendLine("</td></tr>");
                                
                                vStrbuilder_MsgBody.AppendLine("</table>");
                                
                                vStrbuilder_MsgBody.AppendLine("</body>");
                                vStrbuilder_MsgBody.AppendLine("</html>");
                                
                                //Set Email Properties
                                mEmailException.MessagePart_EmailBody = new Visy.Middleware.Components.Utilities.RawString(vStrbuilder_MsgBody.ToString());
                                mEmailException.MessagePart_EmailBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                mEmailException(SMTP.Subject) = "BT2016 SAP.Lion ProcessOrder Failed , Server: " + System.Environment.MachineName;
                                mEmailException(SMTP.EmailBodyFileCharset) = "UTF-8";
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("bbca15a9-16ed-4788-a356-4e1e849eac0e")]
                            send (Port_Send_AlertEmail.Operation_Send_AlertEmail, mEmailException);
                        }
                    }
                }
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ae9dc2f3-fe36-4861-8234-45d9ef08ba65")]
                nCount = nCount + 1;
            }
        }
    }
}

