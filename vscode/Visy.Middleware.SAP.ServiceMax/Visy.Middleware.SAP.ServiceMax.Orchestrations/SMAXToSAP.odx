#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="400afe22-c0d0-41f4-b0a0-4127275bc617" LowerBound="1.1" HigherBound="718.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.SMAXToSap" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="bcec8122-1e91-434a-807c-a9a6ecc6837d" ParentLink="Module_PortType" LowerBound="8.1" HigherBound="15.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="portType_SendToSAP" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="3990338b-1323-41e1-add8-8706b38f040f" ParentLink="PortType_OperationDeclaration" LowerBound="10.1" HigherBound="14.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="operation_SendToSAP" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="014e3e57-cffa-4fe5-83f8-275d7ab5a662" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="12.13" HigherBound="12.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="da5cade2-7c2b-4b3e-a68a-4f5d7eb5b21c" ParentLink="Module_PortType" LowerBound="15.1" HigherBound="22.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="portType_RecInXML" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="f130157b-f127-437b-9e22-44d7fd8837c5" ParentLink="PortType_OperationDeclaration" LowerBound="17.1" HigherBound="21.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_RecinXML" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="97c171c3-5b3c-4cb5-a915-c71582ac673e" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="19.13" HigherBound="19.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="8e34e2ae-eaf1-4f72-9af3-ea18897d5eea" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="19.37" HigherBound="19.103">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxSAPResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="e8007606-ef00-4378-8982-5091f979b674" ParentLink="Module_PortType" LowerBound="22.1" HigherBound="29.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="portType_SuspendMsg" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="6ad5d9a1-4d60-4cd2-ba15-1e09502913e2" ParentLink="PortType_OperationDeclaration" LowerBound="24.1" HigherBound="28.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="operation_SuspendMsg" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="a94ba7b4-1550-4e0a-a50d-c699a7f535ba" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="26.13" HigherBound="26.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="e0315ee5-6e5d-46e4-8103-470fd5228191" ParentLink="Module_PortType" LowerBound="29.1" HigherBound="36.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="portType_InXML" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="4582dfaa-6e0e-41cf-8ae3-0cc8eb09ecee" ParentLink="PortType_OperationDeclaration" LowerBound="31.1" HigherBound="35.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="operation_InXML" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="b42d039f-fba7-4046-ac85-4dbff4ae4fa5" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="33.13" HigherBound="33.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="MessageRef" OID="7033a140-c3fd-4c30-8e8a-7abf9cdca91b" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="33.37" HigherBound="33.59">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="28b6d617-38d6-42bb-a50f-f35f59d7d330" ParentLink="Module_PortType" LowerBound="36.1" HigherBound="43.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="portType_SendMail" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="OperationDeclaration" OID="bc6ea97a-6ec2-4fd7-81c5-f942adb5d3c5" ParentLink="PortType_OperationDeclaration" LowerBound="38.1" HigherBound="42.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="operation_SendMail" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="01fd801c-4326-45c6-bf2c-82ca1126ff0c" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="40.13" HigherBound="40.31">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.SMAXToSap.emailExceptionType" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="0bc063ce-651c-429c-a459-4933c483dff1" ParentLink="Module_PortType" LowerBound="43.1" HigherBound="50.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Public" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SAPInboundArchive" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="f1ecf13d-8e2f-4417-9973-100d85e30765" ParentLink="PortType_OperationDeclaration" LowerBound="45.1" HigherBound="49.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="af522a90-e8cf-4735-8e36-699dfb2168cd" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="47.13" HigherBound="47.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="64e89f0e-c43b-49a5-aaf0-a8b2f72f1f10" ParentLink="Module_PortType" LowerBound="50.1" HigherBound="57.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Public" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SalesForceArchive" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="01117d2f-167e-442e-bf5f-b044f2477f18" ParentLink="PortType_OperationDeclaration" LowerBound="52.1" HigherBound="56.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="7964b0f9-3254-42a8-89eb-d1545cf14dde" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="54.13" HigherBound="54.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="0486a0af-a9ed-451c-9389-dca285c1d831" ParentLink="Module_ServiceDeclaration" LowerBound="57.1" HigherBound="717.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SMAXToSAP" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="4bccbbe7-662c-41d4-828e-ac2bdc3f5bc9" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="86.1" HigherBound="87.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varZSMINVOICE_INV" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a48d5ae8-3b7b-4d89-ae75-ddbf1a29d1ec" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="87.1" HigherBound="88.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varPORDCR05_PUR" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="49f3b863-2aee-4723-a3ad-1ef3fa98cea3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="88.1" HigherBound="89.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMBGMCR03_ST" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="520bd6b0-7198-4fcd-a529-acf122d5bc3f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="89.1" HigherBound="90.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Guid" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varToken" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8e73b640-20f1-4fb5-8488-d983b27b1dc6" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="90.1" HigherBound="91.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varStrbuilder_MsgBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="208a2405-5630-4cd4-bbd5-67bf88de85e3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="91.1" HigherBound="92.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMBGMCR03_WOD" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="63e146e0-b81e-444a-84c5-0f5e78f8f384" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="92.1" HigherBound="93.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMsgType" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="97a8c756-b6fb-4bbf-a0e8-8de119b51b00" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="93.1" HigherBound="94.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varIsSoapExp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="60841b47-8c96-43b1-8fbe-28602ec64c53" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="94.1" HigherBound="95.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Exception" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varExpObj" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2203ca2c-5673-4656-9110-4aef76ee870a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="95.1" HigherBound="96.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varStrException" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="822a3d9e-06e1-49bc-8c61-19f4ad6c0a7b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="96.1" HigherBound="97.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varRetryLimit" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="116ad8de-62ca-49a5-a459-36dc40b6f940" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="97.1" HigherBound="98.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varRetryInterval" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="03981851-62c2-43d6-925b-cec1164aeb47" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="98.1" HigherBound="99.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varRetryCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="a99391ba-1d79-47e3-a5cb-ca3eedcf11a8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="99.1" HigherBound="100.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varXmlDoc" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="87f917b4-d576-4948-bd66-f1d2ce67446f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="100.1" HigherBound="101.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varIsException" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ab587657-c219-4eeb-945b-b7ac5e096b4f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="101.1" HigherBound="102.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e3984e92-92a3-4928-a5eb-25ab0d1317e7" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="102.1" HigherBound="103.1">
                <om:Property Name="InitialValue" Value="true" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varPREQCR03_PO" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="70c0cac4-fb36-4670-bded-8ca455dd7236" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="103.1" HigherBound="104.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varResponseString" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="13e14d06-87cb-46d1-aa3b-28c2a56e6482" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="104.1" HigherBound="105.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varDelExcp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e31c59da-c54f-4c87-b753-4e454820f0c7" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="105.1" HigherBound="106.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varIntegrationPoint" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ad598f39-d09e-47ca-9fba-41b0ed15f00e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="106.1" HigherBound="107.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varWODDetailCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8b1d3402-03c3-438e-a264-6b86c5c5e2c3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="107.1" HigherBound="108.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCounterString" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ddbfebc1-e886-43e2-8252-1fae0d773e2d" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="108.1" HigherBound="109.1">
                <om:Property Name="InitialValue" Value="1" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varCounter" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="41b45e17-99be-4c27-9551-fa29a7b37308" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="109.1" HigherBound="110.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varMsgSAPCombined" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="b44cd85e-d9cf-4263-a6d7-2f75263e5946" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="110.1" HigherBound="111.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveFileName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="67b0a3bc-7a20-4105-86e8-31c5b06455d1" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="69.1" HigherBound="70.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgFailedInterchange" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="60791513-1465-4c7f-a66e-3ead644ebd73" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="70.1" HigherBound="71.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.SMAXToSap.emailExceptionType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgEmailException" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2e95a7e2-b149-4da9-b040-51499d09bf16" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="71.1" HigherBound="72.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgInXML" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="a49db464-aaf4-42a6-af10-d390861309b1" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="72.1" HigherBound="73.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.MBGMCR03.IDocOperation_MBGMCR03_740_3_Send" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgMBGMCR03" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="5cbd0587-fd82-4f10-9a95-893505883d13" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="73.1" HigherBound="74.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPWorkOrder.workOrderRequest" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgWOD" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e52f7405-0639-4b0e-8a43-48ca73c785a4" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="74.1" HigherBound="75.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="1eba1a51-79d7-4955-9ce9-e2708a13e234" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="75.1" HigherBound="76.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgSAP" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="3638696e-fda4-4a28-a674-6fdd040c499f" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="76.1" HigherBound="77.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPStockTransfer.stockTransferRequest" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgST" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="caa87731-e621-45b3-8ac6-495057f6d1d7" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="77.1" HigherBound="78.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPPurchaseOrder.purchaseOrderRequest" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgPO" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="c1634882-0cd5-4f3f-b11c-a620d7e7ff31" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="78.1" HigherBound="79.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.PREQCR03.IDocOperation_PREQCR03_740_3_Send" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgPREQCR03" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="1392066d-a08e-45b7-bb6a-7e6e65257016" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="79.1" HigherBound="80.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.PORDCR05.IDocOperation_PORDCR05_740_3_Send" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgPORDCR05" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="bd88e4eb-7f79-45ed-b482-7f75f54d974a" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="80.1" HigherBound="81.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPPurchase.purchaseRequest" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgPUR" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="9686ce05-a960-4575-b3a0-471e3fa209ce" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="81.1" HigherBound="82.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.ZSM_DEBIT_MEMO.IDocOperation_ZSM_DEBIT_MEMO_740_3_Send" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgZSMDEBITMEMO" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="c4e80fe5-f6c6-4d69-a546-e2cbe37db772" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="82.1" HigherBound="83.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPInvoice.invoiceRequest" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgINV" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="342b25a2-8697-49a6-890d-13fc2bad4217" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="83.1" HigherBound="84.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPWorkOrderInternal" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgWODInternal" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="5c39fdf7-4616-490b-8796-e89adca57606" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="84.1" HigherBound="85.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPWorkOrderInternalDetail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgWODInternalDetail" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="59a6ad8d-194f-4df4-baa5-0c0ff78cd6d2" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="85.1" HigherBound="86.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgArchiveIn" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="27cfaaef-ec26-44a8-ad55-8462a1a2194e" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="d09520d7-f13d-484f-b464-81ac8c76b44e" ParentLink="ServiceBody_Statement" LowerBound="113.1" HigherBound="135.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="port_InXML" />
                    <om:Property Name="MessageName" Value="msgInXML" />
                    <om:Property Name="OperationName" Value="operation_InXML" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="receive_msgInXML" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="DNFPredicate" OID="6e172af6-db9e-404f-9155-49dc6a19eedd" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrder#workOrderRequest&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="125c428c-76d1-4c05-a87c-e3c28817cf87" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPStockTransfer#stockTransferRequest&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="9c395e24-b1e0-4d94-975f-d5f58a7f1da9" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPPurchaseOrder#purchaseOrderRequest&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="08fc6065-8be4-4ac6-86b2-adfbaeeb47d9" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPPurchase#purchaseRequest&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="a40f16c8-2119-470b-8532-d66997ad1070" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPInvoice#invoiceRequest&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="VariableAssignment" OID="1ac9c9e4-8530-4ba2-b7a1-bb0a1f644de0" ParentLink="ServiceBody_Statement" LowerBound="135.1" HigherBound="138.1">
                    <om:Property Name="Expression" Value="varToken = System.Guid.NewGuid();//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceIn(&quot;SAPToServiceMax Orchestration started&quot;);&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Received Msg from Service Max &quot; + msgInXML.OuterXml , varToken));&#xD;&#xA;" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="exp_InitialiseTracing" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Scope" OID="59ec60ef-dabc-4aea-babd-a6cf2356d4a7" ParentLink="ServiceBody_Statement" LowerBound="138.1" HigherBound="715.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="scope_Main" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="Scope" OID="f335bc24-fd9b-4f7e-a1f5-784149f161b0" ParentLink="ComplexStatement_Statement" LowerBound="143.1" HigherBound="642.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="scope_SendToSAP" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="9e013409-6a01-47be-b40b-295bc8d05342" ParentLink="ComplexStatement_Statement" LowerBound="148.1" HigherBound="162.1">
                            <om:Property Name="Expression" Value="varRetryLimit = System.Convert.ToInt32(Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData(&quot;RetryLimit&quot;, &quot;SAP.ServiceMax&quot;));&#xD;&#xA;varRetryInterval = System.Convert.ToInt32(Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData(&quot;RetryInterval&quot;, &quot;SAP.ServiceMax&quot;));&#xD;&#xA;varRetryCount = 1;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Retrieving Values from SSO Config &quot; ,varToken));&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : retry Limit : &quot; + varRetryLimit.ToString() ,varToken));&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : retry interval : &quot; + varRetryInterval.ToString()  ,varToken));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="exp_SetRetryCount" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="e7f4a110-da4b-4ce0-9b56-53255ed8e5b5" ParentLink="ComplexStatement_Statement" LowerBound="162.1" HigherBound="224.1">
                            <om:Property Name="Expression" Value="varMsgType = msgInXML(BTS.MessageType);&#xD;&#xA;varMBGMCR03_WOD = false;&#xD;&#xA;varPREQCR03_PO = false;&#xD;&#xA;varMBGMCR03_ST = false;&#xD;&#xA;varPORDCR05_PUR = false;&#xD;&#xA;varZSMINVOICE_INV = false;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Checking Message Type :&quot; + varMsgType,varToken));&#xD;&#xA;&#xD;&#xA;if(varMsgType.Contains(&quot;workOrder&quot;))&#xD;&#xA;{&#xD;&#xA;   varIntegrationPoint = &quot;SMAX-SAP_WOD&quot;;&#xD;&#xA;   //varFlowTracker.IntegrationPoint=&quot;SMAX-SAP_WOD&quot;;&#xD;&#xA;   //varFlowTracker.CommitServiceMaxToSAPActivity();  &#xD;&#xA;   varMBGMCR03_WOD = true;&#xD;&#xA;   &#xD;&#xA;   varResponseString = System.String.Format(&quot;&lt;ns0:workOrderResponse xmlns:ns0='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrder'&gt; &lt;ns1:Response xmlns:ns1='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxSAPResponse'&gt; &lt;Status&gt;ACK&lt;/Status&gt;   &lt;ID&gt;{0}&lt;/ID&gt;   &lt;/ns1:Response&gt;   &lt;/ns0:workOrderResponse&gt;&quot;,varToken.ToString());&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;if(varMsgType.Contains(&quot;stockTransfer&quot;))&#xD;&#xA;{&#xD;&#xA;    varIntegrationPoint = &quot;SMAX-SAP_ST&quot;;&#xD;&#xA;   //varFlowTracker.IntegrationPoint=&quot;SMAX-SAP_ST&quot;;&#xD;&#xA;   //varFlowTracker.CommitServiceMaxToSAPActivity();&#xD;&#xA;   varMBGMCR03_ST = true;&#xD;&#xA;   varResponseString = System.String.Format(&quot;&lt;ns0:stockTransferResponse xmlns:ns0='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPStockTransfer'&gt; &lt;ns1:Response xmlns:ns1='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxSAPResponse'&gt; &lt;Status&gt;ACK&lt;/Status&gt;   &lt;ID&gt;{0}&lt;/ID&gt;   &lt;/ns1:Response&gt;   &lt;/ns0:stockTransferResponse&gt;&quot;, varToken.ToString());&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if(varMsgType.Contains(&quot;purchaseOrderRequest&quot;))&#xD;&#xA;{&#xD;&#xA;    varIntegrationPoint = &quot;SMAX-SAP_PO&quot;;&#xD;&#xA;    //varFlowTracker.IntegrationPoint=&quot;SMAX-SAP_PO&quot;;&#xD;&#xA;    //varFlowTracker.CommitServiceMaxToSAPActivity();&#xD;&#xA;    varPREQCR03_PO = true;&#xD;&#xA;    varResponseString = System.String.Format(&quot;&lt;ns0:purchaseOrderResponse xmlns:ns0='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPPurchaseOrder'&gt; &lt;ns1:Response xmlns:ns1='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxSAPResponse'&gt; &lt;Status&gt;ACK&lt;/Status&gt;   &lt;ID&gt;{0}&lt;/ID&gt;   &lt;/ns1:Response&gt;   &lt;/ns0:purchaseOrderResponse&gt;&quot;,varToken.ToString());&#xD;&#xA;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if(varMsgType.Contains(&quot;purchaseRequest&quot;))&#xD;&#xA;{&#xD;&#xA;    varIntegrationPoint = &quot;SMAX-SAP_PUR&quot;;&#xD;&#xA;    //varFlowTracker.IntegrationPoint=&quot;SMAX-SAP_PUR&quot;;&#xD;&#xA;    //varFlowTracker.CommitServiceMaxToSAPActivity();&#xD;&#xA;    varPORDCR05_PUR = true;&#xD;&#xA;    varResponseString = System.String.Format(&quot;&lt;ns0:purchaseResponse xmlns:ns0='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPPurchase'&gt; &lt;ns1:Response xmlns:ns1='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxSAPResponse'&gt; &lt;Status&gt;ACK&lt;/Status&gt;   &lt;ID&gt;{0}&lt;/ID&gt;   &lt;/ns1:Response&gt;   &lt;/ns0:purchaseResponse&gt;&quot;,varToken.ToString());&#xD;&#xA;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if(varMsgType.Contains(&quot;invoiceRequest&quot;))&#xD;&#xA;{&#xD;&#xA;    varIntegrationPoint = &quot;SMAX-SAP_INV&quot;;&#xD;&#xA;    //varFlowTracker.IntegrationPoint=&quot;SMAX-SAP_INV&quot;;&#xD;&#xA;    //varFlowTracker.CommitServiceMaxToSAPActivity();&#xD;&#xA;    varZSMINVOICE_INV = true;&#xD;&#xA;    varResponseString = System.String.Format(&quot;&lt;ns0:invoiceResponse xmlns:ns0='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPInvoice'&gt; &lt;ns1:Response xmlns:ns1='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxSAPResponse'&gt; &lt;Status&gt;ACK&lt;/Status&gt;   &lt;ID&gt;{0}&lt;/ID&gt;   &lt;/ns1:Response&gt;   &lt;/ns0:invoiceResponse&gt;&quot;, varToken.ToString());&#xD;&#xA;&#xD;&#xA;}&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="exp_CheckMsgTypeAndConstructResponse" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Construct" OID="071b82c3-9e53-4f48-8049-5c70b12cd103" ParentLink="ComplexStatement_Statement" LowerBound="224.1" HigherBound="237.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="construct_ResponseMsg" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="6dd37f2f-5b74-473b-a5a3-3db5bff3a71f" ParentLink="ComplexStatement_Statement" LowerBound="227.1" HigherBound="236.1">
                                <om:Property Name="Expression" Value="varXmlDoc = new System.Xml.XmlDocument();&#xD;&#xA;varXmlDoc.LoadXml(varResponseString);&#xD;&#xA;msgResponse = varXmlDoc;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Response Message Constructed &quot; ,varToken));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="assignment_ResponseMsg" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="d084a3b1-5541-418d-b45b-c63f7c69c65e" ParentLink="Construct_MessageRef" LowerBound="225.39" HigherBound="225.50">
                                <om:Property Name="Ref" Value="msgResponse" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="0f76e7ed-90e1-4741-b724-06f344e2955a" ParentLink="ComplexStatement_Statement" LowerBound="237.1" HigherBound="239.1">
                            <om:Property Name="PortName" Value="port_InXML" />
                            <om:Property Name="MessageName" Value="msgResponse" />
                            <om:Property Name="OperationName" Value="operation_InXML" />
                            <om:Property Name="OperationMessageName" Value="Response" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="send_Response" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Decision" OID="5bef580d-2081-456b-9e26-ffd467b41524" ParentLink="ComplexStatement_Statement" LowerBound="239.1" HigherBound="563.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Check_WorkOrder" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="2d8f1f1a-e288-4b09-aba8-12005ccb56f7" ParentLink="ReallyComplexStatement_Branch" LowerBound="240.29" HigherBound="369.1">
                                <om:Property Name="Expression" Value="varMBGMCR03_WOD == true" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="WorkOrder" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Construct" OID="9577d9ce-4617-4ad9-9eef-6c51c193f3ae" ParentLink="ComplexStatement_Statement" LowerBound="242.1" HigherBound="252.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="construct_WOD" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="a5a37141-0f6e-4f1c-926d-8fa1b61b97c5" ParentLink="ComplexStatement_Statement" LowerBound="245.1" HigherBound="251.1">
                                        <om:Property Name="Expression" Value="msgWOD = msgInXML;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} :WOD Message Constructed &quot;  ,varToken));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="assignment_WOD" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="c5724c7a-efff-4fb5-bcf2-0c35adc8e46c" ParentLink="Construct_MessageRef" LowerBound="243.43" HigherBound="243.49">
                                        <om:Property Name="Ref" Value="msgWOD" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="7a52f13f-1a35-4a2b-b62a-12e15e33b07b" ParentLink="ComplexStatement_Statement" LowerBound="252.1" HigherBound="256.1">
                                    <om:Property Name="Expression" Value="varXmlDoc = new System.Xml.XmlDocument();&#xD;&#xA;varXmlDoc = msgWOD;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : WorkOrder Scenario. Original Work Order Msg. &quot; ,varXmlDoc.InnerXml));" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Trace" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Construct" OID="9da7e891-0a9b-4322-b9b7-6caaf0cc54ab" ParentLink="ComplexStatement_Statement" LowerBound="256.1" HigherBound="262.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="construct_WorkOrderInternal" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Transform" OID="73fcf380-84b9-46dc-b472-339984a02824" ParentLink="ComplexStatement_Statement" LowerBound="259.1" HigherBound="261.1">
                                        <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.WODToWODInternal" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="WODToWODInternal" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessagePartRef" OID="02e6c1e0-dc15-4ce5-9bdb-e24e0c50d95f" ParentLink="Transform_OutputMessagePartRef" LowerBound="260.48" HigherBound="260.62">
                                            <om:Property Name="MessageRef" Value="msgWODInternal" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_12" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessagePartRef" OID="da1a711c-3d0a-42a1-9d0d-aa12e00630b5" ParentLink="Transform_InputMessagePartRef" LowerBound="260.126" HigherBound="260.132">
                                            <om:Property Name="MessageRef" Value="msgWOD" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_11" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="899c56a7-58f5-4499-a8c6-adce8b13f80c" ParentLink="Construct_MessageRef" LowerBound="257.43" HigherBound="257.57">
                                        <om:Property Name="Ref" Value="msgWODInternal" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="a5e964dd-11ed-4257-b1e3-606d76295bf0" ParentLink="ComplexStatement_Statement" LowerBound="262.1" HigherBound="266.1">
                                    <om:Property Name="Expression" Value="varXmlDoc = new System.Xml.XmlDocument();&#xD;&#xA;varXmlDoc = msgWODInternal;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : WorkOrder Scenario. Mapped Work Order Message Internal. &quot; ,varXmlDoc.InnerXml));" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Trace" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="VariableAssignment" OID="9a4c0d6c-81d5-4f6c-af29-621c75d3a3cd" ParentLink="ComplexStatement_Statement" LowerBound="266.1" HigherBound="271.1">
                                    <om:Property Name="Expression" Value="varWODDetailCount = xpath(msgWODInternal,&quot;count(/*[local-name()='workOrderInternal' and namespace-uri()='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrderInternal']/*[local-name()='workOrder' and namespace-uri()='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrderInternalDetail'])&quot;);&#xD;&#xA;varCounterString = &quot;1&quot;;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : WorkOrder Scenario. Line item count : {1} &quot; ,varToken,varWODDetailCount.ToString()));" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CountWorkOrderDetail" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="While" OID="097e00b2-161b-401b-b3d1-153d63296aaf" ParentLink="ComplexStatement_Statement" LowerBound="271.1" HigherBound="368.1">
                                    <om:Property Name="Expression" Value="varCounter &lt;= varWODDetailCount" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Loop_WorkOrderDetail" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Construct" OID="1546a7b5-8554-41a7-af81-8bad22bebe2c" ParentLink="ComplexStatement_Statement" LowerBound="274.1" HigherBound="280.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="construct_SingleWOD" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="49780c38-5cf6-41d6-a5c7-60d63dc03b8e" ParentLink="ComplexStatement_Statement" LowerBound="277.1" HigherBound="279.1">
                                            <om:Property Name="Expression" Value="msgWODInternalDetail = xpath(msgWODInternal,&quot;/*[local-name()='workOrderInternal' and namespace-uri()='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrderInternal']/*[local-name()='workOrder' and namespace-uri()='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrderInternalDetail'][&quot; + varCounterString + &quot;]&quot;);" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="AssignSingleWODMsg" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="08103869-2f41-4875-88cf-22d0118eed0b" ParentLink="Construct_MessageRef" LowerBound="275.47" HigherBound="275.67">
                                            <om:Property Name="Ref" Value="msgWODInternalDetail" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Construct" OID="274b8a98-b4cc-45c3-ac9d-b4134902a146" ParentLink="ComplexStatement_Statement" LowerBound="280.1" HigherBound="286.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="construct_SAP_WOD" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Transform" OID="3d5536aa-0935-49ae-8fdb-74d506095352" ParentLink="ComplexStatement_Statement" LowerBound="283.1" HigherBound="285.1">
                                            <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.WODToMBGMCR03" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="WODToMBGMCR03" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="MessagePartRef" OID="c35a8a71-eccb-4e27-8dfc-b9201769ca3b" ParentLink="Transform_OutputMessagePartRef" LowerBound="284.52" HigherBound="284.63">
                                                <om:Property Name="MessageRef" Value="msgMBGMCR03" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_2" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="fd73af33-a337-4004-bdbe-328565118dfc" ParentLink="Transform_InputMessagePartRef" LowerBound="284.124" HigherBound="284.144">
                                                <om:Property Name="MessageRef" Value="msgWODInternalDetail" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_1" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="cea57c46-208c-4d18-bd60-f79600ba50f4" ParentLink="Construct_MessageRef" LowerBound="281.47" HigherBound="281.58">
                                            <om:Property Name="Ref" Value="msgMBGMCR03" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Construct" OID="26bdfb05-873a-422f-96be-e151b1602908" ParentLink="ComplexStatement_Statement" LowerBound="286.1" HigherBound="304.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="construct_SAPMsg" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="9aeb3f34-b7f9-4ca0-98dd-74644925cd10" ParentLink="ComplexStatement_Statement" LowerBound="289.1" HigherBound="303.1">
                                            <om:Property Name="Expression" Value="&#xD;&#xA;msgSAP = msgMBGMCR03;&#xD;&#xA;&#xD;&#xA;msgSAP(WCF.Action)=&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/MBGMCR03//740/Send&quot;;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;varArchiveFileName = &quot;MBGMCR03_WOD_&quot; + varToken.ToString()+&quot;_&quot;+varCounter.ToString();&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="assignment_WOD" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="41b73842-6430-42dd-bb30-3dfbc811cecf" ParentLink="Construct_MessageRef" LowerBound="287.47" HigherBound="287.53">
                                            <om:Property Name="Ref" Value="msgSAP" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Construct" OID="164b6213-0e03-4d66-8b41-e9b77df1324d" ParentLink="ComplexStatement_Statement" LowerBound="304.1" HigherBound="311.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="ConstructMessage_Archive" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="0faed5fe-e97b-4454-8ba3-985af93e17ee" ParentLink="ComplexStatement_Statement" LowerBound="307.1" HigherBound="310.1">
                                            <om:Property Name="Expression" Value="msgArchiveIn = msgSAP;&#xD;&#xA;msgArchiveIn(FILE.ReceivedFileName) = varArchiveFileName;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="MessageAssignment_InArchive" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="62cead4b-51ba-4ad3-bc4c-a1be99636487" ParentLink="Construct_MessageRef" LowerBound="305.47" HigherBound="305.59">
                                            <om:Property Name="Ref" Value="msgArchiveIn" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="cafa5681-f339-4ac8-9a6d-b7889f1801ea" ParentLink="ComplexStatement_Statement" LowerBound="311.1" HigherBound="313.1">
                                        <om:Property Name="PortName" Value="port_SendToSAPArchive" />
                                        <om:Property Name="MessageName" Value="msgArchiveIn" />
                                        <om:Property Name="OperationName" Value="Archive" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Send_Archive" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="While" OID="844759eb-5cc3-4655-b679-d67c45a5b1a7" ParentLink="ComplexStatement_Statement" LowerBound="313.1" HigherBound="361.1">
                                        <om:Property Name="Expression" Value="varRetryCount &lt;= varRetryLimit" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="loop_Retry" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="VariableAssignment" OID="2527eed4-948d-427e-9249-7095a9f0811d" ParentLink="ComplexStatement_Statement" LowerBound="316.1" HigherBound="319.1">
                                            <om:Property Name="Expression" Value="varMsgSAPCombined = varMsgSAPCombined + &quot;###&quot; + msgSAP.OuterXml;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : WorkOrder Scenario. Inside Send To SAP Retry Loop. &quot; ,varToken));" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Trace" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Scope" OID="5c51b8b7-ab8e-4e94-9d1d-cd3fc439c3b1" ParentLink="ComplexStatement_Statement" LowerBound="319.1" HigherBound="340.1">
                                            <om:Property Name="InitializedTransactionType" Value="True" />
                                            <om:Property Name="IsSynchronized" Value="False" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="scope_SendToSAP" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Send" OID="536d86ad-6a54-49a3-af43-df7ecad87963" ParentLink="ComplexStatement_Statement" LowerBound="324.1" HigherBound="326.1">
                                                <om:Property Name="PortName" Value="port_SendToSAP" />
                                                <om:Property Name="MessageName" Value="msgSAP" />
                                                <om:Property Name="OperationName" Value="operation_SendToSAP" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="send_SAP" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Catch" OID="a8c7e1e1-0527-4ead-95ed-6f385bc396e2" ParentLink="Scope_Catch" LowerBound="329.1" HigherBound="338.1">
                                                <om:Property Name="ExceptionName" Value="DelExc" />
                                                <om:Property Name="ExceptionType" Value="Microsoft.XLANGs.BaseTypes.DeliveryFailureException" />
                                                <om:Property Name="IsFaultMessage" Value="False" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="catch_DeliveryExc" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="VariableAssignment" OID="c74a95d5-e088-4798-9184-3894dca199ae" ParentLink="Catch_Statement" LowerBound="332.1" HigherBound="337.1">
                                                    <om:Property Name="Expression" Value="varIsException = true;&#xD;&#xA;varExpObj = new System.Exception(&quot;Delivery Failure Exception&quot;, DelExc);&#xD;&#xA;varDelExcp = DelExc.ToString();&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} :Error in Transmitting the message.{1}; Delivery Exception To SAP has occured :&quot;, varToken, varDelExcp));" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="exp_DelExc" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Decision" OID="6873db88-e743-420b-a0ff-de76144e5dc8" ParentLink="ComplexStatement_Statement" LowerBound="340.1" HigherBound="360.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="decide_Retry" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="DecisionBranch" OID="c8f878fa-e60a-408a-b045-e27dcf2ffc9b" ParentLink="ReallyComplexStatement_Branch" LowerBound="341.41" HigherBound="346.1">
                                                <om:Property Name="Expression" Value="varRetryCount &gt;= varRetryLimit &amp;&amp; varIsException == true" />
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="rule_RetryTrue" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="Throw" OID="ea71d5d1-efdd-42bc-90fc-352e8dd9dde2" ParentLink="ComplexStatement_Statement" LowerBound="343.1" HigherBound="345.1">
                                                    <om:Property Name="ThrownReference" Value="varExpObj" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="throwException_MsgType" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="DecisionBranch" OID="123769ed-11a2-40a8-a4c9-50e6cc0acaf0" ParentLink="ReallyComplexStatement_Branch" LowerBound="346.46" HigherBound="352.1">
                                                <om:Property Name="Expression" Value="varIsException == false" />
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="rule_RetryFalse" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="VariableAssignment" OID="d9325f53-818f-42eb-91ae-cea48dfd9f4e" ParentLink="ComplexStatement_Statement" LowerBound="348.1" HigherBound="351.1">
                                                    <om:Property Name="Expression" Value="varRetryCount = varRetryLimit + 1;&#xD;&#xA;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="exp_NoRetry" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="DecisionBranch" OID="07056bac-c131-4eab-bf33-17955eafd511" ParentLink="ReallyComplexStatement_Branch">
                                                <om:Property Name="IsGhostBranch" Value="True" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Delay" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="VariableAssignment" OID="f0501ac8-0c13-421d-8212-d5a1cc16647f" ParentLink="ComplexStatement_Statement" LowerBound="354.1" HigherBound="357.1">
                                                    <om:Property Name="Expression" Value="varRetryCount = varRetryCount +1;&#xD;&#xA;varIsException = false;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="exp_Delay" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                                <om:Element Type="Delay" OID="c505d8c7-8bcb-424a-8421-02461acce9e5" ParentLink="ComplexStatement_Statement" LowerBound="357.1" HigherBound="359.1">
                                                    <om:Property Name="Timeout" Value="new System.TimeSpan(0,varRetryInterval,0);" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="delay_Retry" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="04967747-3ba5-4f78-9fdb-055263bf7b16" ParentLink="ComplexStatement_Statement" LowerBound="361.1" HigherBound="367.1">
                                        <om:Property Name="Expression" Value="//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : WorkOrder Scenario. Exited Retry Loop.Reset Counters &quot; ,varToken));&#xD;&#xA;varRetryCount = 1;&#xD;&#xA;varIsException = false;&#xD;&#xA;varCounter = varCounter + 1;&#xD;&#xA;varCounterString = varCounter.ToString();" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="IncrementCounter" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="6a61ce1d-febc-4638-92fe-f0a46a19c682" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Decision" OID="38b80386-009d-4da3-82d2-22d70a752152" ParentLink="ComplexStatement_Statement" LowerBound="371.1" HigherBound="508.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="decide_MAPExecution" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="aee4f10f-ed50-45dc-9bf9-30dbeeaa0779" ParentLink="ReallyComplexStatement_Branch" LowerBound="372.33" HigherBound="404.1">
                                        <om:Property Name="Expression" Value="varMBGMCR03_ST == true" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="rule_ST" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Construct" OID="617509d0-3294-4a67-99a4-f67bf670232b" ParentLink="ComplexStatement_Statement" LowerBound="374.1" HigherBound="384.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_ST" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="f355de3f-8ffe-4485-82d3-fe755d097ccc" ParentLink="ComplexStatement_Statement" LowerBound="377.1" HigherBound="383.1">
                                                <om:Property Name="Expression" Value="msgST = msgInXML;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} :ST Message Constructed &quot;  ,varToken));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="assignment_ST" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="1aefa241-3ab6-408b-9867-a9c938b6f79e" ParentLink="Construct_MessageRef" LowerBound="375.47" HigherBound="375.52">
                                                <om:Property Name="Ref" Value="msgST" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="240b0e76-af7e-4d6a-a3ab-734bd971e73c" ParentLink="ComplexStatement_Statement" LowerBound="384.1" HigherBound="390.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_SAP_ST" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Transform" OID="76b928da-53d9-4002-87e0-8794996375ff" ParentLink="ComplexStatement_Statement" LowerBound="387.1" HigherBound="389.1">
                                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.STToMBGMCR03" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="STToMBGMCR03" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessagePartRef" OID="00e737d5-5a42-488e-888d-fabf128151bd" ParentLink="Transform_OutputMessagePartRef" LowerBound="388.52" HigherBound="388.63">
                                                    <om:Property Name="MessageRef" Value="msgMBGMCR03" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_4" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="d872a8d7-7a02-4e31-bfd2-df4d80956ee6" ParentLink="Transform_InputMessagePartRef" LowerBound="388.123" HigherBound="388.128">
                                                    <om:Property Name="MessageRef" Value="msgST" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_3" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="ede60cfc-031c-4695-bc9a-b8e88f39647d" ParentLink="Construct_MessageRef" LowerBound="385.47" HigherBound="385.58">
                                                <om:Property Name="Ref" Value="msgMBGMCR03" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="1edb0161-5c73-4203-a8cd-40fc76e71ce1" ParentLink="ComplexStatement_Statement" LowerBound="390.1" HigherBound="403.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_SAPMsg" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="e3940a2e-2c97-42b4-ab9b-3ca765e7847e" ParentLink="ComplexStatement_Statement" LowerBound="393.1" HigherBound="402.1">
                                                <om:Property Name="Expression" Value="&#xD;&#xA;msgSAP = msgMBGMCR03;&#xD;&#xA;&#xD;&#xA;msgSAP(WCF.Action)=&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/MBGMCR03//740/Send&quot;;&#xD;&#xA;&#xD;&#xA;varArchiveFileName = &quot;MBGMCR03_ST_&quot; + varToken.ToString();&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="assignment_ST" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="6fff7bbd-8507-42f9-961d-03d067de8d6f" ParentLink="Construct_MessageRef" LowerBound="391.47" HigherBound="391.53">
                                                <om:Property Name="Ref" Value="msgSAP" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="897e44f3-dc1e-4254-8b0d-28cdb08adb41" ParentLink="ReallyComplexStatement_Branch" LowerBound="404.38" HigherBound="434.1">
                                        <om:Property Name="Expression" Value="varPREQCR03_PO == true" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="rule_PO" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Construct" OID="6dae5e3c-e9f5-45a1-9386-ea2b3abc4222" ParentLink="ComplexStatement_Statement" LowerBound="406.1" HigherBound="415.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_PO" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="37e78e48-28e6-4565-bd10-9b2eded32e9c" ParentLink="ComplexStatement_Statement" LowerBound="409.1" HigherBound="414.1">
                                                <om:Property Name="Expression" Value="msgPO = msgInXML;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} :PO Message Constructed &quot;  ,varToken));&#xD;&#xA;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="assignment_PO" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="20175eca-5e2c-49fc-bd8a-d7bd4849b87a" ParentLink="Construct_MessageRef" LowerBound="407.47" HigherBound="407.52">
                                                <om:Property Name="Ref" Value="msgPO" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="d3df5e6c-b3d2-4058-b1c5-9ecb7d5992be" ParentLink="ComplexStatement_Statement" LowerBound="415.1" HigherBound="421.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_SAP_PO" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Transform" OID="15cc5dea-851b-41b5-af60-42407914ebc3" ParentLink="ComplexStatement_Statement" LowerBound="418.1" HigherBound="420.1">
                                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.POToPREQCR03" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="POToPREQCR03" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="MessagePartRef" OID="7ab61d00-3ba0-4ccb-8862-a40c4d3dc167" ParentLink="Transform_OutputMessagePartRef" LowerBound="419.52" HigherBound="419.63">
                                                    <om:Property Name="MessageRef" Value="msgPREQCR03" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_6" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="87fdfc4f-0889-4814-97f5-34f861761786" ParentLink="Transform_InputMessagePartRef" LowerBound="419.123" HigherBound="419.128">
                                                    <om:Property Name="MessageRef" Value="msgPO" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_5" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="4a0f9325-ed0f-4146-9501-aa751f73545e" ParentLink="Construct_MessageRef" LowerBound="416.47" HigherBound="416.58">
                                                <om:Property Name="Ref" Value="msgPREQCR03" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="88672fc6-9051-4931-9b25-a53b9dcee4af" ParentLink="ComplexStatement_Statement" LowerBound="421.1" HigherBound="433.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_SAPMsg" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="e4136b66-6339-48e2-84fc-072951efecd6" ParentLink="ComplexStatement_Statement" LowerBound="424.1" HigherBound="432.1">
                                                <om:Property Name="Expression" Value="&#xD;&#xA;msgSAP = msgPREQCR03;&#xD;&#xA;&#xD;&#xA;msgSAP(WCF.Action)=&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/PREQCR03//740/Send&quot;;&#xD;&#xA;varArchiveFileName = &quot;PREQCR03_&quot; + varToken.ToString();&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="assignment_PO" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="aaa6db82-1eda-427b-9e89-915ea976c7cb" ParentLink="Construct_MessageRef" LowerBound="422.47" HigherBound="422.53">
                                                <om:Property Name="Ref" Value="msgSAP" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="5bcfe8ca-731f-4a2d-a4fb-374ae3077758" ParentLink="ReallyComplexStatement_Branch" LowerBound="434.38" HigherBound="466.1">
                                        <om:Property Name="Expression" Value="varPORDCR05_PUR == true" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="rule_PUR" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Construct" OID="97ef6189-52f8-4f20-a677-017fad7b3f8d" ParentLink="ComplexStatement_Statement" LowerBound="436.1" HigherBound="446.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_PUR" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="9113e34f-b479-4dfc-ab88-f6a0e8972a77" ParentLink="ComplexStatement_Statement" LowerBound="439.1" HigherBound="445.1">
                                                <om:Property Name="Expression" Value="msgPUR = msgInXML;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} :PUR Message Constructed &quot;  ,varToken));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="assignment_PUR" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="57e75950-8ffd-40b0-8068-6101b5d8d245" ParentLink="Construct_MessageRef" LowerBound="437.47" HigherBound="437.53">
                                                <om:Property Name="Ref" Value="msgPUR" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="b17d0fe9-70bb-4933-81ca-9dccff32da25" ParentLink="ComplexStatement_Statement" LowerBound="446.1" HigherBound="452.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_SAP_PUR" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Transform" OID="f5aa5d6c-333f-475d-acb7-5d60b70b6dda" ParentLink="ComplexStatement_Statement" LowerBound="449.1" HigherBound="451.1">
                                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.PURToPORDCR05" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="PURToPORDCR05" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="MessagePartRef" OID="c784a00f-e8a5-4330-a239-6aa6811c57be" ParentLink="Transform_OutputMessagePartRef" LowerBound="450.52" HigherBound="450.63">
                                                    <om:Property Name="MessageRef" Value="msgPORDCR05" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_8" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="2fc10e05-862d-4417-b826-04fdd182ea88" ParentLink="Transform_InputMessagePartRef" LowerBound="450.124" HigherBound="450.130">
                                                    <om:Property Name="MessageRef" Value="msgPUR" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_7" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="8306d479-8cf7-49af-a8e4-890aaa5cb4bf" ParentLink="Construct_MessageRef" LowerBound="447.47" HigherBound="447.58">
                                                <om:Property Name="Ref" Value="msgPORDCR05" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="8db00642-5cee-4814-8e11-033eaa3e795e" ParentLink="ComplexStatement_Statement" LowerBound="452.1" HigherBound="465.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_SAPMsg" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="84a45fce-90a3-4cd0-8bb6-4cd13ba380c2" ParentLink="ComplexStatement_Statement" LowerBound="455.1" HigherBound="464.1">
                                                <om:Property Name="Expression" Value="&#xD;&#xA;msgSAP = msgPORDCR05;&#xD;&#xA;&#xD;&#xA;msgSAP(WCF.Action)=&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/PORDCR05//740/Send&quot;;&#xD;&#xA;&#xD;&#xA;varArchiveFileName = &quot;PORDCR05_&quot; + varToken.ToString();&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="assignment_PUR" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="c5625cd7-dcba-4d0e-9629-4d883fd39356" ParentLink="Construct_MessageRef" LowerBound="453.47" HigherBound="453.53">
                                                <om:Property Name="Ref" Value="msgSAP" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="59c8206b-8c59-4341-8303-996e8bde9cc3" ParentLink="ReallyComplexStatement_Branch" LowerBound="466.38" HigherBound="499.1">
                                        <om:Property Name="Expression" Value="varZSMINVOICE_INV == true" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="rule_INV" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="Construct" OID="81d0de0f-395a-4195-a2e8-2ad1135ef9c3" ParentLink="ComplexStatement_Statement" LowerBound="468.1" HigherBound="478.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_INV" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="49bf1df0-97ad-45ff-8316-79593e6b9708" ParentLink="ComplexStatement_Statement" LowerBound="471.1" HigherBound="477.1">
                                                <om:Property Name="Expression" Value="msgINV = msgInXML;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} :PUR Message Constructed &quot;  ,varToken));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="assignment_INV" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="3506edd6-5fa4-4ca6-9d27-9f250bba1f2d" ParentLink="Construct_MessageRef" LowerBound="469.47" HigherBound="469.53">
                                                <om:Property Name="Ref" Value="msgINV" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="b60e8761-39fb-4960-bcec-acf25b45dab5" ParentLink="ComplexStatement_Statement" LowerBound="478.1" HigherBound="484.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_SAP_DEBITMEMO" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Transform" OID="852006cc-3fbe-467f-a2ab-5cb59b297144" ParentLink="ComplexStatement_Statement" LowerBound="481.1" HigherBound="483.1">
                                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.INVToDEBITMEMO" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="INVToZSMDEBITMEMO" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessagePartRef" OID="0f075482-df74-4339-8fbe-dc23709b7440" ParentLink="Transform_OutputMessagePartRef" LowerBound="482.52" HigherBound="482.67">
                                                    <om:Property Name="MessageRef" Value="msgZSMDEBITMEMO" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_10" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="544459af-1d1c-4126-ac6b-4910898769a6" ParentLink="Transform_InputMessagePartRef" LowerBound="482.129" HigherBound="482.135">
                                                    <om:Property Name="MessageRef" Value="msgINV" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_9" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="7cd3353b-46f8-48fa-8d13-84f35c6b2c48" ParentLink="Construct_MessageRef" LowerBound="479.47" HigherBound="479.62">
                                                <om:Property Name="Ref" Value="msgZSMDEBITMEMO" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="42860abf-9331-4632-aefa-90fc78c381df" ParentLink="ComplexStatement_Statement" LowerBound="484.1" HigherBound="498.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="construct_SAPMsg" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="654e2283-f3d4-410c-a0ee-08e18439997b" ParentLink="ComplexStatement_Statement" LowerBound="487.1" HigherBound="497.1">
                                                <om:Property Name="Expression" Value="&#xD;&#xA;msgSAP = msgZSMDEBITMEMO;&#xD;&#xA;&#xD;&#xA;msgSAP(WCF.Action)=&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_DEBIT_MEMO//740/Send&quot;;&#xD;&#xA;&#xD;&#xA;varArchiveFileName = &quot;ZSM_DEBIT_MEMO_&quot; + varToken.ToString();&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="assignment_INV" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="13b6b41c-6aa1-4982-af78-2b4f6e365ce3" ParentLink="Construct_MessageRef" LowerBound="485.47" HigherBound="485.53">
                                                <om:Property Name="Ref" Value="msgSAP" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="b33391ed-1fb1-4e14-80a7-7f58083317c5" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="else" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="VariableAssignment" OID="c554dbe6-5bd0-44a3-b18b-c41f40ead03c" ParentLink="ComplexStatement_Statement" LowerBound="501.1" HigherBound="505.1">
                                            <om:Property Name="Expression" Value="//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Messaeg Type not Found , exception will be thrown&quot;,varToken));&#xD;&#xA;varExpObj = new System.Exception(&quot;Message Type not Found , exception will be thrown&quot;);&#xD;&#xA;varArchiveFileName = &quot;Undefined&quot;;&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="exp_Trace" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Throw" OID="74df8ce0-1227-4733-9eb3-cce38f3bf796" ParentLink="ComplexStatement_Statement" LowerBound="505.1" HigherBound="507.1">
                                            <om:Property Name="ThrownReference" Value="varExpObj" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="throwException_MsgType" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Construct" OID="bb5b9401-fc00-4a66-a7bf-63e6c3a936c0" ParentLink="ComplexStatement_Statement" LowerBound="508.1" HigherBound="515.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ConstructMessage_Archive" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="7bb75486-a11d-4419-9e66-2e319187373a" ParentLink="Construct_MessageRef" LowerBound="509.43" HigherBound="509.55">
                                        <om:Property Name="Ref" Value="msgArchiveIn" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="96f14363-1edd-4460-88d2-ee18cff32bc4" ParentLink="ComplexStatement_Statement" LowerBound="511.1" HigherBound="514.1">
                                        <om:Property Name="Expression" Value="msgArchiveIn = msgSAP;&#xD;&#xA;msgArchiveIn(FILE.ReceivedFileName) = varArchiveFileName;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_InArchive" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="0372c65f-780f-4957-82d4-bdf896830b38" ParentLink="ComplexStatement_Statement" LowerBound="515.1" HigherBound="517.1">
                                    <om:Property Name="PortName" Value="port_SendToSAPArchive" />
                                    <om:Property Name="MessageName" Value="msgArchiveIn" />
                                    <om:Property Name="OperationName" Value="Archive" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Archive" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="While" OID="c868e6db-2861-4ce2-a5f0-4d4840543dd4" ParentLink="ComplexStatement_Statement" LowerBound="517.1" HigherBound="562.1">
                                    <om:Property Name="Expression" Value="varRetryCount &lt;= varRetryLimit" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="loop_Retry" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Scope" OID="22f46853-07e4-4506-9f08-1f4ca5130e2a" ParentLink="ComplexStatement_Statement" LowerBound="520.1" HigherBound="541.1">
                                        <om:Property Name="InitializedTransactionType" Value="True" />
                                        <om:Property Name="IsSynchronized" Value="False" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="scope_SendToSAP" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Send" OID="00a2c5d1-5788-4c95-9120-c5eca7d02ab9" ParentLink="ComplexStatement_Statement" LowerBound="525.1" HigherBound="527.1">
                                            <om:Property Name="PortName" Value="port_SendToSAP" />
                                            <om:Property Name="MessageName" Value="msgSAP" />
                                            <om:Property Name="OperationName" Value="operation_SendToSAP" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="send_SAP" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Catch" OID="61377f16-d687-435b-a00c-320228b01f36" ParentLink="Scope_Catch" LowerBound="530.1" HigherBound="539.1">
                                            <om:Property Name="ExceptionName" Value="DelExc" />
                                            <om:Property Name="ExceptionType" Value="Microsoft.XLANGs.BaseTypes.DeliveryFailureException" />
                                            <om:Property Name="IsFaultMessage" Value="False" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="catch_DeliveryExc" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="3df1841e-3900-4ee8-ac58-0f787ec3f0a3" ParentLink="Catch_Statement" LowerBound="533.1" HigherBound="538.1">
                                                <om:Property Name="Expression" Value="varIsException = true;&#xD;&#xA;varExpObj = new System.Exception(&quot;Delivery Failure Exception&quot;, DelExc);&#xD;&#xA;varDelExcp = DelExc.ToString();&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} :Error in Transmitting the message.{1}; Delivery Exception To SAP has occured :&quot;, varToken, varDelExcp));" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_DelExc" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Decision" OID="8164275a-51cf-4823-bf9a-0dbc7f02d6c4" ParentLink="ComplexStatement_Statement" LowerBound="541.1" HigherBound="561.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="decide_Retry" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="DecisionBranch" OID="ccf5a78b-c228-47a9-affb-a24ce1e499a1" ParentLink="ReallyComplexStatement_Branch" LowerBound="542.37" HigherBound="547.1">
                                            <om:Property Name="Expression" Value="varRetryCount &gt;= varRetryLimit &amp;&amp; varIsException == true" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="rule_RetryTrue" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="Throw" OID="b6d6c13a-1456-488a-b5ea-61f7e9d1e961" ParentLink="ComplexStatement_Statement" LowerBound="544.1" HigherBound="546.1">
                                                <om:Property Name="ThrownReference" Value="varExpObj" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="throwException_MsgType" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="7e66b72e-de50-4346-910e-d20f89e697d5" ParentLink="ReallyComplexStatement_Branch" LowerBound="547.42" HigherBound="553.1">
                                            <om:Property Name="Expression" Value="varIsException == false" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="rule_RetryFalse" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="d2862c21-25aa-4928-899c-77862ade265e" ParentLink="ComplexStatement_Statement" LowerBound="549.1" HigherBound="552.1">
                                                <om:Property Name="Expression" Value="varRetryCount = varRetryLimit + 1;&#xD;&#xA;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_NoRetry" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="062487af-a29e-440c-a216-abadd4796228" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Delay" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="55834665-0efc-4b44-af55-e9f6978549e1" ParentLink="ComplexStatement_Statement" LowerBound="555.1" HigherBound="558.1">
                                                <om:Property Name="Expression" Value="varRetryCount = varRetryCount +1;&#xD;&#xA;varIsException = false;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_Delay" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Delay" OID="6adcf7f2-a825-457e-b7b6-72257ade1344" ParentLink="ComplexStatement_Statement" LowerBound="558.1" HigherBound="560.1">
                                                <om:Property Name="Timeout" Value="new System.TimeSpan(0,varRetryInterval,0);" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="delay_Retry" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Catch" OID="8a64e17d-0b65-4c32-afb8-d850ab31bfbb" ParentLink="Scope_Catch" LowerBound="566.1" HigherBound="640.1">
                            <om:Property Name="ExceptionName" Value="AllExcp" />
                            <om:Property Name="ExceptionType" Value="System.Exception" />
                            <om:Property Name="IsFaultMessage" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="catchException_System" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="VariableAssignment" OID="bd3dba38-7399-489a-b41b-820dc9c00073" ParentLink="Catch_Statement" LowerBound="569.1" HigherBound="572.1">
                                <om:Property Name="Expression" Value="varDelExcp = AllExcp.ToString();&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Error in SMAXToSAP Orchestration.Exception : &quot;,varToken) + varDelExcp);&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="exp_Tracing" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="Construct" OID="77dc9429-fab7-44cd-adb8-aa9c95da82cb" ParentLink="Catch_Statement" LowerBound="572.1" HigherBound="580.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="construct_FailedInterchangeMsg" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageAssignment" OID="cf4ead9b-c20b-4d5b-85e6-0254421926ae" ParentLink="ComplexStatement_Statement" LowerBound="575.1" HigherBound="579.1">
                                    <om:Property Name="Expression" Value="msgFailedInterchange = msgInXML;&#xD;&#xA;msgFailedInterchange(Visy.Middleware.SAP.ServiceMax.Schemas.ErrorDescription) = varDelExcp;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Sending Mesasage to Suspend Orchestration&quot;,varToken));" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="msgassign_OriginialMsg" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="7750f2b0-29d6-4c85-9825-d69e69816415" ParentLink="Construct_MessageRef" LowerBound="573.43" HigherBound="573.63">
                                    <om:Property Name="Ref" Value="msgFailedInterchange" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="ffe2c29e-b544-4bfb-ba9f-63db8158cf2a" ParentLink="Catch_Statement" LowerBound="580.1" HigherBound="635.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="construct_ExceptionEmail" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageAssignment" OID="3b3f2c39-0f05-426c-bbfb-fd399db08bb8" ParentLink="ComplexStatement_Statement" LowerBound="583.1" HigherBound="634.1">
                                    <om:Property Name="Expression" Value="//Build HTML Message bodystrbuilder_MsgBody = new System.Text.StringBuilder();&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;html&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;head&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/head&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;body&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;p&gt;&lt;B&gt;ServiceMax To SAP Orchestration Error&lt;/B&gt;&lt;/p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Date of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToString());&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Time of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Integration Point :&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(varIntegrationPoint);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Exception:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(varDelExcp);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Refrence Id of the incoming Message&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(varToken.ToString());&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Processing Server:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(System.Environment.MachineName);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/body&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;//Set Email Properties&#xD;&#xA;msgEmailException.msgBody = new Visy.Middleware.Components.Utilities.RawString(varStrbuilder_MsgBody.ToString());&#xD;&#xA;msgEmailException.msgBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;msgEmailException(SMTP.Subject) = &quot;ServiceMax To SAP Orchestration Failed , Server: &quot; + System.Environment.MachineName;&#xD;&#xA;msgEmailException(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Created SMTP Mail Message&quot;,varToken));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="assignment_msgExcpMail" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="f98ee22b-d6bb-465c-985d-be2000331e9d" ParentLink="Construct_MessageRef" LowerBound="581.43" HigherBound="581.60">
                                    <om:Property Name="Ref" Value="msgEmailException" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="2b4f1d74-4c9d-4df9-acd3-12e6310ad022" ParentLink="Catch_Statement" LowerBound="635.1" HigherBound="637.1">
                                <om:Property Name="PortName" Value="port_SendMail" />
                                <om:Property Name="MessageName" Value="msgEmailException" />
                                <om:Property Name="OperationName" Value="operation_SendMail" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Send_Mail" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Suspend" OID="fdfc179b-fde8-4273-9e02-e4470ffb47b8" ParentLink="Catch_Statement" LowerBound="637.1" HigherBound="639.1">
                                <om:Property Name="ErrorMessage" Value="msgFailedInterchange(Visy.Middleware.SAP.ServiceMax.Schemas.ErrorDescription);" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Suspend_1" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="70dcbc7f-3588-4e05-8e69-fd642ae2b652" ParentLink="Scope_Catch" LowerBound="645.1" HigherBound="713.1">
                        <om:Property Name="ExceptionName" Value="Exc" />
                        <om:Property Name="ExceptionType" Value="System.Exception" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="catchException_System" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="310f9ccc-2f93-4737-978f-6033d4111c8b" ParentLink="Catch_Statement" LowerBound="648.1" HigherBound="651.1">
                            <om:Property Name="Expression" Value="varDelExcp = Exc.ToString();&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Error in SMAXToSAP Orchestration.Exception : &quot;,varToken) + varDelExcp);&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="exp_Tracing" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Construct" OID="38bf5403-a8dc-49b9-a4d7-9a1eb534fcf1" ParentLink="Catch_Statement" LowerBound="651.1" HigherBound="706.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="construct_ExceptionEmail" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="0673b1ed-85c3-45a8-8a6a-e2886c7babf1" ParentLink="ComplexStatement_Statement" LowerBound="654.1" HigherBound="705.1">
                                <om:Property Name="Expression" Value="//Build HTML Message bodystrbuilder_MsgBody = new System.Text.StringBuilder();&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;html&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;head&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/head&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;body&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;p&gt;&lt;B&gt;ServiceMax To SAP Orchestration Error&lt;/B&gt;&lt;/p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Date of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToString());&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Time of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Integration Point :&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(varIntegrationPoint);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Exception:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(varDelExcp);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Refrence Id of the incoming Message&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(varToken.ToString());&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Processing Server:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(System.Environment.MachineName);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/body&gt;&quot;);&#xD;&#xA;varStrbuilder_MsgBody.AppendLine(&quot;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;//Set Email Properties&#xD;&#xA;msgEmailException.msgBody = new Visy.Middleware.Components.Utilities.RawString(varStrbuilder_MsgBody.ToString());&#xD;&#xA;msgEmailException.msgBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;msgEmailException(SMTP.Subject) = &quot;ServiceMax To SAP Orchestration Failed , Server: &quot; + System.Environment.MachineName;&#xD;&#xA;msgEmailException(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Created SMTP Mail Message&quot;,varToken));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="assignment_msgExcpMail" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="3fdf7531-aa02-41a7-ad67-cf023719fc95" ParentLink="Construct_MessageRef" LowerBound="652.35" HigherBound="652.52">
                                <om:Property Name="Ref" Value="msgEmailException" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="a6e07fd1-558c-4893-bb03-cd601d6ee76d" ParentLink="Catch_Statement" LowerBound="706.1" HigherBound="708.1">
                            <om:Property Name="PortName" Value="port_SendMail" />
                            <om:Property Name="MessageName" Value="msgEmailException" />
                            <om:Property Name="OperationName" Value="operation_SendMail" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="send_Mail" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Terminate" OID="57c7df67-3fb3-4e17-9443-b76a0fb91939" ParentLink="Catch_Statement" LowerBound="708.1" HigherBound="710.1">
                            <om:Property Name="ErrorMessage" Value="&quot;ServiceMax To SAP Orchestraion terminated due to error:&quot; + Exc.ToString();" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Terminate" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Suspend" OID="33c7cceb-b7e2-40be-8b61-2292a22d73f7" ParentLink="Catch_Statement" LowerBound="710.1" HigherBound="712.1">
                            <om:Property Name="ErrorMessage" Value="msgFailedInterchange(Visy.Middleware.SAP.ServiceMax.Schemas.ErrorDescription);" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Suspend_1" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="f992a826-5454-44b0-9938-b84342426f35" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="60.1" HigherBound="63.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Unbound" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="Transmitted" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.SMAXToSap.portType_SendToSAP" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="port_SendToSAP" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="d17dfb36-9a57-4143-bfaf-82efb54042fe" ParentLink="PortDeclaration_CLRAttribute" LowerBound="60.1" HigherBound="61.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="73ac906e-8077-4af8-bf88-c4d48ca5099f" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="63.1" HigherBound="65.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Unbound" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.SMAXToSap.portType_InXML" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="port_InXML" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="DirectBindingAttribute" OID="7a7050ab-5a31-4dea-856e-edcd53f331a5" ParentLink="PortDeclaration_CLRAttribute" LowerBound="63.1" HigherBound="64.1">
                    <om:Property Name="DirectBindingType" Value="MessageBox" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="97eba111-e78f-46cb-93aa-34b17f483651" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="65.1" HigherBound="67.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Unbound" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.SMAXToSap.portType_SendMail" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="port_SendMail" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="d1b7b120-7866-4259-90fe-eb7af04136e6" ParentLink="PortDeclaration_CLRAttribute" LowerBound="65.1" HigherBound="66.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="e20a05dc-482d-4a6f-9a4d-b882c65c8244" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="67.1" HigherBound="69.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="108" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.SMAXToSap.PortType_SAPInboundArchive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="port_SendToSAPArchive" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="14f19960-b13a-4cdc-b9d6-346e5456dcf6" ParentLink="PortDeclaration_CLRAttribute" LowerBound="67.1" HigherBound="68.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="828bf954-056f-41ed-9eee-25cbb19210b7" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="8.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="emailExceptionType" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="c3bb9dcb-e090-4344-bf31-dc6436c4c84d" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.Components.Utilities.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module Visy.Middleware.SAP.ServiceMax.Orchestrations.SMAXToSap
{
    internal messagetype emailExceptionType
    {
        body Visy.Middleware.Components.Utilities.RawString msgBody;
    };
    internal porttype portType_SendToSAP
    {
        oneway operation_SendToSAP
        {
            System.Xml.XmlDocument
        };
    };
    internal porttype portType_RecInXML
    {
        requestresponse Operation_RecinXML
        {
            System.Xml.XmlDocument, Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxSAPResponse
        };
    };
    internal porttype portType_SuspendMsg
    {
        oneway operation_SuspendMsg
        {
            System.Xml.XmlDocument
        };
    };
    internal porttype portType_InXML
    {
        requestresponse operation_InXML
        {
            System.Xml.XmlDocument, System.Xml.XmlDocument
        };
    };
    internal porttype portType_SendMail
    {
        oneway operation_SendMail
        {
            emailExceptionType
        };
    };
    public porttype PortType_SAPInboundArchive
    {
        oneway Archive
        {
            System.Xml.XmlDocument
        };
    };
    public porttype PortType_SalesForceArchive
    {
        oneway Archive
        {
            System.Xml.XmlDocument
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service SMAXToSAP
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        [Microsoft.XLANGs.BaseTypes.DeliveryNotification(Microsoft.XLANGs.BaseTypes.DeliveryNotification.NotificationLevel.Transmitted)]
        port uses portType_SendToSAP port_SendToSAP;
        [Microsoft.XLANGs.BaseTypes.DirectBinding()]
        port implements portType_InXML port_InXML;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses portType_SendMail port_SendMail;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SAPInboundArchive port_SendToSAPArchive;
        message System.Xml.XmlDocument msgFailedInterchange;
        message emailExceptionType msgEmailException;
        message System.Xml.XmlDocument msgInXML;
        message Visy.Middleware.Common.Schemas.SAP.MBGMCR03.IDocOperation_MBGMCR03_740_3_Send msgMBGMCR03;
        message Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPWorkOrder.workOrderRequest msgWOD;
        message System.Xml.XmlDocument msgResponse;
        message System.Xml.XmlDocument msgSAP;
        message Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPStockTransfer.stockTransferRequest msgST;
        message Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPPurchaseOrder.purchaseOrderRequest msgPO;
        message Visy.Middleware.Common.Schemas.SAP.PREQCR03.IDocOperation_PREQCR03_740_3_Send msgPREQCR03;
        message Visy.Middleware.Common.Schemas.SAP.PORDCR05.IDocOperation_PORDCR05_740_3_Send msgPORDCR05;
        message Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPPurchase.purchaseRequest msgPUR;
        message Visy.Middleware.Common.Schemas.SAP.ZSM_DEBIT_MEMO.IDocOperation_ZSM_DEBIT_MEMO_740_3_Send msgZSMDEBITMEMO;
        message Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPInvoice.invoiceRequest msgINV;
        message Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPWorkOrderInternal msgWODInternal;
        message Visy.Middleware.SAP.ServiceMax.Schemas.ToSAP.ServiceMaxToSAPWorkOrderInternalDetail msgWODInternalDetail;
        message System.Xml.XmlDocument msgArchiveIn;
        System.Boolean varZSMINVOICE_INV;
        System.Boolean varPORDCR05_PUR;
        System.Boolean varMBGMCR03_ST;
        System.Guid varToken;
        System.Text.StringBuilder varStrbuilder_MsgBody;
        System.Boolean varMBGMCR03_WOD;
        System.String varMsgType;
        System.Boolean varIsSoapExp;
        System.Exception varExpObj;
        System.String varStrException;
        System.Int32 varRetryLimit;
        System.Int32 varRetryInterval;
        System.Int32 varRetryCount;
        System.Xml.XmlDocument varXmlDoc;
        System.Boolean varIsException;
        System.String varID;
        System.Boolean varPREQCR03_PO;
        System.String varResponseString;
        System.String varDelExcp;
        System.String varIntegrationPoint;
        System.Int32 varWODDetailCount;
        System.String varCounterString;
        System.Int32 varCounter;
        System.String varMsgSAPCombined;
        System.String varArchiveFileName;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d09520d7-f13d-484f-b464-81ac8c76b44e")]
            activate ((BTS.MessageType == "http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrder#workOrderRequest") || (BTS.MessageType == "http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPStockTransfer#stockTransferRequest") || (BTS.MessageType == "http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPPurchaseOrder#purchaseOrderRequest") || (BTS.MessageType == "http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPPurchase#purchaseRequest") || (BTS.MessageType == "http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPInvoice#invoiceRequest"))receive (port_InXML.operation_InXML, msgInXML);
            varZSMINVOICE_INV = true;
            varPORDCR05_PUR = false;
            varMBGMCR03_ST = false;
            varStrbuilder_MsgBody = new System.Text.StringBuilder();
            varMBGMCR03_WOD = false;
            varMsgType = "";
            varIsSoapExp = false;
            varExpObj = new System.Exception();
            varStrException = "";
            varXmlDoc = new System.Xml.XmlDocument();
            varIsException = false;
            varID = "";
            varPREQCR03_PO = true;
            varResponseString = "";
            varDelExcp = "";
            varIntegrationPoint = "";
            varCounterString = "";
            varCounter = 1;
            varMsgSAPCombined = "";
            varArchiveFileName = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1ac9c9e4-8530-4ba2-b7a1-bb0a1f644de0")]
            varToken = System.Guid.NewGuid();//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceIn("SAPToServiceMax Orchestration started");
            //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Received Msg from Service Max " + msgInXML.OuterXml , varToken));
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("59ec60ef-dabc-4aea-babd-a6cf2356d4a7")]
            scope
            {
                body
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f335bc24-fd9b-4f7e-a1f5-784149f161b0")]
                    scope
                    {
                        body
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9e013409-6a01-47be-b40b-295bc8d05342")]
                            varRetryLimit = System.Convert.ToInt32(Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData("RetryLimit", "SAP.ServiceMax"));
                            varRetryInterval = System.Convert.ToInt32(Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData("RetryInterval", "SAP.ServiceMax"));
                            varRetryCount = 1;
                            
                            //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Retrieving Values from SSO Config " ,varToken));
                            
                            //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : retry Limit : " + varRetryLimit.ToString() ,varToken));
                            
                            //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : retry interval : " + varRetryInterval.ToString()  ,varToken));
                            
                            
                            
                            
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e7f4a110-da4b-4ce0-9b56-53255ed8e5b5")]
                            varMsgType = msgInXML(BTS.MessageType);
                            varMBGMCR03_WOD = false;
                            varPREQCR03_PO = false;
                            varMBGMCR03_ST = false;
                            varPORDCR05_PUR = false;
                            varZSMINVOICE_INV = false;
                            //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Checking Message Type :" + varMsgType,varToken));
                            
                            if(varMsgType.Contains("workOrder"))
                            {
                               varIntegrationPoint = "SMAX-SAP_WOD";
                               //varFlowTracker.IntegrationPoint="SMAX-SAP_WOD";
                               //varFlowTracker.CommitServiceMaxToSAPActivity();  
                               varMBGMCR03_WOD = true;
                               
                               varResponseString = System.String.Format("<ns0:workOrderResponse xmlns:ns0='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrder'> <ns1:Response xmlns:ns1='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxSAPResponse'> <Status>ACK</Status>   <ID>{0}</ID>   </ns1:Response>   </ns0:workOrderResponse>",varToken.ToString());
                            
                            
                            }
                            
                            
                            if(varMsgType.Contains("stockTransfer"))
                            {
                                varIntegrationPoint = "SMAX-SAP_ST";
                               //varFlowTracker.IntegrationPoint="SMAX-SAP_ST";
                               //varFlowTracker.CommitServiceMaxToSAPActivity();
                               varMBGMCR03_ST = true;
                               varResponseString = System.String.Format("<ns0:stockTransferResponse xmlns:ns0='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPStockTransfer'> <ns1:Response xmlns:ns1='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxSAPResponse'> <Status>ACK</Status>   <ID>{0}</ID>   </ns1:Response>   </ns0:stockTransferResponse>", varToken.ToString());
                            
                            
                            }
                            
                            if(varMsgType.Contains("purchaseOrderRequest"))
                            {
                                varIntegrationPoint = "SMAX-SAP_PO";
                                //varFlowTracker.IntegrationPoint="SMAX-SAP_PO";
                                //varFlowTracker.CommitServiceMaxToSAPActivity();
                                varPREQCR03_PO = true;
                                varResponseString = System.String.Format("<ns0:purchaseOrderResponse xmlns:ns0='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPPurchaseOrder'> <ns1:Response xmlns:ns1='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxSAPResponse'> <Status>ACK</Status>   <ID>{0}</ID>   </ns1:Response>   </ns0:purchaseOrderResponse>",varToken.ToString());
                            
                            }
                            
                            if(varMsgType.Contains("purchaseRequest"))
                            {
                                varIntegrationPoint = "SMAX-SAP_PUR";
                                //varFlowTracker.IntegrationPoint="SMAX-SAP_PUR";
                                //varFlowTracker.CommitServiceMaxToSAPActivity();
                                varPORDCR05_PUR = true;
                                varResponseString = System.String.Format("<ns0:purchaseResponse xmlns:ns0='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPPurchase'> <ns1:Response xmlns:ns1='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxSAPResponse'> <Status>ACK</Status>   <ID>{0}</ID>   </ns1:Response>   </ns0:purchaseResponse>",varToken.ToString());
                            
                            }
                            
                            if(varMsgType.Contains("invoiceRequest"))
                            {
                                varIntegrationPoint = "SMAX-SAP_INV";
                                //varFlowTracker.IntegrationPoint="SMAX-SAP_INV";
                                //varFlowTracker.CommitServiceMaxToSAPActivity();
                                varZSMINVOICE_INV = true;
                                varResponseString = System.String.Format("<ns0:invoiceResponse xmlns:ns0='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPInvoice'> <ns1:Response xmlns:ns1='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxSAPResponse'> <Status>ACK</Status>   <ID>{0}</ID>   </ns1:Response>   </ns0:invoiceResponse>", varToken.ToString());
                            
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("071b82c3-9e53-4f48-8049-5c70b12cd103")]
                            construct msgResponse
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("6dd37f2f-5b74-473b-a5a3-3db5bff3a71f")]
                                varXmlDoc = new System.Xml.XmlDocument();
                                varXmlDoc.LoadXml(varResponseString);
                                msgResponse = varXmlDoc;
                                //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Response Message Constructed " ,varToken));
                                
                                
                                
                                
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0f76e7ed-90e1-4741-b724-06f344e2955a")]
                            send (port_InXML.operation_InXML, msgResponse);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5bef580d-2081-456b-9e26-ffd467b41524")]
                            if (varMBGMCR03_WOD == true)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("9577d9ce-4617-4ad9-9eef-6c51c193f3ae")]
                                construct msgWOD
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a5a37141-0f6e-4f1c-926d-8fa1b61b97c5")]
                                    msgWOD = msgInXML;
                                    
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} :WOD Message Constructed "  ,varToken));
                                    
                                    
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("7a52f13f-1a35-4a2b-b62a-12e15e33b07b")]
                                varXmlDoc = new System.Xml.XmlDocument();
                                varXmlDoc = msgWOD;
                                //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : WorkOrder Scenario. Original Work Order Msg. " ,varXmlDoc.InnerXml));
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("9da7e891-0a9b-4322-b9b7-6caaf0cc54ab")]
                                construct msgWODInternal
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("73fcf380-84b9-46dc-b472-339984a02824")]
                                    transform (msgWODInternal) = Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.WODToWODInternal (msgWOD);
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("a5e964dd-11ed-4257-b1e3-606d76295bf0")]
                                varXmlDoc = new System.Xml.XmlDocument();
                                varXmlDoc = msgWODInternal;
                                //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : WorkOrder Scenario. Mapped Work Order Message Internal. " ,varXmlDoc.InnerXml));
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("9a4c0d6c-81d5-4f6c-af29-621c75d3a3cd")]
                                varWODDetailCount = xpath(msgWODInternal,"count(/*[local-name()='workOrderInternal' and namespace-uri()='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrderInternal']/*[local-name()='workOrder' and namespace-uri()='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrderInternalDetail'])");
                                varCounterString = "1";
                                
                                //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : WorkOrder Scenario. Line item count : {1} " ,varToken,varWODDetailCount.ToString()));
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("097e00b2-161b-401b-b3d1-153d63296aaf")]
                                while (varCounter <= varWODDetailCount)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1546a7b5-8554-41a7-af81-8bad22bebe2c")]
                                    construct msgWODInternalDetail
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("49780c38-5cf6-41d6-a5c7-60d63dc03b8e")]
                                        msgWODInternalDetail = xpath(msgWODInternal,"/*[local-name()='workOrderInternal' and namespace-uri()='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrderInternal']/*[local-name()='workOrder' and namespace-uri()='http://Visy.ServiceMax.SAP.Schemas.ServiceMaxToSAPWorkOrderInternalDetail'][" + varCounterString + "]");
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("274b8a98-b4cc-45c3-ac9d-b4134902a146")]
                                    construct msgMBGMCR03
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3d5536aa-0935-49ae-8fdb-74d506095352")]
                                        transform (msgMBGMCR03) = Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.WODToMBGMCR03 (msgWODInternalDetail);
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("26bdfb05-873a-422f-96be-e151b1602908")]
                                    construct msgSAP
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9aeb3f34-b7f9-4ca0-98dd-74644925cd10")]
                                        
                                        msgSAP = msgMBGMCR03;
                                        
                                        msgSAP(WCF.Action)="http://Microsoft.LobServices.Sap/2007/03/Idoc/3/MBGMCR03//740/Send";
                                        
                                        
                                        varArchiveFileName = "MBGMCR03_WOD_" + varToken.ToString()+"_"+varCounter.ToString();
                                        
                                        
                                        
                                        
                                        
                                        
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("164b6213-0e03-4d66-8b41-e9b77df1324d")]
                                    construct msgArchiveIn
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0faed5fe-e97b-4454-8ba3-985af93e17ee")]
                                        msgArchiveIn = msgSAP;
                                        msgArchiveIn(FILE.ReceivedFileName) = varArchiveFileName;
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("cafa5681-f339-4ac8-9a6d-b7889f1801ea")]
                                    send (port_SendToSAPArchive.Archive, msgArchiveIn);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("844759eb-5cc3-4655-b679-d67c45a5b1a7")]
                                    while (varRetryCount <= varRetryLimit)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2527eed4-948d-427e-9249-7095a9f0811d")]
                                        varMsgSAPCombined = varMsgSAPCombined + "###" + msgSAP.OuterXml;
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : WorkOrder Scenario. Inside Send To SAP Retry Loop. " ,varToken));
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("5c51b8b7-ab8e-4e94-9d1d-cd3fc439c3b1")]
                                        scope
                                        {
                                            body
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("536d86ad-6a54-49a3-af43-df7ecad87963")]
                                                send (port_SendToSAP.operation_SendToSAP, msgSAP);
                                            }
                                            exceptions
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("a8c7e1e1-0527-4ead-95ed-6f385bc396e2")]
                                                catch (Microsoft.XLANGs.BaseTypes.DeliveryFailureException DelExc)
                                                {
                                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c74a95d5-e088-4798-9184-3894dca199ae")]
                                                    varIsException = true;
                                                    varExpObj = new System.Exception("Delivery Failure Exception", DelExc);
                                                    varDelExcp = DelExc.ToString();
                                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} :Error in Transmitting the message.{1}; Delivery Exception To SAP has occured :", varToken, varDelExcp));
                                                }
                                            }
                                        }
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6873db88-e743-420b-a0ff-de76144e5dc8")]
                                        if (varRetryCount >= varRetryLimit && varIsException == true)
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ea71d5d1-efdd-42bc-90fc-352e8dd9dde2")]
                                            throw varExpObj;
                                        }
                                        else if (varIsException == false)
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d9325f53-818f-42eb-91ae-cea48dfd9f4e")]
                                            varRetryCount = varRetryLimit + 1;
                                            
                                        }
                                        else 
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("f0501ac8-0c13-421d-8212-d5a1cc16647f")]
                                            varRetryCount = varRetryCount +1;
                                            varIsException = false;
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c505d8c7-8bcb-424a-8421-02461acce9e5")]
                                            delay new System.TimeSpan(0,varRetryInterval,0);
                                        }
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("04967747-3ba5-4f78-9fdb-055263bf7b16")]
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : WorkOrder Scenario. Exited Retry Loop.Reset Counters " ,varToken));
                                    varRetryCount = 1;
                                    varIsException = false;
                                    varCounter = varCounter + 1;
                                    varCounterString = varCounter.ToString();
                                }
                            }
                            else 
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("38b80386-009d-4da3-82d2-22d70a752152")]
                                if (varMBGMCR03_ST == true)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("617509d0-3294-4a67-99a4-f67bf670232b")]
                                    construct msgST
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f355de3f-8ffe-4485-82d3-fe755d097ccc")]
                                        msgST = msgInXML;
                                        
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} :ST Message Constructed "  ,varToken));
                                        
                                        
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("240b0e76-af7e-4d6a-a3ab-734bd971e73c")]
                                    construct msgMBGMCR03
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("76b928da-53d9-4002-87e0-8794996375ff")]
                                        transform (msgMBGMCR03) = Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.STToMBGMCR03 (msgST);
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1edb0161-5c73-4203-a8cd-40fc76e71ce1")]
                                    construct msgSAP
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e3940a2e-2c97-42b4-ab9b-3ca765e7847e")]
                                        
                                        msgSAP = msgMBGMCR03;
                                        
                                        msgSAP(WCF.Action)="http://Microsoft.LobServices.Sap/2007/03/Idoc/3/MBGMCR03//740/Send";
                                        
                                        varArchiveFileName = "MBGMCR03_ST_" + varToken.ToString();
                                        
                                        
                                    }
                                }
                                else if (varPREQCR03_PO == true)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6dae5e3c-e9f5-45a1-9386-ea2b3abc4222")]
                                    construct msgPO
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("37e78e48-28e6-4565-bd10-9b2eded32e9c")]
                                        msgPO = msgInXML;
                                        
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} :PO Message Constructed "  ,varToken));
                                        
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d3df5e6c-b3d2-4058-b1c5-9ecb7d5992be")]
                                    construct msgPREQCR03
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("15cc5dea-851b-41b5-af60-42407914ebc3")]
                                        transform (msgPREQCR03) = Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.POToPREQCR03 (msgPO);
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("88672fc6-9051-4931-9b25-a53b9dcee4af")]
                                    construct msgSAP
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e4136b66-6339-48e2-84fc-072951efecd6")]
                                        
                                        msgSAP = msgPREQCR03;
                                        
                                        msgSAP(WCF.Action)="http://Microsoft.LobServices.Sap/2007/03/Idoc/3/PREQCR03//740/Send";
                                        varArchiveFileName = "PREQCR03_" + varToken.ToString();
                                        
                                        
                                    }
                                }
                                else if (varPORDCR05_PUR == true)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("97ef6189-52f8-4f20-a677-017fad7b3f8d")]
                                    construct msgPUR
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9113e34f-b479-4dfc-ab88-f6a0e8972a77")]
                                        msgPUR = msgInXML;
                                        
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} :PUR Message Constructed "  ,varToken));
                                        
                                        
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b17d0fe9-70bb-4933-81ca-9dccff32da25")]
                                    construct msgPORDCR05
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("f5aa5d6c-333f-475d-acb7-5d60b70b6dda")]
                                        transform (msgPORDCR05) = Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.PURToPORDCR05 (msgPUR);
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8db00642-5cee-4814-8e11-033eaa3e795e")]
                                    construct msgSAP
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("84a45fce-90a3-4cd0-8bb6-4cd13ba380c2")]
                                        
                                        msgSAP = msgPORDCR05;
                                        
                                        msgSAP(WCF.Action)="http://Microsoft.LobServices.Sap/2007/03/Idoc/3/PORDCR05//740/Send";
                                        
                                        varArchiveFileName = "PORDCR05_" + varToken.ToString();
                                        
                                        
                                    }
                                }
                                else if (varZSMINVOICE_INV == true)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("81d0de0f-395a-4195-a2e8-2ad1135ef9c3")]
                                    construct msgINV
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("49bf1df0-97ad-45ff-8316-79593e6b9708")]
                                        msgINV = msgInXML;
                                        
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} :PUR Message Constructed "  ,varToken));
                                        
                                        
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b60e8761-39fb-4960-bcec-acf25b45dab5")]
                                    construct msgZSMDEBITMEMO
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("852006cc-3fbe-467f-a2ab-5cb59b297144")]
                                        transform (msgZSMDEBITMEMO) = Visy.Middleware.SAP.ServiceMax.Maps.ToSAP.INVToDEBITMEMO (msgINV);
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("42860abf-9331-4632-aefa-90fc78c381df")]
                                    construct msgSAP
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("654e2283-f3d4-410c-a0ee-08e18439997b")]
                                        
                                        msgSAP = msgZSMDEBITMEMO;
                                        
                                        msgSAP(WCF.Action)="http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_DEBIT_MEMO//740/Send";
                                        
                                        varArchiveFileName = "ZSM_DEBIT_MEMO_" + varToken.ToString();
                                        
                                        
                                        
                                    }
                                }
                                else 
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c554dbe6-5bd0-44a3-b18b-c41f40ead03c")]
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Messaeg Type not Found , exception will be thrown",varToken));
                                    varExpObj = new System.Exception("Message Type not Found , exception will be thrown");
                                    varArchiveFileName = "Undefined";
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("74df8ce0-1227-4733-9eb3-cce38f3bf796")]
                                    throw varExpObj;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bb5b9401-fc00-4a66-a7bf-63e6c3a936c0")]
                                construct msgArchiveIn
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("96f14363-1edd-4460-88d2-ee18cff32bc4")]
                                    msgArchiveIn = msgSAP;
                                    msgArchiveIn(FILE.ReceivedFileName) = varArchiveFileName;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("0372c65f-780f-4957-82d4-bdf896830b38")]
                                send (port_SendToSAPArchive.Archive, msgArchiveIn);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("c868e6db-2861-4ce2-a5f0-4d4840543dd4")]
                                while (varRetryCount <= varRetryLimit)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("22f46853-07e4-4506-9f08-1f4ca5130e2a")]
                                    scope
                                    {
                                        body
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("00a2c5d1-5788-4c95-9120-c5eca7d02ab9")]
                                            send (port_SendToSAP.operation_SendToSAP, msgSAP);
                                        }
                                        exceptions
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("61377f16-d687-435b-a00c-320228b01f36")]
                                            catch (Microsoft.XLANGs.BaseTypes.DeliveryFailureException DelExc)
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("3df1841e-3900-4ee8-ac58-0f787ec3f0a3")]
                                                varIsException = true;
                                                varExpObj = new System.Exception("Delivery Failure Exception", DelExc);
                                                varDelExcp = DelExc.ToString();
                                                //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} :Error in Transmitting the message.{1}; Delivery Exception To SAP has occured :", varToken, varDelExcp));
                                            }
                                        }
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8164275a-51cf-4823-bf9a-0dbc7f02d6c4")]
                                    if (varRetryCount >= varRetryLimit && varIsException == true)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b6d6c13a-1456-488a-b5ea-61f7e9d1e961")]
                                        throw varExpObj;
                                    }
                                    else if (varIsException == false)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d2862c21-25aa-4928-899c-77862ade265e")]
                                        varRetryCount = varRetryLimit + 1;
                                        
                                    }
                                    else 
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("55834665-0efc-4b44-af55-e9f6978549e1")]
                                        varRetryCount = varRetryCount +1;
                                        varIsException = false;
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6adcf7f2-a825-457e-b7b6-72257ade1344")]
                                        delay new System.TimeSpan(0,varRetryInterval,0);
                                    }
                                }
                            }
                        }
                        exceptions
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8a64e17d-0b65-4c32-afb8-d850ab31bfbb")]
                            catch (System.Exception AllExcp)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bd3dba38-7399-489a-b41b-820dc9c00073")]
                                varDelExcp = AllExcp.ToString();
                                //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Error in SMAXToSAP Orchestration.Exception : ",varToken) + varDelExcp);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("77dc9429-fab7-44cd-adb8-aa9c95da82cb")]
                                construct msgFailedInterchange
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("cf4ead9b-c20b-4d5b-85e6-0254421926ae")]
                                    msgFailedInterchange = msgInXML;
                                    msgFailedInterchange(Visy.Middleware.SAP.ServiceMax.Schemas.ErrorDescription) = varDelExcp;
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Sending Mesasage to Suspend Orchestration",varToken));
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ffe2c29e-b544-4bfb-ba9f-63db8158cf2a")]
                                construct msgEmailException
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("3b3f2c39-0f05-426c-bbfb-fd399db08bb8")]
                                    //Build HTML Message bodystrbuilder_MsgBody = new System.Text.StringBuilder();
                                    varStrbuilder_MsgBody.AppendLine("<html>");
                                    varStrbuilder_MsgBody.AppendLine("<head>");
                                    varStrbuilder_MsgBody.AppendLine("</head>");
                                    varStrbuilder_MsgBody.AppendLine("<body>");
                                    varStrbuilder_MsgBody.AppendLine("<p><B>ServiceMax To SAP Orchestration Error</B></p>");
                                    
                                    varStrbuilder_MsgBody.AppendLine("<table>");
                                    
                                    varStrbuilder_MsgBody.AppendLine("<tr><td>Date of Error:</td><td>");
                                    varStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToString());
                                    varStrbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    
                                    varStrbuilder_MsgBody.AppendLine("<tr><td>Time of Error:</td><td>");
                                    varStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());
                                    varStrbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    
                                    varStrbuilder_MsgBody.AppendLine("<tr><td>Integration Point :</td><td>");
                                    varStrbuilder_MsgBody.AppendLine(varIntegrationPoint);
                                    varStrbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    varStrbuilder_MsgBody.AppendLine("<tr><td>Exception:</td><td>");
                                    varStrbuilder_MsgBody.AppendLine(varDelExcp);
                                    varStrbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    varStrbuilder_MsgBody.AppendLine("<tr><td>Refrence Id of the incoming Message</td><td>");
                                    varStrbuilder_MsgBody.AppendLine(varToken.ToString());
                                    varStrbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    varStrbuilder_MsgBody.AppendLine("<tr><td>Processing Server:</td><td>");
                                    varStrbuilder_MsgBody.AppendLine(System.Environment.MachineName);
                                    varStrbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    varStrbuilder_MsgBody.AppendLine("</table>");
                                    
                                    varStrbuilder_MsgBody.AppendLine("</body>");
                                    varStrbuilder_MsgBody.AppendLine("</html>");
                                    
                                    //Set Email Properties
                                    msgEmailException.msgBody = new Visy.Middleware.Components.Utilities.RawString(varStrbuilder_MsgBody.ToString());
                                    msgEmailException.msgBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                    msgEmailException(SMTP.Subject) = "ServiceMax To SAP Orchestration Failed , Server: " + System.Environment.MachineName;
                                    msgEmailException(SMTP.EmailBodyFileCharset) = "UTF-8";
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Created SMTP Mail Message",varToken));
                                    
                                    
                                    
                                    
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("2b4f1d74-4c9d-4df9-acd3-12e6310ad022")]
                                send (port_SendMail.operation_SendMail, msgEmailException);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("fdfc179b-fde8-4273-9e02-e4470ffb47b8")]
                                suspend msgFailedInterchange(Visy.Middleware.SAP.ServiceMax.Schemas.ErrorDescription);
                            }
                        }
                    }
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("70dcbc7f-3588-4e05-8e69-fd642ae2b652")]
                    catch (System.Exception Exc)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("310f9ccc-2f93-4737-978f-6033d4111c8b")]
                        varDelExcp = Exc.ToString();
                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Error in SMAXToSAP Orchestration.Exception : ",varToken) + varDelExcp);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("38bf5403-a8dc-49b9-a4d7-9a1eb534fcf1")]
                        construct msgEmailException
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0673b1ed-85c3-45a8-8a6a-e2886c7babf1")]
                            //Build HTML Message bodystrbuilder_MsgBody = new System.Text.StringBuilder();
                            varStrbuilder_MsgBody.AppendLine("<html>");
                            varStrbuilder_MsgBody.AppendLine("<head>");
                            varStrbuilder_MsgBody.AppendLine("</head>");
                            varStrbuilder_MsgBody.AppendLine("<body>");
                            varStrbuilder_MsgBody.AppendLine("<p><B>ServiceMax To SAP Orchestration Error</B></p>");
                            
                            varStrbuilder_MsgBody.AppendLine("<table>");
                            
                            varStrbuilder_MsgBody.AppendLine("<tr><td>Date of Error:</td><td>");
                            varStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToString());
                            varStrbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            
                            varStrbuilder_MsgBody.AppendLine("<tr><td>Time of Error:</td><td>");
                            varStrbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());
                            varStrbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            
                            varStrbuilder_MsgBody.AppendLine("<tr><td>Integration Point :</td><td>");
                            varStrbuilder_MsgBody.AppendLine(varIntegrationPoint);
                            varStrbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            varStrbuilder_MsgBody.AppendLine("<tr><td>Exception:</td><td>");
                            varStrbuilder_MsgBody.AppendLine(varDelExcp);
                            varStrbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            varStrbuilder_MsgBody.AppendLine("<tr><td>Refrence Id of the incoming Message</td><td>");
                            varStrbuilder_MsgBody.AppendLine(varToken.ToString());
                            varStrbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            varStrbuilder_MsgBody.AppendLine("<tr><td>Processing Server:</td><td>");
                            varStrbuilder_MsgBody.AppendLine(System.Environment.MachineName);
                            varStrbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            varStrbuilder_MsgBody.AppendLine("</table>");
                            
                            varStrbuilder_MsgBody.AppendLine("</body>");
                            varStrbuilder_MsgBody.AppendLine("</html>");
                            
                            //Set Email Properties
                            msgEmailException.msgBody = new Visy.Middleware.Components.Utilities.RawString(varStrbuilder_MsgBody.ToString());
                            msgEmailException.msgBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                            msgEmailException(SMTP.Subject) = "ServiceMax To SAP Orchestration Failed , Server: " + System.Environment.MachineName;
                            msgEmailException(SMTP.EmailBodyFileCharset) = "UTF-8";
                            //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Created SMTP Mail Message",varToken));
                            
                            
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a6e07fd1-558c-4893-bb03-cd601d6ee76d")]
                        send (port_SendMail.operation_SendMail, msgEmailException);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("57c7df67-3fb3-4e17-9443-b76a0fb91939")]
                        terminate "ServiceMax To SAP Orchestraion terminated due to error:" + Exc.ToString();;
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("33c7cceb-b7e2-40be-8b61-2292a22d73f7")]
                        suspend msgFailedInterchange(Visy.Middleware.SAP.ServiceMax.Schemas.ErrorDescription);
                    }
                }
            }
        }
    }
}

