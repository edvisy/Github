#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="beadbc0d-18e5-49e3-8098-a167e014e16f" LowerBound="1.1" HigherBound="891.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="f98992bc-5eb0-4087-94a9-d95c9db48e54" ParentLink="Module_PortType" LowerBound="4.1" HigherBound="11.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SendUpsertReq" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="fc5efb27-4fdc-43d3-9d44-4af0804ad5b0" ParentLink="PortType_OperationDeclaration" LowerBound="6.1" HigherBound="10.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_SendUpsert" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="ed08d9e5-8a6b-4f26-bd84-5eed34d37cf0" ParentLink="OperationDeclaration_FaultMessageRef" LowerBound="8.162" HigherBound="8.209">
                    <om:Property Name="Ref" Value="BTS.soap_envelope_1__1.Fault" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="GenericSoapFault" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="20abb60c-4256-4f2f-afcd-83503a2669e2" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="8.87" HigherBound="8.160">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.ServiceMax.Schemas.SforceServiceClient.upsertResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="1fcab746-4479-4108-bc2a-614429b8839d" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="8.13" HigherBound="8.85">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.ServiceMax.Schemas.SforceServiceClient.upsertRequest" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="c997f154-d87d-41d9-a23a-235413945fad" ParentLink="Module_PortType" LowerBound="11.1" HigherBound="18.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortTypeInXmlMsg" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="060cbea1-4e89-4976-a482-2ff099d7d94b" ParentLink="PortType_OperationDeclaration" LowerBound="13.1" HigherBound="17.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_InXmlMsg" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="6aa3c540-0b51-4b89-8a05-477a58c80091" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="15.13" HigherBound="15.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="984b7652-a8b7-45e0-8884-4affcb533ffe" ParentLink="Module_PortType" LowerBound="18.1" HigherBound="25.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SendSusMsg" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="0b3f4506-2374-4f32-9ae1-1577e73fc447" ParentLink="PortType_OperationDeclaration" LowerBound="20.1" HigherBound="24.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_SendSusMsg" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="1e0b4bc4-cf79-422a-a4f2-ec88b9f75c5b" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="22.13" HigherBound="22.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="c4338e39-bdc7-4b46-80f9-ba0055cfdc45" ParentLink="Module_PortType" LowerBound="25.1" HigherBound="32.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Public" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SAPInboundArchive" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="ff9aa6cf-1545-4527-81d7-7898c34d2702" ParentLink="PortType_OperationDeclaration" LowerBound="27.1" HigherBound="31.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="e44ac8a5-f713-4378-8116-9010dc3d7664" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="29.13" HigherBound="29.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="e6859a62-07f4-42f6-bf81-6c04b2e39610" ParentLink="Module_PortType" LowerBound="32.1" HigherBound="39.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Public" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_SalesForceInboundArchive" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="431a874c-5754-4087-9836-68c1f675f002" ParentLink="PortType_OperationDeclaration" LowerBound="34.1" HigherBound="38.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="8ed27c4e-6ef5-4f5d-bd73-770ae6fe4b06" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="36.13" HigherBound="36.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="116f27f1-ccd8-4ee2-b8a3-55252b6f8449" ParentLink="Module_PortType" LowerBound="39.1" HigherBound="46.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Public" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="PortType_ArchiveResponse" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="3f21339b-7bc4-4def-b9b5-dfe0b7007072" ParentLink="PortType_OperationDeclaration" LowerBound="41.1" HigherBound="45.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Archive" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="7e7226fa-f940-4df9-a6d6-ac85c4561afb" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="43.13" HigherBound="43.86">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.ServiceMax.Schemas.SforceServiceClient.upsertResponse" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="1dfed7d0-a574-4845-9505-7da4c5f323b4" ParentLink="Module_ServiceDeclaration" LowerBound="46.1" HigherBound="890.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SAPToSMAX" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="888d9e70-27dc-4e45-a3f5-5c4f2899e208" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="79.1" HigherBound="80.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PRODS" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9e3d2ff1-edad-4022-8bab-45ae691f1456" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="80.1" HigherBound="81.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="STKLOC" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8ae3a4bc-21d5-40ca-9d83-d0a6a5d36471" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="81.1" HigherBound="82.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CREDNOTE" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c5847dc7-4f48-4987-9c35-6917dbc76687" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="82.1" HigherBound="83.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="upsertResp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8c33eb0b-70b4-4a80-8f28-9faa36d62ca3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="83.1" HigherBound="84.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="IsSoapExp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d8666685-3a6e-4a03-bfd2-cfdb380a3dd5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="84.1" HigherBound="85.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="strbuilder_MsgBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="15a7ada2-bea6-4ad2-b5be-7d9f997c435c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="85.1" HigherBound="86.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CREMAS04" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f668bd2b-146a-430b-92e5-124c2f860d12" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="86.1" HigherBound="87.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="strException" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="7d01b3db-87cc-4b94-a85f-64c2d3dc2870" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="87.1" HigherBound="88.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Guid" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="token" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f9ac1f6b-e500-403c-9f15-f534a682d38f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="88.1" HigherBound="89.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlDoc" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0bd8135c-7efe-4a50-b628-791d36803682" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="89.1" HigherBound="90.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="retryCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="90b69617-807e-41b1-9273-2966c9cc8466" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="90.1" HigherBound="91.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="isException" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3f96efe4-c5ff-4c9c-b762-a3e9c58716b8" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="91.1" HigherBound="92.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Exception" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="expObj" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f7ea136e-4a2b-435e-80af-eb1f8113bb07" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="92.1" HigherBound="93.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="errorMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="d2e2400a-66cd-4c0a-a84c-8f69ba7ceceb" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="93.1" HigherBound="94.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="retryLimit" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="954be213-1bd9-4537-9feb-8851d0fdf6a7" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="94.1" HigherBound="95.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="retryInterval" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e425e929-ea00-4ec6-a9e2-0551ea912cb5" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="95.1" HigherBound="96.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="MsgType" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="ba55c648-4b50-419c-a393-001cdb3cde1c" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="96.1" HigherBound="97.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="WBS" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="e1cfdfe4-f06f-44f4-be24-11aaf89348d1" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="97.1" HigherBound="98.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="DocNum" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c15dfbb2-5990-41db-9f8c-a5ec8507db2e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="98.1" HigherBound="99.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="resultCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="89b868df-517e-473a-aa71-e08ac21426bc" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="99.1" HigherBound="100.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="resultCounter" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="8b748912-3760-4285-8317-8e4b2b182316" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="100.1" HigherBound="101.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="resultCounterStr" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="1974d5c5-b4cb-461b-8693-c211e6976ec4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="101.1" HigherBound="102.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PRICE" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="663f90af-3073-483c-9184-3e0c786b574b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="102.1" HigherBound="103.1">
                <om:Property Name="InitialValue" Value="false" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Boolean" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ZSMPRSTATUS" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="423bcb96-398a-4d88-8e26-3b212faa2ad3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="103.1" HigherBound="104.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlDocForBAM" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="4c788ba4-282b-4d5c-9406-85ce05608701" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="104.1" HigherBound="105.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varIntegrationPoint" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2a94142b-92e6-4d15-ba5b-cbcb36979ee3" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="105.1" HigherBound="106.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="varArchiveFileName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="cf399580-d633-48c5-bc3e-6de9735ea065" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="63.1" HigherBound="64.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="inXmlMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e62c9be2-31bd-4cea-973d-c36c48604a3f" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="64.1" HigherBound="65.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.SforceServiceClient.upsertRequest" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgUpsertRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="67ea6a20-ab66-4800-bf65-dd2edb01511b" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="65.1" HigherBound="66.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.SforceServiceClient.upsertResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgUpsertResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="a59c762d-c4ef-4b1b-b6df-96bd55dc27cd" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="66.1" HigherBound="67.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.emailExceptionType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgEmailException" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="45ebf125-bb86-4123-a8c0-c0d2b29f6f70" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="67.1" HigherBound="68.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgFailedInterchange" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="d3efb661-b5ce-46ad-87de-21f550d52f9f" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="68.1" HigherBound="69.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.CREMAS04._740.IDocOperation_CREMAS04_ZCREMAS04_740_3_Receive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="VendorCREMAS04" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="d78211f3-646e-4efb-9e14-1b175bfeafdf" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="69.1" HigherBound="70.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.ZSM_WBS.IDocOperation_ZSM_WBS_740_3_Receive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="WBSzsmWBS" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="e5089b5a-47cf-4a8f-902b-39795056b2a3" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="70.1" HigherBound="71.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="xmlDocMsg" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="740074b9-c1af-4448-881a-f3419fbaab5b" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="71.1" HigherBound="72.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.ZSM_CREDNOTE.IDocOperation_ZSM_CREDNOTE_740_3_Receive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="CREDITNOTE" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="64a2a534-ca2f-48cc-a5e9-df62df76ae8f" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="72.1" HigherBound="73.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.ZSM_STKLOC.IDocOperation_ZSM_STKLOC_740_3_Receive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="STOCKLOC" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="66b7b467-0cc9-48de-ac14-1c7907bf2934" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="73.1" HigherBound="74.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.ZSM_PROD.IDocOperation_ZSM_PROD_740_3_Receive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PRODStock" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="de069289-d42b-46cd-9ce4-e929deb78e65" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="74.1" HigherBound="75.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.Schemas.ZSM_PRICE.IDocOperation_ZSM_PRICE_740_3_Receive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PartPRICE" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="77e11e69-aeed-49ef-b6fd-77758545c966" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="75.1" HigherBound="76.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.ZSM_PR_STATUS.IDocOperation_ZSM_PR_STATUS_740_3_Receive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="PRSTATUS" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="6745d4b4-c5f2-4234-8a00-e65778a8092c" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="76.1" HigherBound="77.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.ProductStockWebservice.UpdateProductStockQuantityRequest" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgProductStockRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="4a6c0d8e-0c9f-4ae4-ab5c-20c6047d2de3" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="77.1" HigherBound="78.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.ProductStockWebservice.UpdateProductStockQuantityResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgProductStockResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="c2527a64-8c7d-4fc1-b373-7e513988ec05" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="78.1" HigherBound="79.1">
                <om:Property Name="Type" Value="System.Xml.XmlDocument" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgArchive" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="729662e0-844b-4f38-b55d-b3b58e1dd6ae" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="7f7570c7-c720-41a8-b3a0-7fa6abb847aa" ParentLink="ServiceBody_Statement" LowerBound="108.1" HigherBound="131.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="Port_InXmlMsg" />
                    <om:Property Name="MessageName" Value="inXmlMsg" />
                    <om:Property Name="OperationName" Value="Operation_InXmlMsg" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="rcv_XmlMsg" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="DNFPredicate" OID="c49e5fe7-f957-4415-8f6b-138b80c0017c" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="a9561bb4-b836-4e19-a20d-3ae34fe891b5" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="b2901bbe-e2b2-4ce8-9364-d29ee337cef8" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="d3a1002e-9971-4411-afef-07c6e1c5828e" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="a861610d-2ec5-4216-92ac-bf8a4c191d11" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="61481e1c-f615-4ae2-83c4-62e38b321b65" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="1ae37117-9378-455c-a93b-17c9f71d19ba" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="8e7607f9-523a-4356-b0e6-6a82c2f9a1cf" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.Operation" />
                        <om:Property Name="RHS" Value="&quot;Operation_SendResubmitMsg&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="8b173385-2cd7-448a-8965-7561e754b97d" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="29078a0a-2806-4d92-9372-2743acb2b7b1" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.Operation" />
                        <om:Property Name="RHS" Value="&quot;Operation_SendResubmitMsg&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="d1f62f2f-e087-4a5e-a3a5-b36541226612" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="bf6f4c53-8292-4210-8884-7d2442e1ac4d" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.Operation" />
                        <om:Property Name="RHS" Value="&quot;Operation_SendResubmitMsg&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="27c53586-c3bc-493c-b90d-6f1d188f0549" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="7b1fb441-1ce3-4ba1-9a7f-e9067dbcdd02" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.Operation" />
                        <om:Property Name="RHS" Value="&quot;Operation_SendResubmitMsg&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="83f70546-f49a-4c00-8daa-1eb46195ccde" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="998f0b0f-0e2b-493e-aff9-811032992f44" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.Operation" />
                        <om:Property Name="RHS" Value="&quot;Operation_SendResubmitMsg&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="c1a83900-438d-4e40-92cf-07d8386ae8b8" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="98f4f82a-68ff-46f6-9621-826b61d8ad87" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.Operation" />
                        <om:Property Name="RHS" Value="&quot;Operation_SendResubmitMsg&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="e33d8e5d-69f8-48b6-8ce4-b263280e4b37" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="OR" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="77dde1a6-b451-4b7f-9442-96911712c7e1" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.Operation" />
                        <om:Property Name="RHS" Value="&quot;Operation_SendResubmitMsg&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="DNFPredicate" OID="e3620442-ad73-4430-9780-f6942274f7d1" ParentLink="Receive_DNFPredicate">
                        <om:Property Name="LHS" Value="BTS.MessageType" />
                        <om:Property Name="RHS" Value="&quot;http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive#Receive&quot;" />
                        <om:Property Name="Grouping" Value="AND" />
                        <om:Property Name="Operator" Value="Equals" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="VariableAssignment" OID="1cd59764-8f11-4bad-a83d-52b94b337250" ParentLink="ServiceBody_Statement" LowerBound="131.1" HigherBound="135.1">
                    <om:Property Name="Expression" Value="xmlDoc = inXmlMsg;&#xD;&#xA;token = System.Guid.NewGuid();//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceIn(&quot;SAPToServiceMax Orchestration started&quot;);&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Received Message from SAP&quot;, token));&#xD;&#xA;" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="exp_InitialiseTracing" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="VariableAssignment" OID="e1be2dff-306b-48ba-a226-0963e23a4836" ParentLink="ServiceBody_Statement" LowerBound="135.1" HigherBound="146.1">
                    <om:Property Name="Expression" Value="//flowTracker = new Visy.Middleware.SAP.ServiceMax.Components.OrchestrationESApi.SAPToServiceMax();&#xD;&#xA;//flowTracker.BeginSAPToServiceMaxActivity();&#xD;&#xA;//flowTracker.MsgReceivedTime = System.DateTime.Now.ToString();&#xD;&#xA;//flowTracker.MessageData = xmlDoc.OuterXml;&#xD;&#xA;//flowTracker.CommitSAPToServiceMaxActivity();&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : BAM Tracking has Started , Activity ID :&quot; + //flowTracker.ActivityID ,token));&#xD;&#xA;DocNum = &quot;&quot;;&#xD;&#xA;varIntegrationPoint = &quot;&quot;;&#xD;&#xA;&#xD;&#xA;" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="exp_BAMTracking" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Scope" OID="3a4ead45-00d7-4c22-a04d-8e2deea633d5" ParentLink="ServiceBody_Statement" LowerBound="146.1" HigherBound="888.1">
                    <om:Property Name="InitializedTransactionType" Value="True" />
                    <om:Property Name="IsSynchronized" Value="False" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Scope_Main" />
                    <om:Property Name="Signal" Value="False" />
                    <om:Element Type="VariableAssignment" OID="cad58c38-31ca-4cc0-8821-ed4c2cbe46e8" ParentLink="ComplexStatement_Statement" LowerBound="151.1" HigherBound="165.1">
                        <om:Property Name="Expression" Value="retryLimit = System.Convert.ToInt32(Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData(&quot;RetryLimit&quot;, &quot;SAP.ServiceMax&quot;));&#xD;&#xA;retryInterval = System.Convert.ToInt32(Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData(&quot;RetryInterval&quot;, &quot;SAP.ServiceMax&quot;));&#xD;&#xA;retryCount = 1;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Login Orchestration Started &quot; ,token));&#xD;&#xA;&#xD;&#xA;CREMAS04 = false;&#xD;&#xA;WBS = false;&#xD;&#xA;CREDNOTE = false;&#xD;&#xA;STKLOC = false;&#xD;&#xA;PRODS = false;&#xD;&#xA;PRICE = false;&#xD;&#xA;ZSMPRSTATUS = false;" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Exp_SetRetryCount" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Scope" OID="d96bd61b-dec8-411b-ae43-cfdf7855abea" ParentLink="ComplexStatement_Statement" LowerBound="165.1" HigherBound="819.1">
                        <om:Property Name="InitializedTransactionType" Value="True" />
                        <om:Property Name="IsSynchronized" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Scope_LoginAndUpsert" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="Call" OID="2164b825-399d-4d07-86be-8221f366d62a" ParentLink="ComplexStatement_Statement" LowerBound="170.1" HigherBound="172.1">
                            <om:Property Name="Identifier" Value="CallSMLoginOrch" />
                            <om:Property Name="Invokee" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.ServiceMaxLogin" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="callorch_ServiceMaxLogin" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Parameter" OID="68512968-5e94-4973-a444-f74290d0f5e5" ParentLink="InvokeStatement_Parameter">
                                <om:Property Name="Direction" Value="In" />
                                <om:Property Name="Name" Value="token" />
                                <om:Property Name="Type" Value="System.Guid" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="VariableAssignment" OID="ebedf2b4-e5f9-4b89-af2b-2741f42e180e" ParentLink="ComplexStatement_Statement" LowerBound="172.1" HigherBound="213.1">
                            <om:Property Name="Expression" Value="upsertResp = &quot;false&quot;;&#xD;&#xA;MsgType = inXmlMsg(BTS.MessageType);&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Checking Messaeg Type :&quot; + MsgType,token));&#xD;&#xA;&#xD;&#xA;if (MsgType.Contains(&quot;CREMAS04&quot;))&#xD;&#xA;{&#xD;&#xA;   CREMAS04 = true;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if (MsgType.Contains(&quot;ZSM_WBS&quot;))&#xD;&#xA;{&#xD;&#xA;   WBS = true;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if (MsgType.Contains(&quot;ZSM_CREDNOTE&quot;))&#xD;&#xA;{ &#xD;&#xA;   CREDNOTE = true;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if (MsgType.Contains(&quot;ZSM_STKLOC&quot;))&#xD;&#xA;{&#xD;&#xA;   STKLOC = true;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if (MsgType.Contains(&quot;ZSM_PROD&quot;))&#xD;&#xA;{&#xD;&#xA;   PRODS = true;   &#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if (MsgType.Contains(&quot;ZSM_PRICE&quot;))&#xD;&#xA;{&#xD;&#xA;   PRICE = true;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;if (MsgType.Contains(&quot;ZSM_PR_STATUS&quot;))&#xD;&#xA;{&#xD;&#xA;   ZSMPRSTATUS = true;&#xD;&#xA;}&#xD;&#xA;&#xD;&#xA;" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Exp_CheckMsgType" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                        <om:Element Type="Decision" OID="764d9e54-beac-470e-b64b-f9bba61eb04f" ParentLink="ComplexStatement_Statement" LowerBound="213.1" HigherBound="738.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Decide_ProductStock" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="DecisionBranch" OID="cf708637-764e-4775-ab12-6bac0f7532cc" ParentLink="ReallyComplexStatement_Branch" LowerBound="214.29" HigherBound="358.1">
                                <om:Property Name="Expression" Value="PRODS" />
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Rule_Prods" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="VariableAssignment" OID="600ac304-7adb-43f4-8287-9da30b109c78" ParentLink="ComplexStatement_Statement" LowerBound="216.1" HigherBound="226.1">
                                    <om:Property Name="Expression" Value="////flowTracker.ExternalId=xpath(inXmlMsg,&quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='ZSM_PRODS000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PROD//740']/*[local-name()='LGORT' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PROD//740'])&quot;);&#xD;&#xA;//flowTracker.IDOCDocNum= xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PROD//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;//flowTracker.IntegrationPoint=&quot;SAP-SMAX_PRODS&quot;;&#xD;&#xA;//flowTracker.ServerUrl = Visy.Middleware.SAP.ServiceMax.Components.SSOClientHelper.Read(&quot;_SapToServiceMax&quot;,&quot;ProductStockWebServiceURL&quot;);&#xD;&#xA;//flowTracker.SessionID = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId;&#xD;&#xA;//flowTracker.CommitSAPToServiceMaxActivity();&#xD;&#xA;&#xD;&#xA;DocNum = xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PROD//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;varIntegrationPoint = &quot;SAP-SMAX_PRODS&quot;;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="exp_BAMTracking" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="Construct" OID="5d8d7a37-9482-462e-9adc-e28f3b4814b0" ParentLink="ComplexStatement_Statement" LowerBound="226.1" HigherBound="234.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct_ProdStockPROD" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="139b0dd5-28f3-415c-add2-5edfe1532e04" ParentLink="Construct_MessageRef" LowerBound="227.43" HigherBound="227.52">
                                        <om:Property Name="Ref" Value="PRODStock" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="6f0491f5-01d1-4a9c-a929-c63619065b2e" ParentLink="ComplexStatement_Statement" LowerBound="229.1" HigherBound="233.1">
                                        <om:Property Name="Expression" Value="PRODStock = xmlDoc;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : PRODStock message has been constructed&quot;,token));" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MsgAssign_ProdStock" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Construct" OID="a1cab872-82f7-48e9-964e-fdc84a785f1e" ParentLink="ComplexStatement_Statement" LowerBound="234.1" HigherBound="253.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Construct_ProductStockReq" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="43e90f83-6a3f-4aef-bfb4-bdb566f6e667" ParentLink="Construct_MessageRef" LowerBound="235.43" HigherBound="235.65">
                                        <om:Property Name="Ref" Value="msgProductStockRequest" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="Transform" OID="66d358e8-3699-4bd1-a7a8-2d271a9616a5" ParentLink="ComplexStatement_Statement" LowerBound="237.1" HigherBound="239.1">
                                        <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.PROD_To_ProductStock" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Map_To_ProductStock" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="MessagePartRef" OID="6740303f-8d49-48b9-ba7d-336083dedcbc" ParentLink="Transform_InputMessagePartRef" LowerBound="238.143" HigherBound="238.152">
                                            <om:Property Name="MessageRef" Value="PRODStock" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_5" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessagePartRef" OID="c593e0e2-a531-4167-bbd3-5c49c5432ea1" ParentLink="Transform_OutputMessagePartRef" LowerBound="238.48" HigherBound="238.81">
                                            <om:Property Name="MessageRef" Value="msgProductStockRequest" />
                                            <om:Property Name="PartRef" Value="parameters" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="MessagePartReference_6" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="87d975a0-c2d3-4cd1-ad83-21a764596014" ParentLink="ComplexStatement_Statement" LowerBound="239.1" HigherBound="252.1">
                                        <om:Property Name="Expression" Value="msgProductStockRequest(WCF.SecurityMode)=&quot;Transport&quot;;&#xD;&#xA;msgProductStockRequest(WCF.TransportClientCredentialType) = &quot;None&quot;;&#xD;&#xA;msgProductStockRequest(WCF.Action)=&quot;&quot;;&#xD;&#xA;msgProductStockRequest(WCF.OutboundCustomHeaders) = &quot;&lt;headers&gt;&lt;SessionHeader xmlns='http://soap.sforce.com/schemas/class/ProductStockWebService'&gt;&lt;sessionId&gt;&quot; + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + &quot;&lt;/sessionId&gt;&lt;/SessionHeader&gt;&lt;/headers&gt;&quot;;&#xD;&#xA;&#xD;&#xA;Port_SendProductStock(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData(&quot;ProductStockWebServiceURL&quot;, &quot;SAP.ServiceMax&quot;);&#xD;&#xA;Port_SendProductStock(Microsoft.XLANGs.BaseTypes.TransportType)=&quot;WCF-BasicHttp&quot;;&#xD;&#xA;varArchiveFileName = &quot;PRODSTOCK_&quot; + token.ToString();&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Product Stock Request message has been constructed&quot;,token));&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Session ID &quot; + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId,token));&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : ProductStockURL&quot; + Visy.Middleware.SAP.ServiceMax.Components.SSOClientHelper.Read(&quot;_SapToServiceMax&quot;,&quot;ProductStockWebServiceURL&quot;),token));&#xD;&#xA;xmlDocForBAM = msgProductStockRequest.parameters;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="Msgassign_UpsertReq" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Construct" OID="461b4cb6-40c5-49f3-a465-497dc7ea840b" ParentLink="ComplexStatement_Statement" LowerBound="253.1" HigherBound="266.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="construct_ProductStockResponse" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="cb2f3cb3-be7b-4d2e-8d3a-3a667e6dbc59" ParentLink="Construct_MessageRef" LowerBound="254.43" HigherBound="254.66">
                                        <om:Property Name="Ref" Value="msgProductStockResponse" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="4f21ed1d-2b6a-4f9d-91bb-9e2439775e53" ParentLink="ComplexStatement_Statement" LowerBound="256.1" HigherBound="265.1">
                                        <om:Property Name="Expression" Value="xmlDoc = new System.Xml.XmlDocument();&#xD;&#xA;xmlDoc.LoadXml(@&quot;&lt;ns0:UpdateProductStockQuantityResponse xmlns:ns0='http://soap.sforce.com/schemas/class/ProductStockWebService'&gt;&lt;ns0:result&gt;result_0&lt;/ns0:result&gt;&lt;/ns0:UpdateProductStockQuantityResponse&gt;&quot;);&#xD;&#xA;msgProductStockResponse.parameters=xmlDoc;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Product Stock Response message has been constructed&quot;,token));&#xD;&#xA;&#xD;&#xA;expObj = new System.Exception();&#xD;&#xA;isException = false;&#xD;&#xA;IsSoapExp = false;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="msgassign_ProductStockResponse" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="While" OID="bea5647a-8b53-479d-8a52-f8f2b1dd827c" ParentLink="ComplexStatement_Statement" LowerBound="266.1" HigherBound="357.1">
                                    <om:Property Name="Expression" Value="retryCount &lt;= retryLimit" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Loop_Retry" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Scope" OID="e2445461-1f87-4df6-ad0d-f6de4a2dd58d" ParentLink="ComplexStatement_Statement" LowerBound="269.1" HigherBound="312.1">
                                        <om:Property Name="InitializedTransactionType" Value="True" />
                                        <om:Property Name="IsSynchronized" Value="False" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="scope_ProductStock" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Construct" OID="9ba8b236-4cd5-4add-8c9d-b9ffaeff208b" ParentLink="ComplexStatement_Statement" LowerBound="274.1" HigherBound="281.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ConstructMessage_Archive" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="7bd596fd-17e7-467c-b4a7-98b5130c9e8c" ParentLink="Construct_MessageRef" LowerBound="275.55" HigherBound="275.65">
                                                <om:Property Name="Ref" Value="msgArchive" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="05428b78-ec0b-4835-a4c0-f570becd212e" ParentLink="ComplexStatement_Statement" LowerBound="277.1" HigherBound="280.1">
                                                <om:Property Name="Expression" Value="msgArchive = msgProductStockRequest.parameters;&#xD;&#xA;msgArchive(FILE.ReceivedFileName) = varArchiveFileName;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MessageAssignment_InArchive" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Send" OID="01c4dcde-f86d-4ca0-928c-7a0f29118743" ParentLink="ComplexStatement_Statement" LowerBound="281.1" HigherBound="283.1">
                                            <om:Property Name="PortName" Value="port_SalesForceInboundArchive" />
                                            <om:Property Name="MessageName" Value="msgArchive" />
                                            <om:Property Name="OperationName" Value="Archive" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_Archive" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Send" OID="cba7ca55-c247-4e2e-b4dc-5b4739e64ba0" ParentLink="ComplexStatement_Statement" LowerBound="283.1" HigherBound="285.1">
                                            <om:Property Name="PortName" Value="Port_SendProductStock" />
                                            <om:Property Name="MessageName" Value="msgProductStockRequest" />
                                            <om:Property Name="OperationName" Value="UpdateProductStockQuantity" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="send_ProductStockReq" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Receive" OID="6b6ae658-72fc-4cc9-9597-d59bf498d364" ParentLink="ComplexStatement_Statement" LowerBound="285.1" HigherBound="287.1">
                                            <om:Property Name="Activate" Value="False" />
                                            <om:Property Name="PortName" Value="Port_SendProductStock" />
                                            <om:Property Name="MessageName" Value="msgProductStockResponse" />
                                            <om:Property Name="OperationName" Value="UpdateProductStockQuantity" />
                                            <om:Property Name="OperationMessageName" Value="Response" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="rcv_ProductStockResponse" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Catch" OID="5d81beb4-e0ad-42f6-ad27-d553f9a79663" ParentLink="Scope_Catch" LowerBound="290.1" HigherBound="300.1">
                                            <om:Property Name="ExceptionName" Value="excp" />
                                            <om:Property Name="ExceptionType" Value="System.Exception" />
                                            <om:Property Name="IsFaultMessage" Value="False" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="catch_system" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="3c838f20-ffde-4f84-9e28-5e69689719ed" ParentLink="Catch_Statement" LowerBound="293.1" HigherBound="299.1">
                                                <om:Property Name="Expression" Value="expObj = new System.Exception();&#xD;&#xA;expObj = excp;&#xD;&#xA;isException = true;&#xD;&#xA;IsSoapExp = false;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} :Error in Transmitting the message.{1}; Retry count:&quot;+retryCount.ToString(), token, excp.ToString()));&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_TraceException" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Catch" OID="6b3c2477-4fdd-46c0-957a-e016735c7358" ParentLink="Scope_Catch" LowerBound="300.1" HigherBound="310.1">
                                            <om:Property Name="ExceptionName" Value="soapExc" />
                                            <om:Property Name="ExceptionType" Value="Port_SendProductStock.UpdateProductStockQuantity.GenericSoapFault" />
                                            <om:Property Name="IsFaultMessage" Value="False" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="soapExc" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="8aa7ece7-94ef-4afe-b078-6f4dbc067846" ParentLink="Catch_Statement" LowerBound="303.1" HigherBound="309.1">
                                                <om:Property Name="Expression" Value="strException = xpath(soapExc, &quot;string(/*[local-name()='Fault' and namespace-uri()='http://schemas.xmlsoap.org/soap/envelope/']/*[local-name()='faultstring' and namespace-uri()=''])&quot;);&#xD;&#xA;expObj = new System.Exception(&quot;ServiceMax returned an error message&quot; + strException);&#xD;&#xA;isException = true;&#xD;&#xA;IsSoapExp = true;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} :A SOAP exception has occured within the Product Stock call. Error Description: &quot;+ strException, token));&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_SoapExcp" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Decision" OID="134ff479-d2ba-433e-a2e5-a16a5eba9de6" ParentLink="ComplexStatement_Statement" LowerBound="312.1" HigherBound="356.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="decide_RetryCount" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="DecisionBranch" OID="01e571b2-9ae6-4914-b044-b212a8f131ef" ParentLink="ReallyComplexStatement_Branch" LowerBound="313.37" HigherBound="321.1">
                                            <om:Property Name="Expression" Value="(retryCount &gt;= retryLimit &amp;&amp; isException == true)" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="rule_RetryCountLimit" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="37c8bb94-2399-4ce1-b002-41c0ecbd60fb" ParentLink="ComplexStatement_Statement" LowerBound="315.1" HigherBound="318.1">
                                                <om:Property Name="Expression" Value="retryCount = retryLimit + 1;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : An error occurred during the Product Stock call. Exiting the loop&quot;,token));" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_ExitRetry" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Throw" OID="aff34979-48db-4490-82bc-963f2a1bf649" ParentLink="ComplexStatement_Statement" LowerBound="318.1" HigherBound="320.1">
                                                <om:Property Name="ThrownReference" Value="expObj" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="throwException" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="ac7eb985-e932-4ae3-a86b-b67799f1aca9" ParentLink="ReallyComplexStatement_Branch" LowerBound="321.42" HigherBound="339.1">
                                            <om:Property Name="Expression" Value="isException == false" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="rule_NoException" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="6fb1a6c0-a4bd-4a92-8d7e-d83e66fda6a9" ParentLink="ComplexStatement_Statement" LowerBound="323.1" HigherBound="338.1">
                                                <om:Property Name="Expression" Value="xmlDoc = new System.Xml.XmlDocument();&#xD;&#xA;xmlDoc = msgProductStockResponse.parameters;&#xD;&#xA;//flowTracker.IsError = &quot;False&quot;;&#xD;&#xA;//flowTracker.IsRetrying = &quot;False&quot;;&#xD;&#xA;//flowTracker.IsSentToServiceMax = &quot;Success&quot;;&#xD;&#xA;//flowTracker.IsEmailSent = &quot;False&quot;;&#xD;&#xA;//flowTracker.IsMessageSuspended = &quot;False&quot;;&#xD;&#xA;//flowTracker.SentToServiceMaxTime = System.DateTime.Now.ToString();&#xD;&#xA;//flowTracker.ServiceMaxRespMsg = xmlDoc.OuterXml;&#xD;&#xA;//flowTracker.CommitSAPToServiceMaxActivity();&#xD;&#xA;//flowTracker.EndSAPToServiceMaxActivity();&#xD;&#xA;retryCount = retryLimit + 1;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Product Stock Update successfully completed; Product Stock response: &quot; + xmlDoc.OuterXml.ToString(), token));&#xD;&#xA;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_BAMTracking" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="19684c24-1117-478e-8551-835cf3ad9fa2" ParentLink="ReallyComplexStatement_Branch" LowerBound="339.42" HigherBound="347.1">
                                            <om:Property Name="Expression" Value="IsSoapExp == true" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="rule_SOAPExp" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="d56bb65f-3844-41a6-9de6-ad039f58d019" ParentLink="ComplexStatement_Statement" LowerBound="341.1" HigherBound="344.1">
                                                <om:Property Name="Expression" Value="retryCount = retryLimit + 1;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : A SOAP exception occurred during the Product Stock call. Exiting the loop&quot;,token));" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_ExitRetry" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Throw" OID="3da41298-1e37-468b-b281-a20fcb1c082e" ParentLink="ComplexStatement_Statement" LowerBound="344.1" HigherBound="346.1">
                                                <om:Property Name="ThrownReference" Value="expObj" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="throwException" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="50e7a564-6109-49d5-9f76-c93196c74145" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Else" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="ea1a8320-c9e1-47b2-a4a1-743c461c56f3" ParentLink="ComplexStatement_Statement" LowerBound="349.1" HigherBound="353.1">
                                                <om:Property Name="Expression" Value="retryCount = retryCount +1;&#xD;&#xA;isException =false;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Error in transmitting the Product Stock request; Waiting to retry&quot;,token));&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_IncrementRetryCount" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Delay" OID="41f3e355-e80a-4946-8eb6-e0dd7d53da5f" ParentLink="ComplexStatement_Statement" LowerBound="353.1" HigherBound="355.1">
                                                <om:Property Name="Timeout" Value="new System.TimeSpan(0,retryInterval,0);" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="delay_RetryInterval" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="DecisionBranch" OID="ed86e56e-7c3f-4bb2-837c-06ef17f79af8" ParentLink="ReallyComplexStatement_Branch">
                                <om:Property Name="IsGhostBranch" Value="True" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Else" />
                                <om:Property Name="Signal" Value="False" />
                                <om:Element Type="Decision" OID="4cc0686e-7784-4f10-a6e5-511609442514" ParentLink="ComplexStatement_Statement" LowerBound="360.1" HigherBound="585.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Decide_MAPExecution" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="DecisionBranch" OID="512e7ec5-153c-4175-b424-4e98490ff7cb" ParentLink="ReallyComplexStatement_Branch" LowerBound="361.33" HigherBound="398.1">
                                        <om:Property Name="Expression" Value="CREMAS04" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Rule_VendorCREMAS04" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="VariableAssignment" OID="edb6d0ef-b17c-4927-ac9e-8afc153ae6c5" ParentLink="ComplexStatement_Statement" LowerBound="363.1" HigherBound="371.1">
                                            <om:Property Name="Expression" Value="//flowTracker.ExternalId=xpath(inXmlMsg,&quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='E2LFA1M002GRP' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/CREMAS04/ZCREMAS04/740']/*[local-name()='E2LFA1M002' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/CREMAS04/ZCREMAS04/740']/*[local-name()='LIFNR' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/CREMAS04/ZCREMAS04/740'])&quot;);&#xD;&#xA;//flowTracker.IDOCDocNum= xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/CREMAS04/ZCREMAS04/740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;//flowTracker.IntegrationPoint=&quot;SAP-SMAX_VEN&quot;;&#xD;&#xA;//flowTracker.CommitSAPToServiceMaxActivity();&#xD;&#xA;&#xD;&#xA;DocNum = xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/CREMAS04/ZCREMAS04/740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;varIntegrationPoint = &quot;SAP-SMAX_VEN&quot;;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="exp_BAMTracking" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Construct" OID="74eaabdf-a9b6-479b-96d0-a76d079ca746" ParentLink="ComplexStatement_Statement" LowerBound="371.1" HigherBound="379.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_VendorCREMAS04" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="ec1e758a-6b20-4af0-ad9b-f5f66074769d" ParentLink="Construct_MessageRef" LowerBound="372.47" HigherBound="372.61">
                                                <om:Property Name="Ref" Value="VendorCREMAS04" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="0f7df018-4eac-4402-af99-b6fe857c0117" ParentLink="ComplexStatement_Statement" LowerBound="374.1" HigherBound="378.1">
                                                <om:Property Name="Expression" Value="VendorCREMAS04 = xmlDoc;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : CREMAS04 message has been constructed&quot;,token));&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MsgAssign_VendorMgs" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="70d6f83f-6a7e-4ba6-b059-257a4144e037" ParentLink="ComplexStatement_Statement" LowerBound="379.1" HigherBound="397.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_UpsertReq" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="e2b7c95e-f789-47e0-b385-6f0a8a71a083" ParentLink="Construct_MessageRef" LowerBound="380.47" HigherBound="380.63">
                                                <om:Property Name="Ref" Value="msgUpsertRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Transform" OID="e9a0b720-f921-4e98-b430-6743d291017c" ParentLink="ComplexStatement_Statement" LowerBound="382.1" HigherBound="384.1">
                                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.ZCREMAS04_To_Upsert" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Map_To_Upsert" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="MessagePartRef" OID="916b4ef7-d464-44fd-8cdb-7bbcf20463fb" ParentLink="Transform_OutputMessagePartRef" LowerBound="383.52" HigherBound="383.79">
                                                    <om:Property Name="MessageRef" Value="msgUpsertRequest" />
                                                    <om:Property Name="PartRef" Value="parameters" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_4" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="aa9d4c32-1f39-4fd5-91de-f9eb76f8b0d7" ParentLink="Transform_InputMessagePartRef" LowerBound="383.140" HigherBound="383.154">
                                                    <om:Property Name="MessageRef" Value="VendorCREMAS04" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_3" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="1fe3a773-cf62-4a4a-a4c1-cb702a021100" ParentLink="ComplexStatement_Statement" LowerBound="384.1" HigherBound="396.1">
                                                <om:Property Name="Expression" Value="msgUpsertRequest(WCF.SecurityMode)=&quot;Transport&quot;;&#xD;&#xA;msgUpsertRequest(WCF.TransportClientCredentialType) = &quot;None&quot;;&#xD;&#xA;msgUpsertRequest(WCF.Action)=&quot;&quot;;&#xD;&#xA;msgUpsertRequest(WCF.OutboundCustomHeaders) = &quot;&lt;headers&gt;&lt;SessionHeader xmlns='urn:enterprise.soap.sforce.com'&gt;&lt;sessionId&gt;&quot; + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + &quot;&lt;/sessionId&gt;&lt;/SessionHeader&gt;&lt;/headers&gt;&quot;;&#xD;&#xA;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)=&quot;WCF-BasicHttp&quot;;&#xD;&#xA;&#xD;&#xA;varArchiveFileName = &quot;CREMAS04_&quot; + token.ToString();&#xD;&#xA;&#xD;&#xA;xmlDocForBAM = msgUpsertRequest.parameters;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="Msgassign_UpsertReq" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="34457c6f-ca20-4165-aa09-b28e35aaff19" ParentLink="ReallyComplexStatement_Branch" LowerBound="398.38" HigherBound="434.1">
                                        <om:Property Name="Expression" Value="WBS" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Rule_WBSzsmWBS" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="VariableAssignment" OID="ad4c20d8-f923-4eff-88e7-a413a976577f" ParentLink="ComplexStatement_Statement" LowerBound="400.1" HigherBound="408.1">
                                            <om:Property Name="Expression" Value="//flowTracker.ExternalId=xpath(inXmlMsg,&quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='ZSM_WBS_SEND000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_WBS//740']/*[local-name()='POSKI' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_WBS//740'])&quot;);&#xD;&#xA;//flowTracker.IDOCDocNum= xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_WBS//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;//flowTracker.IntegrationPoint=&quot;SAP-SMAX_WBS&quot;;&#xD;&#xA;//flowTracker.CommitSAPToServiceMaxActivity();&#xD;&#xA;&#xD;&#xA;DocNum = xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_WBS//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;varIntegrationPoint = &quot;SAP-SMAX_WBS&quot;;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="exp_BAMTracking" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Construct" OID="899f7f9b-e85b-484d-8218-4858da433fd6" ParentLink="ComplexStatement_Statement" LowerBound="408.1" HigherBound="416.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_WBSzsmWBS" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="a98acd31-cec9-4f2b-94a7-d4894c7d04a3" ParentLink="Construct_MessageRef" LowerBound="409.47" HigherBound="409.56">
                                                <om:Property Name="Ref" Value="WBSzsmWBS" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="e71d27b8-029a-4eae-8e0b-ea97fff20065" ParentLink="ComplexStatement_Statement" LowerBound="411.1" HigherBound="415.1">
                                                <om:Property Name="Expression" Value="WBSzsmWBS = xmlDoc;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : ZSM_WBS message has been constructed&quot;,token));" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MsgAssign_WBSMsg" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="0d5e9353-24e5-496c-88a1-5bb57c4f61cc" ParentLink="ComplexStatement_Statement" LowerBound="416.1" HigherBound="433.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_UpsertReq" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="dac25649-5da7-4dc8-8a19-e37e8e8c7aca" ParentLink="Construct_MessageRef" LowerBound="417.47" HigherBound="417.63">
                                                <om:Property Name="Ref" Value="msgUpsertRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Transform" OID="e8a137a3-3680-487d-92d4-2a4ca5b9d013" ParentLink="ComplexStatement_Statement" LowerBound="419.1" HigherBound="421.1">
                                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.WBS_To_Upsert" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Map_To_Upsert" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessagePartRef" OID="0393bdc9-ceda-4cd9-ae06-ba0ed9b3af8e" ParentLink="Transform_InputMessagePartRef" LowerBound="420.134" HigherBound="420.143">
                                                    <om:Property Name="MessageRef" Value="WBSzsmWBS" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_1" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="8f2c152e-2814-48b9-ba5f-a69a6eef8f72" ParentLink="Transform_OutputMessagePartRef" LowerBound="420.52" HigherBound="420.79">
                                                    <om:Property Name="MessageRef" Value="msgUpsertRequest" />
                                                    <om:Property Name="PartRef" Value="parameters" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_2" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="3df5b47e-a063-4f1a-8cc2-b8eccda886fa" ParentLink="ComplexStatement_Statement" LowerBound="421.1" HigherBound="432.1">
                                                <om:Property Name="Expression" Value="msgUpsertRequest(WCF.SecurityMode)=&quot;Transport&quot;;&#xD;&#xA;msgUpsertRequest(WCF.TransportClientCredentialType) = &quot;None&quot;;&#xD;&#xA;msgUpsertRequest(WCF.Action)=&quot;&quot;;&#xD;&#xA;msgUpsertRequest(WCF.OutboundCustomHeaders) = &quot;&lt;headers&gt;&lt;SessionHeader xmlns='urn:enterprise.soap.sforce.com'&gt;&lt;sessionId&gt;&quot; + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + &quot;&lt;/sessionId&gt;&lt;/SessionHeader&gt;&lt;/headers&gt;&quot;;&#xD;&#xA;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)=&quot;WCF-BasicHttp&quot;;&#xD;&#xA;varArchiveFileName = &quot;WBSZSM_&quot; + token.ToString();&#xD;&#xA;&#xD;&#xA;xmlDocForBAM = msgUpsertRequest.parameters;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="Msgassign_UpsertReq" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="15841305-9c8d-4643-84f0-7f875cf037e1" ParentLink="ReallyComplexStatement_Branch" LowerBound="434.38" HigherBound="469.1">
                                        <om:Property Name="Expression" Value="CREDNOTE" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Rule_CreditCREDNOTE" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="VariableAssignment" OID="3c7fddb7-4b9d-4c6e-a1cf-bb4aacbf19d8" ParentLink="ComplexStatement_Statement" LowerBound="436.1" HigherBound="444.1">
                                            <om:Property Name="Expression" Value="//flowTracker.ExternalId=xpath(inXmlMsg,&quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='ZSM_CREDNTE000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_CREDNOTE//740']/*[local-name()='CREDIT_DOCUMENTNO_C' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_CREDNOTE//740'])&quot;);&#xD;&#xA;//flowTracker.IDOCDocNum= xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_CREDNOTE//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;//flowTracker.IntegrationPoint=&quot;SAP-SMAX_CRED&quot;;&#xD;&#xA;//flowTracker.CommitSAPToServiceMaxActivity();&#xD;&#xA;&#xD;&#xA;DocNum = xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_CREDNOTE//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;varIntegrationPoint = &quot;SAP-SMAX_CRED&quot;;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="exp_BAMTracking" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Construct" OID="b586af4d-c284-4e13-b6ed-b7d18f1dc1a6" ParentLink="ComplexStatement_Statement" LowerBound="444.1" HigherBound="452.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_CreditCREDNOTE" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="fa7fa62d-2def-4340-bc12-e103bc71f66a" ParentLink="Construct_MessageRef" LowerBound="445.47" HigherBound="445.57">
                                                <om:Property Name="Ref" Value="CREDITNOTE" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="bec35f9d-c9a1-4dae-a8c3-fe2a6f077e19" ParentLink="ComplexStatement_Statement" LowerBound="447.1" HigherBound="451.1">
                                                <om:Property Name="Expression" Value="CREDITNOTE = xmlDoc;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : CREDNOTE message has been constructed&quot;,token));" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MsgAssign_CreditNote" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="669c1679-97d1-4491-9458-a0e4c725ebd4" ParentLink="ComplexStatement_Statement" LowerBound="452.1" HigherBound="468.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_UpsertReq" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Transform" OID="02838aaa-8172-4089-adf9-8aeaa647ed21" ParentLink="ComplexStatement_Statement" LowerBound="455.1" HigherBound="457.1">
                                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.CREDNOTE_To_Upsert" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Map_To_Upsert" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="MessagePartRef" OID="b4d2dec8-d7c2-4a70-ad64-614c6c409bcc" ParentLink="Transform_InputMessagePartRef" LowerBound="456.139" HigherBound="456.149">
                                                    <om:Property Name="MessageRef" Value="CREDITNOTE" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_7" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="ec77dcd5-b6a9-4981-b064-c6f03ab5494b" ParentLink="Transform_OutputMessagePartRef" LowerBound="456.52" HigherBound="456.79">
                                                    <om:Property Name="MessageRef" Value="msgUpsertRequest" />
                                                    <om:Property Name="PartRef" Value="parameters" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_8" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="e41d486c-835a-45e1-beef-1ea21745d279" ParentLink="ComplexStatement_Statement" LowerBound="457.1" HigherBound="467.1">
                                                <om:Property Name="Expression" Value="msgUpsertRequest(WCF.SecurityMode)=&quot;Transport&quot;;&#xD;&#xA;msgUpsertRequest(WCF.TransportClientCredentialType) = &quot;None&quot;;&#xD;&#xA;msgUpsertRequest(WCF.Action)=&quot;&quot;;&#xD;&#xA;msgUpsertRequest(WCF.OutboundCustomHeaders) = &quot;&lt;headers&gt;&lt;SessionHeader xmlns='urn:enterprise.soap.sforce.com'&gt;&lt;sessionId&gt;&quot; + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + &quot;&lt;/sessionId&gt;&lt;/SessionHeader&gt;&lt;/headers&gt;&quot;;&#xD;&#xA;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)=&quot;WCF-BasicHttp&quot;;&#xD;&#xA;varArchiveFileName = &quot;CREDNOTE_&quot; + token.ToString();&#xD;&#xA;xmlDocForBAM = msgUpsertRequest.parameters;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="Msgassign_UpsertReq" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="5778b879-4f90-4b5c-87ff-0556d9a4b9d9" ParentLink="Construct_MessageRef" LowerBound="453.47" HigherBound="453.63">
                                                <om:Property Name="Ref" Value="msgUpsertRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="3319eebd-f2d6-403c-b82d-e25570bdf4e7" ParentLink="ReallyComplexStatement_Branch" LowerBound="469.38" HigherBound="505.1">
                                        <om:Property Name="Expression" Value="STKLOC" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Rule_LocationSTKLOC" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="VariableAssignment" OID="1b6df213-8ff5-4bd8-9ee0-8a960abef3db" ParentLink="ComplexStatement_Statement" LowerBound="471.1" HigherBound="479.1">
                                            <om:Property Name="Expression" Value="//flowTracker.ExternalId=xpath(inXmlMsg,&quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='ZSM_STKLC000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_STKLOC//740']/*[local-name()='STORLOC' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_STKLOC//740'])&quot;);&#xD;&#xA;//flowTracker.IDOCDocNum= xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_STKLOC//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;//flowTracker.IntegrationPoint=&quot;SAP-SMAX_LOC&quot;;&#xD;&#xA;//flowTracker.CommitSAPToServiceMaxActivity();&#xD;&#xA;&#xD;&#xA;DocNum = xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_STKLOC//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;varIntegrationPoint = &quot;SAP-SMAX_LOC&quot;;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="exp_BAMTracking" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Construct" OID="f116492e-529e-480e-8e88-cf964f05a09d" ParentLink="ComplexStatement_Statement" LowerBound="479.1" HigherBound="487.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_LocationSTKLOC" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="d228ccc3-fdad-4550-8292-9ae4bde66e80" ParentLink="Construct_MessageRef" LowerBound="480.47" HigherBound="480.55">
                                                <om:Property Name="Ref" Value="STOCKLOC" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="4401d432-28a4-4af3-8412-58afb515b7a5" ParentLink="ComplexStatement_Statement" LowerBound="482.1" HigherBound="486.1">
                                                <om:Property Name="Expression" Value="STOCKLOC = xmlDoc;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : STOCKLOC message has been constructed&quot;,token));" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MsgAssign_StockLoc" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="7452865a-c021-4714-b095-801d2b48320d" ParentLink="ComplexStatement_Statement" LowerBound="487.1" HigherBound="504.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_UpsertReq" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="3b27cf15-9117-494b-baad-230b23893e3f" ParentLink="Construct_MessageRef" LowerBound="488.47" HigherBound="488.63">
                                                <om:Property Name="Ref" Value="msgUpsertRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Transform" OID="75cdf0b7-850b-434f-807d-b87868901933" ParentLink="ComplexStatement_Statement" LowerBound="490.1" HigherBound="492.1">
                                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.STKLOC_To_Upsert" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Map_To_Upsert" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="MessagePartRef" OID="946fd774-1b3c-4aa6-b489-20ba32cd3da3" ParentLink="Transform_InputMessagePartRef" LowerBound="491.137" HigherBound="491.145">
                                                    <om:Property Name="MessageRef" Value="STOCKLOC" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_9" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="86a77da5-b224-45af-aaf4-1386a502a062" ParentLink="Transform_OutputMessagePartRef" LowerBound="491.52" HigherBound="491.79">
                                                    <om:Property Name="MessageRef" Value="msgUpsertRequest" />
                                                    <om:Property Name="PartRef" Value="parameters" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_10" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="03f15f2e-e894-4a6f-9e75-8b2cd5f27665" ParentLink="ComplexStatement_Statement" LowerBound="492.1" HigherBound="503.1">
                                                <om:Property Name="Expression" Value="msgUpsertRequest(WCF.SecurityMode)=&quot;Transport&quot;;&#xD;&#xA;msgUpsertRequest(WCF.TransportClientCredentialType) = &quot;None&quot;;&#xD;&#xA;msgUpsertRequest(WCF.Action)=&quot;&quot;;&#xD;&#xA;msgUpsertRequest(WCF.OutboundCustomHeaders) = &quot;&lt;headers&gt;&lt;SessionHeader xmlns='urn:enterprise.soap.sforce.com'&gt;&lt;sessionId&gt;&quot; + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + &quot;&lt;/sessionId&gt;&lt;/SessionHeader&gt;&lt;/headers&gt;&quot;;&#xD;&#xA;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)=&quot;WCF-BasicHttp&quot;;&#xD;&#xA;varArchiveFileName = &quot;STKLOC_&quot; + token.ToString();&#xD;&#xA;&#xD;&#xA;xmlDocForBAM = msgUpsertRequest.parameters;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="Msgassign_UpsertReq" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="291f6e7e-b7cd-4711-8d8b-254ef3e072b2" ParentLink="ReallyComplexStatement_Branch" LowerBound="505.38" HigherBound="541.1">
                                        <om:Property Name="Expression" Value="PRICE" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Rule_PartPricingPRICE" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="VariableAssignment" OID="575ec468-3c08-4476-a32e-4c1496daa679" ParentLink="ComplexStatement_Statement" LowerBound="507.1" HigherBound="515.1">
                                            <om:Property Name="Expression" Value="//flowTracker.ExternalId=xpath(inXmlMsg,&quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='ZSM_PRICE_SEG000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PRICE//740']/*[local-name()='MATNR' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PRICE//740'])&quot;);&#xD;&#xA;//flowTracker.IDOCDocNum= xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PRICE//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;//flowTracker.IntegrationPoint=&quot;SAP-SMAX_PRICE&quot;;&#xD;&#xA;//flowTracker.CommitSAPToServiceMaxActivity();&#xD;&#xA;&#xD;&#xA;DocNum = xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PRICE//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;varIntegrationPoint = &quot;SAP-SMAX_PRICE&quot;;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="exp_BAMTracking" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Construct" OID="a38f7647-b290-4216-a4e5-762d7d9fc741" ParentLink="ComplexStatement_Statement" LowerBound="515.1" HigherBound="523.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_PartPricingPRICE" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="601fcdbb-6c4b-413f-9426-377a2143225a" ParentLink="Construct_MessageRef" LowerBound="516.47" HigherBound="516.56">
                                                <om:Property Name="Ref" Value="PartPRICE" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="a0bc4f99-1073-47c2-8413-fba896269c11" ParentLink="ComplexStatement_Statement" LowerBound="518.1" HigherBound="522.1">
                                                <om:Property Name="Expression" Value="PartPRICE = xmlDoc;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : PRICE message has been constructed&quot;,token));" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MsgAssign_ProdStock" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="f282c675-a39b-4691-8654-cb7ddba2abff" ParentLink="ComplexStatement_Statement" LowerBound="523.1" HigherBound="540.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_UpsertReq" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageRef" OID="002a1b17-7617-4149-8a8d-c753fd79dc18" ParentLink="Construct_MessageRef" LowerBound="524.47" HigherBound="524.63">
                                                <om:Property Name="Ref" Value="msgUpsertRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Transform" OID="73f1bad2-2f08-4af6-a897-8bf3b55d3a86" ParentLink="ComplexStatement_Statement" LowerBound="526.1" HigherBound="528.1">
                                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.PRICE_To_Upsert" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Map_To_Upsert" />
                                                <om:Property Name="Signal" Value="False" />
                                                <om:Element Type="MessagePartRef" OID="5e3af552-2666-464e-836e-aec4897efbe1" ParentLink="Transform_InputMessagePartRef" LowerBound="527.136" HigherBound="527.145">
                                                    <om:Property Name="MessageRef" Value="PartPRICE" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_13" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="5de56a52-6c7e-4f34-a158-4346505e7ef1" ParentLink="Transform_OutputMessagePartRef" LowerBound="527.52" HigherBound="527.79">
                                                    <om:Property Name="MessageRef" Value="msgUpsertRequest" />
                                                    <om:Property Name="PartRef" Value="parameters" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_14" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="dc5c1649-493b-4123-b75a-fcd75e3fcc68" ParentLink="ComplexStatement_Statement" LowerBound="528.1" HigherBound="539.1">
                                                <om:Property Name="Expression" Value="msgUpsertRequest(WCF.SecurityMode)=&quot;Transport&quot;;&#xD;&#xA;msgUpsertRequest(WCF.TransportClientCredentialType) = &quot;None&quot;;&#xD;&#xA;msgUpsertRequest(WCF.Action)=&quot;&quot;;&#xD;&#xA;msgUpsertRequest(WCF.OutboundCustomHeaders) = &quot;&lt;headers&gt;&lt;SessionHeader xmlns='urn:enterprise.soap.sforce.com'&gt;&lt;sessionId&gt;&quot; + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + &quot;&lt;/sessionId&gt;&lt;/SessionHeader&gt;&lt;/headers&gt;&quot;;&#xD;&#xA;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)=&quot;WCF-BasicHttp&quot;;&#xD;&#xA;varArchiveFileName = &quot;ZSMPRICE_&quot; + token.ToString();&#xD;&#xA;&#xD;&#xA;xmlDocForBAM = msgUpsertRequest.parameters;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="Msgassign_UpsertReq" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="c755bb03-d449-464e-a9a3-87f79837e926" ParentLink="ReallyComplexStatement_Branch" LowerBound="541.38" HigherBound="577.1">
                                        <om:Property Name="Expression" Value="ZSMPRSTATUS" />
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Rule_PRStatus" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="VariableAssignment" OID="4532509f-0b62-4438-be2b-8735b163f1c6" ParentLink="ComplexStatement_Statement" LowerBound="543.1" HigherBound="551.1">
                                            <om:Property Name="Expression" Value="//flowTracker.ExternalId=xpath(inXmlMsg,&quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='ZSM_PUR_REQ_STATUS000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PR_STATUS//740']/*[local-name()='LINE_ITEM_EXTERNAL_ID' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PR_STATUS//740'])&quot;);&#xD;&#xA;//flowTracker.IDOCDocNum= xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PR_STATUS//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;//flowTracker.IntegrationPoint=&quot;SAP-SMAX_PR&quot;;&#xD;&#xA;//flowTracker.CommitSAPToServiceMaxActivity();&#xD;&#xA;&#xD;&#xA;DocNum = xpath(inXmlMsg, &quot;string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PR_STATUS//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])&quot;);&#xD;&#xA;varIntegrationPoint  = &quot;SAP-SMAX_PR&quot;;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="exp_BAMTracking" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Construct" OID="db000ef4-246e-4beb-b348-90d63b7a8581" ParentLink="ComplexStatement_Statement" LowerBound="551.1" HigherBound="559.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_PRStatus" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="MessageAssignment" OID="3ca3df88-f9f4-461c-b438-5e3f3f5a31bf" ParentLink="ComplexStatement_Statement" LowerBound="554.1" HigherBound="558.1">
                                                <om:Property Name="Expression" Value="PRSTATUS = xmlDoc;&#xD;&#xA;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : PRSTATUS message has been constructed&quot;,token));" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="MsgAssign_PRStatus" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="79717f0d-bf34-447d-97eb-b9ee3c3ac22b" ParentLink="Construct_MessageRef" LowerBound="552.47" HigherBound="552.55">
                                                <om:Property Name="Ref" Value="PRSTATUS" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Construct" OID="c0c46b60-3190-415c-a3df-753efbc77c36" ParentLink="ComplexStatement_Statement" LowerBound="559.1" HigherBound="576.1">
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Construct_UpsertReq" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Transform" OID="80e1d002-b9b4-400b-ba55-525dd19269ac" ParentLink="ComplexStatement_Statement" LowerBound="562.1" HigherBound="564.1">
                                                <om:Property Name="ClassName" Value="Visy.Middleware.SAP.ServiceMax.Maps.PRSTATUS_To_Upsert" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Map_To_Upsert" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessagePartRef" OID="a3d84258-aecf-4b5f-8fd2-0d044cf625ef" ParentLink="Transform_OutputMessagePartRef" LowerBound="563.52" HigherBound="563.79">
                                                    <om:Property Name="MessageRef" Value="msgUpsertRequest" />
                                                    <om:Property Name="PartRef" Value="parameters" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_16" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessagePartRef" OID="25c5804c-a693-458a-95c8-cbd2f9bda9a6" ParentLink="Transform_InputMessagePartRef" LowerBound="563.139" HigherBound="563.147">
                                                    <om:Property Name="MessageRef" Value="PRSTATUS" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="MessagePartReference_15" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="MessageAssignment" OID="dc20c62a-ed5b-486e-a7c5-0c2ae547900a" ParentLink="ComplexStatement_Statement" LowerBound="564.1" HigherBound="575.1">
                                                <om:Property Name="Expression" Value="msgUpsertRequest(WCF.SecurityMode)=&quot;Transport&quot;;&#xD;&#xA;msgUpsertRequest(WCF.TransportClientCredentialType) = &quot;None&quot;;&#xD;&#xA;msgUpsertRequest(WCF.Action)=&quot;&quot;;&#xD;&#xA;msgUpsertRequest(WCF.OutboundCustomHeaders) = &quot;&lt;headers&gt;&lt;SessionHeader xmlns='urn:enterprise.soap.sforce.com'&gt;&lt;sessionId&gt;&quot; + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + &quot;&lt;/sessionId&gt;&lt;/SessionHeader&gt;&lt;/headers&gt;&quot;;&#xD;&#xA;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;&#xD;&#xA;Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)=&quot;WCF-BasicHttp&quot;;&#xD;&#xA;varArchiveFileName = &quot;ZSMPRSTATUS_&quot; + token.ToString();&#xD;&#xA;&#xD;&#xA;xmlDocForBAM = msgUpsertRequest.parameters;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="False" />
                                                <om:Property Name="Name" Value="Msgassign_UpsertReq" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="MessageRef" OID="01765f1f-c722-4218-aba9-e551ed4d9d47" ParentLink="Construct_MessageRef" LowerBound="560.47" HigherBound="560.63">
                                                <om:Property Name="Ref" Value="msgUpsertRequest" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="DecisionBranch" OID="afea3a66-2469-48d5-bdab-858c5a7b146c" ParentLink="ReallyComplexStatement_Branch">
                                        <om:Property Name="IsGhostBranch" Value="True" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Else" />
                                        <om:Property Name="Signal" Value="False" />
                                        <om:Element Type="VariableAssignment" OID="56a9444f-b224-4e66-af08-75fe359f2f6c" ParentLink="ComplexStatement_Statement" LowerBound="579.1" HigherBound="582.1">
                                            <om:Property Name="Expression" Value="//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Messaeg Type not Found , exception will be thrown&quot;,token));&#xD;&#xA;expObj = new System.Exception(&quot;Messaeg Type not Found , exception will be thrown&quot;);" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Exp_Trace" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Throw" OID="fe338f75-c0db-4889-b0fd-b46425e8d350" ParentLink="ComplexStatement_Statement" LowerBound="582.1" HigherBound="584.1">
                                            <om:Property Name="ThrownReference" Value="expObj" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="ThrowException_MsgType" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Construct" OID="e6320e99-c8ec-4529-8e76-527cc1607291" ParentLink="ComplexStatement_Statement" LowerBound="585.1" HigherBound="598.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="construct_UpsertRes" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageRef" OID="f143aa74-bc26-4bf0-8605-81d89653c446" ParentLink="Construct_MessageRef" LowerBound="586.43" HigherBound="586.60">
                                        <om:Property Name="Ref" Value="msgUpsertResponse" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageAssignment" OID="c1f8702e-67b9-4c3b-9588-eb0d0ec5737d" ParentLink="ComplexStatement_Statement" LowerBound="588.1" HigherBound="597.1">
                                        <om:Property Name="Expression" Value="xmlDoc = new System.Xml.XmlDocument();&#xD;&#xA;xmlDoc.LoadXml(@&quot;&lt;upsertResponse xmlns='urn:enterprise.soap.sforce.com'&gt;&lt;result&gt;&lt;created&gt;&lt;/created&gt;&lt;id&gt;&lt;/id&gt;&lt;success&gt;&lt;/success&gt;&lt;/result&gt;&lt;/upsertResponse&gt;&quot;);&#xD;&#xA;msgUpsertResponse.parameters=xmlDoc;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Upsert Response message has been constructed&quot;,token));&#xD;&#xA;&#xD;&#xA;expObj = new System.Exception();&#xD;&#xA;isException = false;&#xD;&#xA;IsSoapExp = false;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="msgassign_UpsertReq" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Construct" OID="f3d61d81-33d9-4c8a-acba-95cf607c1931" ParentLink="ComplexStatement_Statement" LowerBound="598.1" HigherBound="605.1">
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ConstructMessage_Archive" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessageAssignment" OID="b2889a5a-62d6-4d4e-8af4-9aaec0a03ffd" ParentLink="ComplexStatement_Statement" LowerBound="601.1" HigherBound="604.1">
                                        <om:Property Name="Expression" Value="msgArchive = msgUpsertRequest.parameters;&#xD;&#xA;msgArchive(FILE.ReceivedFileName) = varArchiveFileName;" />
                                        <om:Property Name="ReportToAnalyst" Value="False" />
                                        <om:Property Name="Name" Value="MessageAssignment_InArchive" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessageRef" OID="0c69a361-6369-4ee6-be15-fd83abe1e04f" ParentLink="Construct_MessageRef" LowerBound="599.43" HigherBound="599.53">
                                        <om:Property Name="Ref" Value="msgArchive" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="Send" OID="51a764a1-cc6e-4c10-ac95-93c449b0c428" ParentLink="ComplexStatement_Statement" LowerBound="605.1" HigherBound="607.1">
                                    <om:Property Name="PortName" Value="port_SalesForceInboundArchive" />
                                    <om:Property Name="MessageName" Value="msgArchive" />
                                    <om:Property Name="OperationName" Value="Archive" />
                                    <om:Property Name="OperationMessageName" Value="Request" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Send_Archive" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="While" OID="29d1b6e1-c129-4bcb-8049-a7496071afb7" ParentLink="ComplexStatement_Statement" LowerBound="607.1" HigherBound="737.1">
                                    <om:Property Name="Expression" Value="retryCount &lt;= retryLimit" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Loop_Retry" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Scope" OID="1481cf60-63ad-4f86-ba2a-901c6b7da6b3" ParentLink="ComplexStatement_Statement" LowerBound="610.1" HigherBound="646.1">
                                        <om:Property Name="InitializedTransactionType" Value="True" />
                                        <om:Property Name="IsSynchronized" Value="False" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="scope_Upsert" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Send" OID="11c6145a-462a-4150-90a9-94811ea43ae9" ParentLink="ComplexStatement_Statement" LowerBound="615.1" HigherBound="617.1">
                                            <om:Property Name="PortName" Value="Port_SendUpsert" />
                                            <om:Property Name="MessageName" Value="msgUpsertRequest" />
                                            <om:Property Name="OperationName" Value="Operation_SendUpsert" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="send_UpsertReq" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Receive" OID="8434eca0-8114-401c-ba26-51b0827fce45" ParentLink="ComplexStatement_Statement" LowerBound="617.1" HigherBound="619.1">
                                            <om:Property Name="Activate" Value="False" />
                                            <om:Property Name="PortName" Value="Port_SendUpsert" />
                                            <om:Property Name="MessageName" Value="msgUpsertResponse" />
                                            <om:Property Name="OperationName" Value="Operation_SendUpsert" />
                                            <om:Property Name="OperationMessageName" Value="Response" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="rcv_UpsertRes" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Send" OID="0183d37f-c6c9-432a-bf48-1607c013b696" ParentLink="ComplexStatement_Statement" LowerBound="619.1" HigherBound="621.1">
                                            <om:Property Name="PortName" Value="port_ArchiveResponse" />
                                            <om:Property Name="MessageName" Value="msgUpsertResponse" />
                                            <om:Property Name="OperationName" Value="Archive" />
                                            <om:Property Name="OperationMessageName" Value="Request" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Send_ArchiveResponse" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="Catch" OID="3349f621-6186-4be1-8032-e1ed976f2e14" ParentLink="Scope_Catch" LowerBound="624.1" HigherBound="634.1">
                                            <om:Property Name="ExceptionName" Value="excp" />
                                            <om:Property Name="ExceptionType" Value="System.Exception" />
                                            <om:Property Name="IsFaultMessage" Value="False" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="catch_system" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="71efd030-2941-4cc0-ad61-74a724907b77" ParentLink="Catch_Statement" LowerBound="627.1" HigherBound="633.1">
                                                <om:Property Name="Expression" Value="expObj = new System.Exception();&#xD;&#xA;expObj = excp;&#xD;&#xA;isException = true;&#xD;&#xA;IsSoapExp = false;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} :Error in Transmitting the message.{1}; Retry count:&quot;+retryCount.ToString(), token, excp.ToString()));&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_TraceException" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="Catch" OID="9f4087c4-3cd8-495e-93b8-b50bfb724a20" ParentLink="Scope_Catch" LowerBound="634.1" HigherBound="644.1">
                                            <om:Property Name="ExceptionName" Value="soapExc" />
                                            <om:Property Name="ExceptionType" Value="Port_SendUpsert.Operation_SendUpsert.GenericSoapFault" />
                                            <om:Property Name="IsFaultMessage" Value="False" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="soapExc" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="VariableAssignment" OID="994b16c6-a35b-4f6a-bbac-f3c531bff53c" ParentLink="Catch_Statement" LowerBound="637.1" HigherBound="643.1">
                                                <om:Property Name="Expression" Value="strException = xpath(soapExc, &quot;string(/*[local-name()='Fault' and namespace-uri()='http://schemas.xmlsoap.org/soap/envelope/']/*[local-name()='faultstring' and namespace-uri()=''])&quot;);&#xD;&#xA;expObj = new System.Exception(&quot;ServiceMax returned an error message&quot;+strException);&#xD;&#xA;isException = true;&#xD;&#xA;IsSoapExp = true;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} :A SOAP exception has occured within the Upsert call. Error Description: &quot;+ strException, token));&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_SoapExcp" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="1ac6fd12-0850-4aca-afa4-827b74638508" ParentLink="ComplexStatement_Statement" LowerBound="646.1" HigherBound="656.1">
                                        <om:Property Name="Expression" Value="xmlDoc = new System.Xml.XmlDocument();&#xD;&#xA;xmlDoc = msgUpsertResponse.parameters;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Upsert Response - {1}&quot;, token, xmlDoc.InnerXml));&#xD;&#xA;resultCount = xpath(msgUpsertResponse.parameters, &quot;count(/*[local-name()='upsertResponse' and namespace-uri()='urn:enterprise.soap.sforce.com']/*[local-name()='result' and namespace-uri()='urn:enterprise.soap.sforce.com'])&quot;);&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Upsert Response - Result Count: {1}&quot;, token, resultCount.ToString()));&#xD;&#xA;&#xD;&#xA;resultCounter = 1;&#xD;&#xA;resultCounterStr = &quot;1&quot;;&#xD;&#xA;&#xD;&#xA;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="exp_CountUpsertResult" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="While" OID="587a576c-a0af-4bb7-9099-753073f80703" ParentLink="ComplexStatement_Statement" LowerBound="656.1" HigherBound="677.1">
                                        <om:Property Name="Expression" Value="resultCounter &lt;= resultCount" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Loop_ResultCount" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="VariableAssignment" OID="cb687316-6d31-4cfc-a43d-a741e4585f93" ParentLink="ComplexStatement_Statement" LowerBound="659.1" HigherBound="676.1">
                                            <om:Property Name="Expression" Value="//upsertResp = xpath(msgUpsertResponse.parameters, &quot;string(/*[local-name()='upsertResponse' and namespace-uri()='urn:enterprise.soap.sforce.com']/*[local-name()='result' and namespace-uri()='urn:enterprise.soap.sforce.com']/*[local-name()='success' and namespace-uri()='urn:enterprise.soap.sforce.com'][&quot; + resultCounterStr + &quot;]/text())&quot;);&#xD;&#xA;&#xD;&#xA;upsertResp = xpath(msgUpsertResponse.parameters, &quot;string(/*[local-name()='upsertResponse' and namespace-uri()='urn:enterprise.soap.sforce.com']/*[local-name()='result' and namespace-uri()='urn:enterprise.soap.sforce.com'][&quot; + resultCounterStr + &quot;]/*[local-name()='success' and namespace-uri()='urn:enterprise.soap.sforce.com'])&quot;);&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Upsert Result for Count {1} :&quot; + upsertResp, token, resultCounter.ToString()));&#xD;&#xA;if(upsertResp == &quot;false&quot;)&#xD;&#xA;{&#xD;&#xA;&#xD;&#xA;    resultCounter = resultCount + 1;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} Within IF:&quot;, token));&#xD;&#xA;}&#xD;&#xA;else&#xD;&#xA;{&#xD;&#xA;    resultCounter = resultCounter + 1;&#xD;&#xA;    resultCounterStr = resultCounter.ToString();&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} Within ELSE; resultCounterStr: &quot;+ resultCounterStr, token));&#xD;&#xA;}&#xD;&#xA;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="exp_ReadResult" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Decision" OID="2095f832-0971-471c-9bf5-f46a5768bd9b" ParentLink="ComplexStatement_Statement" LowerBound="677.1" HigherBound="736.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="decide_RetryCount" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="DecisionBranch" OID="23af5251-9830-4f06-ad20-db358a610569" ParentLink="ReallyComplexStatement_Branch" LowerBound="678.37" HigherBound="686.1">
                                            <om:Property Name="Expression" Value="(retryCount &gt;= retryLimit &amp;&amp; isException == true)" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="rule_RetryCountLimit" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="b968cb6e-a29a-4527-be0a-1b9c2f7746e4" ParentLink="ComplexStatement_Statement" LowerBound="680.1" HigherBound="683.1">
                                                <om:Property Name="Expression" Value="retryCount = retryLimit + 1;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : An error occurred during the Upsert call. Exiting the loop&quot;,token));" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_ExitRetry" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="Throw" OID="5590ee09-533a-4d94-98bd-069c549c2bf2" ParentLink="ComplexStatement_Statement" LowerBound="683.1" HigherBound="685.1">
                                                <om:Property Name="ThrownReference" Value="expObj" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="throwException" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="ffcfa8ef-1911-46e5-b491-e5282100cc09" ParentLink="ReallyComplexStatement_Branch" LowerBound="686.42" HigherBound="704.1">
                                            <om:Property Name="Expression" Value="(isException == false) &amp;&amp; (upsertResp == &quot;true&quot;)" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="rule_NoException" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="762a020e-6d3f-4baf-9f4b-56ddd5b16b15" ParentLink="ComplexStatement_Statement" LowerBound="688.1" HigherBound="703.1">
                                                <om:Property Name="Expression" Value="xmlDoc = new System.Xml.XmlDocument();&#xD;&#xA;xmlDoc = msgUpsertResponse.parameters;&#xD;&#xA;//flowTracker.IsError = &quot;False&quot;;&#xD;&#xA;//flowTracker.IsRetrying = &quot;False&quot;;&#xD;&#xA;//flowTracker.IsSentToServiceMax = &quot;Success&quot;;&#xD;&#xA;//flowTracker.IsEmailSent = &quot;False&quot;;&#xD;&#xA;//flowTracker.IsMessageSuspended = &quot;False&quot;;&#xD;&#xA;//flowTracker.SentToServiceMaxTime = System.DateTime.Now.ToString();&#xD;&#xA;//flowTracker.ServiceMaxRespMsg = xmlDoc.OuterXml;&#xD;&#xA;//flowTracker.CommitSAPToServiceMaxActivity();&#xD;&#xA;//flowTracker.EndSAPToServiceMaxActivity();&#xD;&#xA;retryCount = retryLimit + 1;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Upsert successfully completed; Upsert response: &quot; + xmlDoc.OuterXml.ToString(), token));&#xD;&#xA;&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_BAMTracking" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="caaa39a3-62ca-40ba-becf-bf24ce4a0501" ParentLink="ReallyComplexStatement_Branch" LowerBound="704.42" HigherBound="719.1">
                                            <om:Property Name="Expression" Value="upsertResp == &quot;false&quot;" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="rule_UpsertResp" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="Construct" OID="b78620b1-ad17-466b-8c19-8f5a96be7428" ParentLink="ComplexStatement_Statement" LowerBound="706.1" HigherBound="712.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="construct_XMLDocUpsertRespMsg" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageRef" OID="98493bd6-e2d7-4261-baf2-b6b4d6565c54" ParentLink="Construct_MessageRef" LowerBound="707.51" HigherBound="707.60">
                                                    <om:Property Name="Ref" Value="xmlDocMsg" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="34928b44-bfb4-419c-bad0-32f9fefd6b86" ParentLink="ComplexStatement_Statement" LowerBound="709.1" HigherBound="711.1">
                                                    <om:Property Name="Expression" Value="xmlDocMsg = msgUpsertResponse.parameters;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="msgAssign_UpsertResp" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="VariableAssignment" OID="56691e47-2bc6-4cf4-8150-3d738906ff32" ParentLink="ComplexStatement_Statement" LowerBound="712.1" HigherBound="716.1">
                                                <om:Property Name="Expression" Value="retryCount = retryLimit + 1;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Upsert returned a failure response. &quot;+xmlDocMsg.OuterXml,token));&#xD;&#xA;expObj = new System.Exception(System.String.Format(&quot;ServiceMax returned an error message; &lt;xmp&gt;{0}&lt;/xmp&gt;​ &quot;, xmlDocMsg.OuterXml));" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_ExitRetry" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Throw" OID="bc0cb438-1508-478a-ad9b-496048ac1bc0" ParentLink="ComplexStatement_Statement" LowerBound="716.1" HigherBound="718.1">
                                                <om:Property Name="ThrownReference" Value="expObj" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="throwException" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="8d975c89-fdd1-4f22-bc11-aa84ac82050b" ParentLink="ReallyComplexStatement_Branch" LowerBound="719.42" HigherBound="727.1">
                                            <om:Property Name="Expression" Value="IsSoapExp == true" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="rule_SOAPExp" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="eabc8096-de1a-449b-ab5d-71259de076fe" ParentLink="ComplexStatement_Statement" LowerBound="721.1" HigherBound="724.1">
                                                <om:Property Name="Expression" Value="retryCount = retryLimit + 1;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : A SOAP exception occurred during the Upsert call. Exiting the loop&quot;,token));" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_ExitRetry" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Throw" OID="5aaad03f-a96e-4bcf-965c-69766e5eaca0" ParentLink="ComplexStatement_Statement" LowerBound="724.1" HigherBound="726.1">
                                                <om:Property Name="ThrownReference" Value="expObj" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="throwException" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="b4233345-c406-49a4-8c76-9a15026592ed" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Else" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="VariableAssignment" OID="4e868ab2-93a5-48a8-a127-4ba5ab66a811" ParentLink="ComplexStatement_Statement" LowerBound="729.1" HigherBound="733.1">
                                                <om:Property Name="Expression" Value="retryCount = retryCount +1;&#xD;&#xA;isException =false;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Error in transmitting the upsert request; Waiting to retry&quot;,token));&#xD;&#xA;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="exp_IncrementRetryCount" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="Delay" OID="2c8a2915-fe10-4bb8-ae4b-36755069ca96" ParentLink="ComplexStatement_Statement" LowerBound="733.1" HigherBound="735.1">
                                                <om:Property Name="Timeout" Value="new System.TimeSpan(0,retryInterval,0);" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="delay_RetryInterval" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Catch" OID="0bf997e2-11e2-48cf-b00e-eab12dc0cd90" ParentLink="Scope_Catch" LowerBound="741.1" HigherBound="817.1">
                            <om:Property Name="ExceptionName" Value="AllExcp" />
                            <om:Property Name="ExceptionType" Value="System.Exception" />
                            <om:Property Name="IsFaultMessage" Value="False" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="catch_AllException" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="VariableAssignment" OID="6fda8544-af74-47e2-8396-f7a96a2dcb1d" ParentLink="Catch_Statement" LowerBound="744.1" HigherBound="746.1">
                                <om:Property Name="Expression" Value="errorMsg = AllExcp.ToString();" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ErrorMessage" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Construct" OID="969037b1-0377-404a-b3dd-5d08cf3c4412" ParentLink="Catch_Statement" LowerBound="746.1" HigherBound="754.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="construct_FailedInterchangeMsg" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageRef" OID="b5a11d0e-25bc-4ba7-91a5-b96d3729aab0" ParentLink="Construct_MessageRef" LowerBound="747.43" HigherBound="747.63">
                                    <om:Property Name="Ref" Value="msgFailedInterchange" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="8ffcdd0f-b80e-4f59-becf-891829d49489" ParentLink="ComplexStatement_Statement" LowerBound="749.1" HigherBound="753.1">
                                    <om:Property Name="Expression" Value="msgFailedInterchange = inXmlMsg;&#xD;&#xA;msgFailedInterchange(Visy.Middleware.SAP.ServiceMax.Schemas.ErrorDescription) = errorMsg;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Sending Mesasage to Suspend Orchestration&quot;,token));&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="msgassign_OriginialMsg" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="ed084577-bb5e-4db9-ba85-0bfb8f84e965" ParentLink="Catch_Statement" LowerBound="754.1" HigherBound="810.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="ConstructExceptionEmail" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="MessageAssignment" OID="d2c852a9-d8a2-46e7-bbe7-6092a4c84ca2" ParentLink="ComplexStatement_Statement" LowerBound="757.1" HigherBound="809.1">
                                    <om:Property Name="Expression" Value="//Build HTML Message body&#xD;&#xA;strbuilder_MsgBody = new System.Text.StringBuilder();&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;html&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;head&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/head&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;body&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;p&gt;&lt;B&gt;SAPToSMAX Orchestration Error&lt;/B&gt;&lt;/p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Date of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortDateString());&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Time of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Integration Point:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(varIntegrationPoint);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Exception:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(errorMsg);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;IDOC DocNum of Incoming Message:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(DocNum);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Processing Server:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(System.Environment.MachineName);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/body&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;//Set Email Properties&#xD;&#xA;msgEmailException.msgBody = new Visy.Middleware.SAP.ServiceMax.Components.RawString(strbuilder_MsgBody.ToString());&#xD;&#xA;msgEmailException.msgBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;msgEmailException(SMTP.Subject) = &quot;SAPToSMAX Orchestration failed in BizTalk Server: &quot; + System.Environment.MachineName;&#xD;&#xA;&#xD;&#xA;msgEmailException(SMTP.From) = &quot;bt2016@visy.com.au&quot;;&#xD;&#xA;msgEmailException(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Created SMTP Mail Message&quot;,token));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="msgassign_ExceptionMail" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="ffa78009-6132-471b-86e3-516aa66f4be4" ParentLink="Construct_MessageRef" LowerBound="755.43" HigherBound="755.60">
                                    <om:Property Name="Ref" Value="msgEmailException" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Send" OID="0e9baf56-7949-40eb-a543-1bb597814fdb" ParentLink="Catch_Statement" LowerBound="810.1" HigherBound="812.1">
                                <om:Property Name="PortName" Value="Port_SendMail" />
                                <om:Property Name="MessageName" Value="msgEmailException" />
                                <om:Property Name="OperationName" Value="Email" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="send_Mail" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Send" OID="2db2feed-842e-4cab-97ef-7099d015e125" ParentLink="Catch_Statement" LowerBound="812.1" HigherBound="814.1">
                                <om:Property Name="PortName" Value="Port_SendSusMsg" />
                                <om:Property Name="MessageName" Value="msgFailedInterchange" />
                                <om:Property Name="OperationName" Value="Operation_SendSusMsg" />
                                <om:Property Name="OperationMessageName" Value="Request" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="send_SuspendMsg" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                            <om:Element Type="Terminate" OID="07af80c4-063a-4547-89f2-64159dc25e6a" ParentLink="Catch_Statement" LowerBound="814.1" HigherBound="816.1">
                                <om:Property Name="ErrorMessage" Value="&quot;Service Max Part Update terminated due to error:&quot; + AllExcp.Message;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Terminate" />
                                <om:Property Name="Signal" Value="True" />
                            </om:Element>
                        </om:Element>
                    </om:Element>
                    <om:Element Type="Catch" OID="aab0b95f-1e06-4c51-a629-8e95cf896ee6" ParentLink="Scope_Catch" LowerBound="822.1" HigherBound="886.1">
                        <om:Property Name="ExceptionName" Value="sysex" />
                        <om:Property Name="ExceptionType" Value="System.Exception" />
                        <om:Property Name="IsFaultMessage" Value="False" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Catch_GeneralException" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="VariableAssignment" OID="9c9222f1-f0bf-43d0-bd9f-9d7d3dc817e2" ParentLink="Catch_Statement" LowerBound="825.1" HigherBound="827.1">
                            <om:Property Name="Expression" Value="errorMsg = sysex.ToString();" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ErrorMessage" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="Construct" OID="3c8d3346-95af-4d35-afac-9a46ba09da9c" ParentLink="Catch_Statement" LowerBound="827.1" HigherBound="883.1">
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="ConstructExceptionEmail" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="MessageAssignment" OID="1eb1b7d9-dfcf-4667-8d4c-cec7c9395c0f" ParentLink="ComplexStatement_Statement" LowerBound="830.1" HigherBound="882.1">
                                <om:Property Name="Expression" Value="//Build HTML Message body&#xD;&#xA;strbuilder_MsgBody = new System.Text.StringBuilder();&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;html&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;head&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/head&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;body&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;p&gt;&lt;B&gt;SAPToSMAX Orchestration Error&lt;/B&gt;&lt;/p&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Date of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortDateString());&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Time of Error:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Integration Point:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(varIntegrationPoint);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Exception:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(errorMsg);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;IDOC DocNum of Incoming Message:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(DocNum);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;tr&gt;&lt;td&gt;Processing Server:&lt;/td&gt;&lt;td&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(System.Environment.MachineName);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/td&gt;&lt;/tr&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/table&gt;&quot;);&#xD;&#xA;&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/body&gt;&quot;);&#xD;&#xA;strbuilder_MsgBody.AppendLine(&quot;&lt;/html&gt;&quot;);&#xD;&#xA;&#xD;&#xA;//Set Email Properties&#xD;&#xA;msgEmailException.msgBody = new Visy.Middleware.SAP.ServiceMax.Components.RawString(strbuilder_MsgBody.ToString());&#xD;&#xA;msgEmailException.msgBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;msgEmailException(SMTP.Subject) = &quot;SAPToSMAX Orchestration failed in BizTalk Server: &quot; + System.Environment.MachineName;&#xD;&#xA;&#xD;&#xA;msgEmailException(SMTP.From) = &quot;bt2016@visy.com.au&quot;;&#xD;&#xA;msgEmailException(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format(&quot;{0} : Created SMTP Mail Message&quot;,token));&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;&#xD;&#xA;" />
                                <om:Property Name="ReportToAnalyst" Value="False" />
                                <om:Property Name="Name" Value="msgassign_ExceptionMail" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                            <om:Element Type="MessageRef" OID="346f9555-9fcd-4928-9c0c-6e82cf4cc763" ParentLink="Construct_MessageRef" LowerBound="828.35" HigherBound="828.52">
                                <om:Property Name="Ref" Value="msgEmailException" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="Send" OID="02aac028-a78b-40cc-8caf-8a30ec6f3cd6" ParentLink="Catch_Statement" LowerBound="883.1" HigherBound="885.1">
                            <om:Property Name="PortName" Value="Port_SendMail" />
                            <om:Property Name="MessageName" Value="msgEmailException" />
                            <om:Property Name="OperationName" Value="Email" />
                            <om:Property Name="OperationMessageName" Value="Request" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="send_Mail" />
                            <om:Property Name="Signal" Value="True" />
                        </om:Element>
                    </om:Element>
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="9e0877db-c029-4e35-980d-913569e00505" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="49.1" HigherBound="51.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Unbound" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.PortType_SendUpsertReq" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendUpsert" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="PhysicalBindingAttribute" OID="fdf2e3b2-6576-49bb-905d-29f0156af910" ParentLink="PortDeclaration_CLRAttribute" LowerBound="49.1" HigherBound="50.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLTransmit" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="4b5635df-37f2-4d9d-bd6e-5f233d4d2855" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="51.1" HigherBound="53.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Unbound" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.PortType_SendSusMsg" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendSusMsg" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="DirectBindingAttribute" OID="6c90187c-d7ec-4e89-ae90-79e84025bc08" ParentLink="PortDeclaration_CLRAttribute" LowerBound="51.1" HigherBound="52.1">
                    <om:Property Name="PartnerPort" Value="Port_RecSusMsg" />
                    <om:Property Name="PartnerService" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.SuspendMessage" />
                    <om:Property Name="DirectBindingType" Value="PartnerPort" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="2c83d870-0e7d-4858-a6e1-9c2ffed44c97" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="53.1" HigherBound="55.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="0" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.PortTypeInXmlMsg" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_InXmlMsg" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="DirectBindingAttribute" OID="adb23a83-c294-44b7-9340-b75e5c9186bc" ParentLink="PortDeclaration_CLRAttribute" LowerBound="53.1" HigherBound="54.1">
                    <om:Property Name="DirectBindingType" Value="MessageBox" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="4a3321ee-2189-4070-b6e1-75447ad87931" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="55.1" HigherBound="57.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="171" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.PortType_Email" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendMail" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="d3dd6c03-cf47-4e25-a0da-ad4523157e94" ParentLink="PortDeclaration_CLRAttribute" LowerBound="55.1" HigherBound="56.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="770e31e9-b343-4ddc-88d0-756c53af2fac" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="57.1" HigherBound="59.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="76" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Schemas.ProductStockWebservice.ProductStockWebServicePortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Port_SendProductStock" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="PhysicalBindingAttribute" OID="fecd6fd2-f4b6-4c1d-9f2a-e746ea903480" ParentLink="PortDeclaration_CLRAttribute" LowerBound="57.1" HigherBound="58.1">
                    <om:Property Name="InPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLReceive" />
                    <om:Property Name="OutPipeline" Value="Microsoft.BizTalk.DefaultPipelines.XMLTransmit" />
                    <om:Property Name="TransportType" Value="HTTP" />
                    <om:Property Name="URI" Value="http://tempURI" />
                    <om:Property Name="IsDynamic" Value="True" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="2e0a9a39-dbc7-4ef6-a32d-d09d05546003" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="59.1" HigherBound="61.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="88" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.PortType_SalesForceInboundArchive" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="port_SalesForceInboundArchive" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="e7193506-6a5d-436c-a8e5-2b0626c6c28e" ParentLink="PortDeclaration_CLRAttribute" LowerBound="59.1" HigherBound="60.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="c6d3dcca-3399-42ec-ad3c-c757bbd08a11" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="61.1" HigherBound="63.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="-1" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.ServiceMax.Orchestrations.PortType_ArchiveResponse" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="port_ArchiveResponse" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="2524ca13-468b-40d6-9abe-728240d9e2d7" ParentLink="PortDeclaration_CLRAttribute" LowerBound="61.1" HigherBound="62.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module Visy.Middleware.SAP.ServiceMax.Orchestrations
{
    internal porttype PortType_SendUpsertReq
    {
        requestresponse Operation_SendUpsert
        {
            Visy.Middleware.SAP.ServiceMax.Schemas.SforceServiceClient.upsertRequest, Visy.Middleware.SAP.ServiceMax.Schemas.SforceServiceClient.upsertResponse, GenericSoapFault = BTS.soap_envelope_1__1.Fault
        };
    };
    internal porttype PortTypeInXmlMsg
    {
        oneway Operation_InXmlMsg
        {
            System.Xml.XmlDocument
        };
    };
    internal porttype PortType_SendSusMsg
    {
        oneway Operation_SendSusMsg
        {
            System.Xml.XmlDocument
        };
    };
    public porttype PortType_SAPInboundArchive
    {
        oneway Archive
        {
            System.Xml.XmlDocument
        };
    };
    public porttype PortType_SalesForceInboundArchive
    {
        oneway Archive
        {
            System.Xml.XmlDocument
        };
    };
    public porttype PortType_ArchiveResponse
    {
        oneway Archive
        {
            Visy.Middleware.SAP.ServiceMax.Schemas.SforceServiceClient.upsertResponse
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service SAPToSMAX
    {
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Microsoft.BizTalk.DefaultPipelines.XMLReceive), typeof(Microsoft.BizTalk.DefaultPipelines.XMLTransmit))]
        port uses dynamic PortType_SendUpsertReq Port_SendUpsert;
        [Microsoft.XLANGs.BaseTypes.DirectBinding(typeof(Visy.Middleware.SAP.ServiceMax.Orchestrations.SuspendMessage), "Port_RecSusMsg")]
        port uses PortType_SendSusMsg Port_SendSusMsg;
        [Microsoft.XLANGs.BaseTypes.DirectBinding()]
        port implements PortTypeInXmlMsg Port_InXmlMsg;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_Email Port_SendMail;
        [Microsoft.XLANGs.BaseTypes.PhysicalBinding(typeof(Microsoft.BizTalk.DefaultPipelines.XMLReceive), typeof(Microsoft.BizTalk.DefaultPipelines.XMLTransmit))]
        port uses dynamic Visy.Middleware.SAP.ServiceMax.Schemas.ProductStockWebservice.ProductStockWebServicePortType Port_SendProductStock;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_SalesForceInboundArchive port_SalesForceInboundArchive;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses PortType_ArchiveResponse port_ArchiveResponse;
        message System.Xml.XmlDocument inXmlMsg;
        message Visy.Middleware.SAP.ServiceMax.Schemas.SforceServiceClient.upsertRequest msgUpsertRequest;
        message Visy.Middleware.SAP.ServiceMax.Schemas.SforceServiceClient.upsertResponse msgUpsertResponse;
        message emailExceptionType msgEmailException;
        message System.Xml.XmlDocument msgFailedInterchange;
        message Visy.Middleware.Common.Schemas.SAP.CREMAS04._740.IDocOperation_CREMAS04_ZCREMAS04_740_3_Receive VendorCREMAS04;
        message Visy.Middleware.Common.Schemas.SAP.ZSM_WBS.IDocOperation_ZSM_WBS_740_3_Receive WBSzsmWBS;
        message System.Xml.XmlDocument xmlDocMsg;
        message Visy.Middleware.Common.Schemas.SAP.ZSM_CREDNOTE.IDocOperation_ZSM_CREDNOTE_740_3_Receive CREDITNOTE;
        message Visy.Middleware.Common.Schemas.SAP.ZSM_STKLOC.IDocOperation_ZSM_STKLOC_740_3_Receive STOCKLOC;
        message Visy.Middleware.Common.Schemas.SAP.ZSM_PROD.IDocOperation_ZSM_PROD_740_3_Receive PRODStock;
        message Visy.Middleware.Common.Schemas.Schemas.ZSM_PRICE.IDocOperation_ZSM_PRICE_740_3_Receive PartPRICE;
        message Visy.Middleware.Common.Schemas.SAP.ZSM_PR_STATUS.IDocOperation_ZSM_PR_STATUS_740_3_Receive PRSTATUS;
        message Visy.Middleware.SAP.ServiceMax.Schemas.ProductStockWebservice.UpdateProductStockQuantityRequest msgProductStockRequest;
        message Visy.Middleware.SAP.ServiceMax.Schemas.ProductStockWebservice.UpdateProductStockQuantityResponse msgProductStockResponse;
        message System.Xml.XmlDocument msgArchive;
        System.Boolean PRODS;
        System.Boolean STKLOC;
        System.Boolean CREDNOTE;
        System.String upsertResp;
        System.Boolean IsSoapExp;
        System.Text.StringBuilder strbuilder_MsgBody;
        System.Boolean CREMAS04;
        System.String strException;
        System.Guid token;
        System.Xml.XmlDocument xmlDoc;
        System.Int32 retryCount;
        System.Boolean isException;
        System.Exception expObj;
        System.String errorMsg;
        System.Int32 retryLimit;
        System.Int32 retryInterval;
        System.String MsgType;
        System.Boolean WBS;
        System.String DocNum;
        System.Int32 resultCount;
        System.Int32 resultCounter;
        System.String resultCounterStr;
        System.Boolean PRICE;
        System.Boolean ZSMPRSTATUS;
        System.Xml.XmlDocument xmlDocForBAM;
        System.String varIntegrationPoint;
        System.String varArchiveFileName;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("7f7570c7-c720-41a8-b3a0-7fa6abb847aa")]
            activate ((BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive#Receive") || (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive#Receive") || (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive#Receive") || (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive#Receive") || (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive#Receive") || (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive#Receive") || (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive#Receive") || (BTS.Operation == "Operation_SendResubmitMsg") && (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive#Receive") || (BTS.Operation == "Operation_SendResubmitMsg") && (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive#Receive") || (BTS.Operation == "Operation_SendResubmitMsg") && (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive#Receive") || (BTS.Operation == "Operation_SendResubmitMsg") && (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive#Receive") || (BTS.Operation == "Operation_SendResubmitMsg") && (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive#Receive") || (BTS.Operation == "Operation_SendResubmitMsg") && (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive#Receive") || (BTS.Operation == "Operation_SendResubmitMsg") && (BTS.MessageType == "http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive#Receive"))receive (Port_InXmlMsg.Operation_InXmlMsg, inXmlMsg);
            PRODS = false;
            STKLOC = false;
            CREDNOTE = false;
            upsertResp = "";
            IsSoapExp = false;
            strbuilder_MsgBody = new System.Text.StringBuilder();
            CREMAS04 = false;
            strException = "";
            xmlDoc = new System.Xml.XmlDocument();
            isException = false;
            expObj = new System.Exception();
            errorMsg = "";
            MsgType = "";
            WBS = false;
            DocNum = "";
            resultCounterStr = "";
            PRICE = false;
            ZSMPRSTATUS = false;
            xmlDocForBAM = new System.Xml.XmlDocument();
            varIntegrationPoint = "";
            varArchiveFileName = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1cd59764-8f11-4bad-a83d-52b94b337250")]
            xmlDoc = inXmlMsg;
            token = System.Guid.NewGuid();//Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceIn("SAPToServiceMax Orchestration started");
            //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Received Message from SAP", token));
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("e1be2dff-306b-48ba-a226-0963e23a4836")]
            //flowTracker = new Visy.Middleware.SAP.ServiceMax.Components.OrchestrationESApi.SAPToServiceMax();
            //flowTracker.BeginSAPToServiceMaxActivity();
            //flowTracker.MsgReceivedTime = System.DateTime.Now.ToString();
            //flowTracker.MessageData = xmlDoc.OuterXml;
            //flowTracker.CommitSAPToServiceMaxActivity();
            
            //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : BAM Tracking has Started , Activity ID :" + //flowTracker.ActivityID ,token));
            DocNum = "";
            varIntegrationPoint = "";
            
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3a4ead45-00d7-4c22-a04d-8e2deea633d5")]
            scope
            {
                body
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("cad58c38-31ca-4cc0-8821-ed4c2cbe46e8")]
                    retryLimit = System.Convert.ToInt32(Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData("RetryLimit", "SAP.ServiceMax"));
                    retryInterval = System.Convert.ToInt32(Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData("RetryInterval", "SAP.ServiceMax"));
                    retryCount = 1;
                    
                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Login Orchestration Started " ,token));
                    
                    CREMAS04 = false;
                    WBS = false;
                    CREDNOTE = false;
                    STKLOC = false;
                    PRODS = false;
                    PRICE = false;
                    ZSMPRSTATUS = false;
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d96bd61b-dec8-411b-ae43-cfdf7855abea")]
                    scope
                    {
                        body
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("2164b825-399d-4d07-86be-8221f366d62a")]
                            call Visy.Middleware.SAP.ServiceMax.Orchestrations.ServiceMaxLogin (token);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("ebedf2b4-e5f9-4b89-af2b-2741f42e180e")]
                            upsertResp = "false";
                            MsgType = inXmlMsg(BTS.MessageType);
                            
                            //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Checking Messaeg Type :" + MsgType,token));
                            
                            if (MsgType.Contains("CREMAS04"))
                            {
                               CREMAS04 = true;
                            }
                            
                            if (MsgType.Contains("ZSM_WBS"))
                            {
                               WBS = true;
                            }
                            
                            if (MsgType.Contains("ZSM_CREDNOTE"))
                            { 
                               CREDNOTE = true;
                            }
                            
                            if (MsgType.Contains("ZSM_STKLOC"))
                            {
                               STKLOC = true;
                            }
                            
                            if (MsgType.Contains("ZSM_PROD"))
                            {
                               PRODS = true;   
                            }
                            
                            if (MsgType.Contains("ZSM_PRICE"))
                            {
                               PRICE = true;
                            }
                            
                            if (MsgType.Contains("ZSM_PR_STATUS"))
                            {
                               ZSMPRSTATUS = true;
                            }
                            
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("764d9e54-beac-470e-b64b-f9bba61eb04f")]
                            if (PRODS)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("600ac304-7adb-43f4-8287-9da30b109c78")]
                                ////flowTracker.ExternalId=xpath(inXmlMsg,"string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='ZSM_PRODS000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PROD//740']/*[local-name()='LGORT' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PROD//740'])");
                                //flowTracker.IDOCDocNum= xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PROD//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                //flowTracker.IntegrationPoint="SAP-SMAX_PRODS";
                                //flowTracker.ServerUrl = Visy.Middleware.SAP.ServiceMax.Components.SSOClientHelper.Read("_SapToServiceMax","ProductStockWebServiceURL");
                                //flowTracker.SessionID = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId;
                                //flowTracker.CommitSAPToServiceMaxActivity();
                                
                                DocNum = xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PROD//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PROD//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                varIntegrationPoint = "SAP-SMAX_PRODS";
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("5d8d7a37-9482-462e-9adc-e28f3b4814b0")]
                                construct PRODStock
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("6f0491f5-01d1-4a9c-a929-c63619065b2e")]
                                    PRODStock = xmlDoc;
                                    
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : PRODStock message has been constructed",token));
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("a1cab872-82f7-48e9-964e-fdc84a785f1e")]
                                construct msgProductStockRequest
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("66d358e8-3699-4bd1-a7a8-2d271a9616a5")]
                                    transform (msgProductStockRequest.parameters) = Visy.Middleware.SAP.ServiceMax.Maps.PROD_To_ProductStock (PRODStock);
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("87d975a0-c2d3-4cd1-ad83-21a764596014")]
                                    msgProductStockRequest(WCF.SecurityMode)="Transport";
                                    msgProductStockRequest(WCF.TransportClientCredentialType) = "None";
                                    msgProductStockRequest(WCF.Action)="";
                                    msgProductStockRequest(WCF.OutboundCustomHeaders) = "<headers><SessionHeader xmlns='http://soap.sforce.com/schemas/class/ProductStockWebService'><sessionId>" + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + "</sessionId></SessionHeader></headers>";
                                    
                                    Port_SendProductStock(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.Components.Utilities.DataLookupHelper.GetInterfaceLookupData("ProductStockWebServiceURL", "SAP.ServiceMax");
                                    Port_SendProductStock(Microsoft.XLANGs.BaseTypes.TransportType)="WCF-BasicHttp";
                                    varArchiveFileName = "PRODSTOCK_" + token.ToString();
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Product Stock Request message has been constructed",token));
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Session ID " + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId,token));
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : ProductStockURL" + Visy.Middleware.SAP.ServiceMax.Components.SSOClientHelper.Read("_SapToServiceMax","ProductStockWebServiceURL"),token));
                                    xmlDocForBAM = msgProductStockRequest.parameters;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("461b4cb6-40c5-49f3-a465-497dc7ea840b")]
                                construct msgProductStockResponse
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4f21ed1d-2b6a-4f9d-91bb-9e2439775e53")]
                                    xmlDoc = new System.Xml.XmlDocument();
                                    xmlDoc.LoadXml(@"<ns0:UpdateProductStockQuantityResponse xmlns:ns0='http://soap.sforce.com/schemas/class/ProductStockWebService'><ns0:result>result_0</ns0:result></ns0:UpdateProductStockQuantityResponse>");
                                    msgProductStockResponse.parameters=xmlDoc;
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Product Stock Response message has been constructed",token));
                                    
                                    expObj = new System.Exception();
                                    isException = false;
                                    IsSoapExp = false;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bea5647a-8b53-479d-8a52-f8f2b1dd827c")]
                                while (retryCount <= retryLimit)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("e2445461-1f87-4df6-ad0d-f6de4a2dd58d")]
                                    scope
                                    {
                                        body
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9ba8b236-4cd5-4add-8c9d-b9ffaeff208b")]
                                            construct msgArchive
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("05428b78-ec0b-4835-a4c0-f570becd212e")]
                                                msgArchive = msgProductStockRequest.parameters;
                                                msgArchive(FILE.ReceivedFileName) = varArchiveFileName;
                                            }
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("01c4dcde-f86d-4ca0-928c-7a0f29118743")]
                                            send (port_SalesForceInboundArchive.Archive, msgArchive);
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("cba7ca55-c247-4e2e-b4dc-5b4739e64ba0")]
                                            send (Port_SendProductStock.UpdateProductStockQuantity, msgProductStockRequest);
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6b6ae658-72fc-4cc9-9597-d59bf498d364")]
                                            receive (Port_SendProductStock.UpdateProductStockQuantity, msgProductStockResponse);
                                        }
                                        exceptions
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5d81beb4-e0ad-42f6-ad27-d553f9a79663")]
                                            catch (System.Exception excp)
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("3c838f20-ffde-4f84-9e28-5e69689719ed")]
                                                expObj = new System.Exception();
                                                expObj = excp;
                                                isException = true;
                                                IsSoapExp = false;
                                                //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} :Error in Transmitting the message.{1}; Retry count:"+retryCount.ToString(), token, excp.ToString()));
                                            }
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("6b3c2477-4fdd-46c0-957a-e016735c7358")]
                                            catch (Port_SendProductStock.UpdateProductStockQuantity.GenericSoapFault soapExc)
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("8aa7ece7-94ef-4afe-b078-6f4dbc067846")]
                                                strException = xpath(soapExc, "string(/*[local-name()='Fault' and namespace-uri()='http://schemas.xmlsoap.org/soap/envelope/']/*[local-name()='faultstring' and namespace-uri()=''])");
                                                expObj = new System.Exception("ServiceMax returned an error message" + strException);
                                                isException = true;
                                                IsSoapExp = true;
                                                //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} :A SOAP exception has occured within the Product Stock call. Error Description: "+ strException, token));
                                            }
                                        }
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("134ff479-d2ba-433e-a2e5-a16a5eba9de6")]
                                    if ((retryCount >= retryLimit && isException == true))
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("37c8bb94-2399-4ce1-b002-41c0ecbd60fb")]
                                        retryCount = retryLimit + 1;
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : An error occurred during the Product Stock call. Exiting the loop",token));
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("aff34979-48db-4490-82bc-963f2a1bf649")]
                                        throw expObj;
                                    }
                                    else if (isException == false)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("6fb1a6c0-a4bd-4a92-8d7e-d83e66fda6a9")]
                                        xmlDoc = new System.Xml.XmlDocument();
                                        xmlDoc = msgProductStockResponse.parameters;
                                        //flowTracker.IsError = "False";
                                        //flowTracker.IsRetrying = "False";
                                        //flowTracker.IsSentToServiceMax = "Success";
                                        //flowTracker.IsEmailSent = "False";
                                        //flowTracker.IsMessageSuspended = "False";
                                        //flowTracker.SentToServiceMaxTime = System.DateTime.Now.ToString();
                                        //flowTracker.ServiceMaxRespMsg = xmlDoc.OuterXml;
                                        //flowTracker.CommitSAPToServiceMaxActivity();
                                        //flowTracker.EndSAPToServiceMaxActivity();
                                        retryCount = retryLimit + 1;
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Product Stock Update successfully completed; Product Stock response: " + xmlDoc.OuterXml.ToString(), token));
                                        
                                    }
                                    else if (IsSoapExp == true)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d56bb65f-3844-41a6-9de6-ad039f58d019")]
                                        retryCount = retryLimit + 1;
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : A SOAP exception occurred during the Product Stock call. Exiting the loop",token));
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3da41298-1e37-468b-b281-a20fcb1c082e")]
                                        throw expObj;
                                    }
                                    else 
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("ea1a8320-c9e1-47b2-a4a1-743c461c56f3")]
                                        retryCount = retryCount +1;
                                        isException =false;
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Error in transmitting the Product Stock request; Waiting to retry",token));
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("41f3e355-e80a-4946-8eb6-e0dd7d53da5f")]
                                        delay new System.TimeSpan(0,retryInterval,0);
                                    }
                                }
                            }
                            else 
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("4cc0686e-7784-4f10-a6e5-511609442514")]
                                if (CREMAS04)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("edb6d0ef-b17c-4927-ac9e-8afc153ae6c5")]
                                    //flowTracker.ExternalId=xpath(inXmlMsg,"string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='E2LFA1M002GRP' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/CREMAS04/ZCREMAS04/740']/*[local-name()='E2LFA1M002' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/CREMAS04/ZCREMAS04/740']/*[local-name()='LIFNR' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/CREMAS04/ZCREMAS04/740'])");
                                    //flowTracker.IDOCDocNum= xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/CREMAS04/ZCREMAS04/740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    //flowTracker.IntegrationPoint="SAP-SMAX_VEN";
                                    //flowTracker.CommitSAPToServiceMaxActivity();
                                    
                                    DocNum = xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/CREMAS04/ZCREMAS04/740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/CREMAS04/ZCREMAS04/740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    varIntegrationPoint = "SAP-SMAX_VEN";
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("74eaabdf-a9b6-479b-96d0-a76d079ca746")]
                                    construct VendorCREMAS04
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("0f7df018-4eac-4402-af99-b6fe857c0117")]
                                        VendorCREMAS04 = xmlDoc;
                                        
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : CREMAS04 message has been constructed",token));
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("70d6f83f-6a7e-4ba6-b059-257a4144e037")]
                                    construct msgUpsertRequest
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e9a0b720-f921-4e98-b430-6743d291017c")]
                                        transform (msgUpsertRequest.parameters) = Visy.Middleware.SAP.ServiceMax.Maps.ZCREMAS04_To_Upsert (VendorCREMAS04);
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("1fe3a773-cf62-4a4a-a4c1-cb702a021100")]
                                        msgUpsertRequest(WCF.SecurityMode)="Transport";
                                        msgUpsertRequest(WCF.TransportClientCredentialType) = "None";
                                        msgUpsertRequest(WCF.Action)="";
                                        msgUpsertRequest(WCF.OutboundCustomHeaders) = "<headers><SessionHeader xmlns='urn:enterprise.soap.sforce.com'><sessionId>" + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + "</sessionId></SessionHeader></headers>";
                                        
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)="WCF-BasicHttp";
                                        
                                        varArchiveFileName = "CREMAS04_" + token.ToString();
                                        
                                        xmlDocForBAM = msgUpsertRequest.parameters;
                                    }
                                }
                                else if (WBS)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("ad4c20d8-f923-4eff-88e7-a413a976577f")]
                                    //flowTracker.ExternalId=xpath(inXmlMsg,"string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='ZSM_WBS_SEND000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_WBS//740']/*[local-name()='POSKI' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_WBS//740'])");
                                    //flowTracker.IDOCDocNum= xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_WBS//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    //flowTracker.IntegrationPoint="SAP-SMAX_WBS";
                                    //flowTracker.CommitSAPToServiceMaxActivity();
                                    
                                    DocNum = xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_WBS//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_WBS//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    varIntegrationPoint = "SAP-SMAX_WBS";
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("899f7f9b-e85b-484d-8218-4858da433fd6")]
                                    construct WBSzsmWBS
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e71d27b8-029a-4eae-8e0b-ea97fff20065")]
                                        WBSzsmWBS = xmlDoc;
                                        
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : ZSM_WBS message has been constructed",token));
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("0d5e9353-24e5-496c-88a1-5bb57c4f61cc")]
                                    construct msgUpsertRequest
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e8a137a3-3680-487d-92d4-2a4ca5b9d013")]
                                        transform (msgUpsertRequest.parameters) = Visy.Middleware.SAP.ServiceMax.Maps.WBS_To_Upsert (WBSzsmWBS);
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3df5b47e-a063-4f1a-8cc2-b8eccda886fa")]
                                        msgUpsertRequest(WCF.SecurityMode)="Transport";
                                        msgUpsertRequest(WCF.TransportClientCredentialType) = "None";
                                        msgUpsertRequest(WCF.Action)="";
                                        msgUpsertRequest(WCF.OutboundCustomHeaders) = "<headers><SessionHeader xmlns='urn:enterprise.soap.sforce.com'><sessionId>" + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + "</sessionId></SessionHeader></headers>";
                                        
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)="WCF-BasicHttp";
                                        varArchiveFileName = "WBSZSM_" + token.ToString();
                                        
                                        xmlDocForBAM = msgUpsertRequest.parameters;
                                    }
                                }
                                else if (CREDNOTE)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("3c7fddb7-4b9d-4c6e-a1cf-bb4aacbf19d8")]
                                    //flowTracker.ExternalId=xpath(inXmlMsg,"string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='ZSM_CREDNTE000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_CREDNOTE//740']/*[local-name()='CREDIT_DOCUMENTNO_C' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_CREDNOTE//740'])");
                                    //flowTracker.IDOCDocNum= xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_CREDNOTE//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    //flowTracker.IntegrationPoint="SAP-SMAX_CRED";
                                    //flowTracker.CommitSAPToServiceMaxActivity();
                                    
                                    DocNum = xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_CREDNOTE//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_CREDNOTE//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    varIntegrationPoint = "SAP-SMAX_CRED";
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b586af4d-c284-4e13-b6ed-b7d18f1dc1a6")]
                                    construct CREDITNOTE
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("bec35f9d-c9a1-4dae-a8c3-fe2a6f077e19")]
                                        CREDITNOTE = xmlDoc;
                                        
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : CREDNOTE message has been constructed",token));
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("669c1679-97d1-4491-9458-a0e4c725ebd4")]
                                    construct msgUpsertRequest
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("02838aaa-8172-4089-adf9-8aeaa647ed21")]
                                        transform (msgUpsertRequest.parameters) = Visy.Middleware.SAP.ServiceMax.Maps.CREDNOTE_To_Upsert (CREDITNOTE);
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("e41d486c-835a-45e1-beef-1ea21745d279")]
                                        msgUpsertRequest(WCF.SecurityMode)="Transport";
                                        msgUpsertRequest(WCF.TransportClientCredentialType) = "None";
                                        msgUpsertRequest(WCF.Action)="";
                                        msgUpsertRequest(WCF.OutboundCustomHeaders) = "<headers><SessionHeader xmlns='urn:enterprise.soap.sforce.com'><sessionId>" + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + "</sessionId></SessionHeader></headers>";
                                        
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)="WCF-BasicHttp";
                                        varArchiveFileName = "CREDNOTE_" + token.ToString();
                                        xmlDocForBAM = msgUpsertRequest.parameters;
                                    }
                                }
                                else if (STKLOC)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1b6df213-8ff5-4bd8-9ee0-8a960abef3db")]
                                    //flowTracker.ExternalId=xpath(inXmlMsg,"string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='ZSM_STKLC000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_STKLOC//740']/*[local-name()='STORLOC' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_STKLOC//740'])");
                                    //flowTracker.IDOCDocNum= xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_STKLOC//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    //flowTracker.IntegrationPoint="SAP-SMAX_LOC";
                                    //flowTracker.CommitSAPToServiceMaxActivity();
                                    
                                    DocNum = xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_STKLOC//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_STKLOC//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    varIntegrationPoint = "SAP-SMAX_LOC";
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f116492e-529e-480e-8e88-cf964f05a09d")]
                                    construct STOCKLOC
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4401d432-28a4-4af3-8412-58afb515b7a5")]
                                        STOCKLOC = xmlDoc;
                                        
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : STOCKLOC message has been constructed",token));
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7452865a-c021-4714-b095-801d2b48320d")]
                                    construct msgUpsertRequest
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("75cdf0b7-850b-434f-807d-b87868901933")]
                                        transform (msgUpsertRequest.parameters) = Visy.Middleware.SAP.ServiceMax.Maps.STKLOC_To_Upsert (STOCKLOC);
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("03f15f2e-e894-4a6f-9e75-8b2cd5f27665")]
                                        msgUpsertRequest(WCF.SecurityMode)="Transport";
                                        msgUpsertRequest(WCF.TransportClientCredentialType) = "None";
                                        msgUpsertRequest(WCF.Action)="";
                                        msgUpsertRequest(WCF.OutboundCustomHeaders) = "<headers><SessionHeader xmlns='urn:enterprise.soap.sforce.com'><sessionId>" + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + "</sessionId></SessionHeader></headers>";
                                        
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)="WCF-BasicHttp";
                                        varArchiveFileName = "STKLOC_" + token.ToString();
                                        
                                        xmlDocForBAM = msgUpsertRequest.parameters;
                                    }
                                }
                                else if (PRICE)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("575ec468-3c08-4476-a32e-4c1496daa679")]
                                    //flowTracker.ExternalId=xpath(inXmlMsg,"string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='ZSM_PRICE_SEG000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PRICE//740']/*[local-name()='MATNR' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PRICE//740'])");
                                    //flowTracker.IDOCDocNum= xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PRICE//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    //flowTracker.IntegrationPoint="SAP-SMAX_PRICE";
                                    //flowTracker.CommitSAPToServiceMaxActivity();
                                    
                                    DocNum = xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PRICE//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PRICE//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    varIntegrationPoint = "SAP-SMAX_PRICE";
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a38f7647-b290-4216-a4e5-762d7d9fc741")]
                                    construct PartPRICE
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a0bc4f99-1073-47c2-8413-fba896269c11")]
                                        PartPRICE = xmlDoc;
                                        
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : PRICE message has been constructed",token));
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("f282c675-a39b-4691-8654-cb7ddba2abff")]
                                    construct msgUpsertRequest
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("73f1bad2-2f08-4af6-a897-8bf3b55d3a86")]
                                        transform (msgUpsertRequest.parameters) = Visy.Middleware.SAP.ServiceMax.Maps.PRICE_To_Upsert (PartPRICE);
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("dc5c1649-493b-4123-b75a-fcd75e3fcc68")]
                                        msgUpsertRequest(WCF.SecurityMode)="Transport";
                                        msgUpsertRequest(WCF.TransportClientCredentialType) = "None";
                                        msgUpsertRequest(WCF.Action)="";
                                        msgUpsertRequest(WCF.OutboundCustomHeaders) = "<headers><SessionHeader xmlns='urn:enterprise.soap.sforce.com'><sessionId>" + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + "</sessionId></SessionHeader></headers>";
                                        
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)="WCF-BasicHttp";
                                        varArchiveFileName = "ZSMPRICE_" + token.ToString();
                                        
                                        xmlDocForBAM = msgUpsertRequest.parameters;
                                    }
                                }
                                else if (ZSMPRSTATUS)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("4532509f-0b62-4438-be2b-8735b163f1c6")]
                                    //flowTracker.ExternalId=xpath(inXmlMsg,"string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='ZSM_PUR_REQ_STATUS000' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PR_STATUS//740']/*[local-name()='LINE_ITEM_EXTERNAL_ID' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PR_STATUS//740'])");
                                    //flowTracker.IDOCDocNum= xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PR_STATUS//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    //flowTracker.IntegrationPoint="SAP-SMAX_PR";
                                    //flowTracker.CommitSAPToServiceMaxActivity();
                                    
                                    DocNum = xpath(inXmlMsg, "string(/*[local-name()='Receive' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='idocData' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Idoc/3/ZSM_PR_STATUS//740/Receive']/*[local-name()='EDI_DC40' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/3/ZSM_PR_STATUS//740']/*[local-name()='DOCNUM' and namespace-uri()='http://Microsoft.LobServices.Sap/2007/03/Types/Idoc/Common/'])");
                                    varIntegrationPoint  = "SAP-SMAX_PR";
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("db000ef4-246e-4beb-b348-90d63b7a8581")]
                                    construct PRSTATUS
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3ca3df88-f9f4-461c-b438-5e3f3f5a31bf")]
                                        PRSTATUS = xmlDoc;
                                        
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : PRSTATUS message has been constructed",token));
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c0c46b60-3190-415c-a3df-753efbc77c36")]
                                    construct msgUpsertRequest
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("80e1d002-b9b4-400b-ba55-525dd19269ac")]
                                        transform (msgUpsertRequest.parameters) = Visy.Middleware.SAP.ServiceMax.Maps.PRSTATUS_To_Upsert (PRSTATUS);
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("dc20c62a-ed5b-486e-a7c5-0c2ae547900a")]
                                        msgUpsertRequest(WCF.SecurityMode)="Transport";
                                        msgUpsertRequest(WCF.TransportClientCredentialType) = "None";
                                        msgUpsertRequest(WCF.Action)="";
                                        msgUpsertRequest(WCF.OutboundCustomHeaders) = "<headers><SessionHeader xmlns='urn:enterprise.soap.sforce.com'><sessionId>" + Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.SessionId + "</sessionId></SessionHeader></headers>";
                                        
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.Address) = Visy.Middleware.SAP.ServiceMax.Components.SessionDetails.ServerUrl;
                                        Port_SendUpsert(Microsoft.XLANGs.BaseTypes.TransportType)="WCF-BasicHttp";
                                        varArchiveFileName = "ZSMPRSTATUS_" + token.ToString();
                                        
                                        xmlDocForBAM = msgUpsertRequest.parameters;
                                    }
                                }
                                else 
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("56a9444f-b224-4e66-af08-75fe359f2f6c")]
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Messaeg Type not Found , exception will be thrown",token));
                                    expObj = new System.Exception("Messaeg Type not Found , exception will be thrown");
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("fe338f75-c0db-4889-b0fd-b46425e8d350")]
                                    throw expObj;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("e6320e99-c8ec-4529-8e76-527cc1607291")]
                                construct msgUpsertResponse
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c1f8702e-67b9-4c3b-9588-eb0d0ec5737d")]
                                    xmlDoc = new System.Xml.XmlDocument();
                                    xmlDoc.LoadXml(@"<upsertResponse xmlns='urn:enterprise.soap.sforce.com'><result><created></created><id></id><success></success></result></upsertResponse>");
                                    msgUpsertResponse.parameters=xmlDoc;
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Upsert Response message has been constructed",token));
                                    
                                    expObj = new System.Exception();
                                    isException = false;
                                    IsSoapExp = false;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("f3d61d81-33d9-4c8a-acba-95cf607c1931")]
                                construct msgArchive
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("b2889a5a-62d6-4d4e-8af4-9aaec0a03ffd")]
                                    msgArchive = msgUpsertRequest.parameters;
                                    msgArchive(FILE.ReceivedFileName) = varArchiveFileName;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("51a764a1-cc6e-4c10-ac95-93c449b0c428")]
                                send (port_SalesForceInboundArchive.Archive, msgArchive);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("29d1b6e1-c129-4bcb-8049-a7496071afb7")]
                                while (retryCount <= retryLimit)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1481cf60-63ad-4f86-ba2a-901c6b7da6b3")]
                                    scope
                                    {
                                        body
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("11c6145a-462a-4150-90a9-94811ea43ae9")]
                                            send (Port_SendUpsert.Operation_SendUpsert, msgUpsertRequest);
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8434eca0-8114-401c-ba26-51b0827fce45")]
                                            receive (Port_SendUpsert.Operation_SendUpsert, msgUpsertResponse);
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0183d37f-c6c9-432a-bf48-1607c013b696")]
                                            send (port_ArchiveResponse.Archive, msgUpsertResponse);
                                        }
                                        exceptions
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("3349f621-6186-4be1-8032-e1ed976f2e14")]
                                            catch (System.Exception excp)
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("71efd030-2941-4cc0-ad61-74a724907b77")]
                                                expObj = new System.Exception();
                                                expObj = excp;
                                                isException = true;
                                                IsSoapExp = false;
                                                //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} :Error in Transmitting the message.{1}; Retry count:"+retryCount.ToString(), token, excp.ToString()));
                                            }
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("9f4087c4-3cd8-495e-93b8-b50bfb724a20")]
                                            catch (Port_SendUpsert.Operation_SendUpsert.GenericSoapFault soapExc)
                                            {
                                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("994b16c6-a35b-4f6a-bbac-f3c531bff53c")]
                                                strException = xpath(soapExc, "string(/*[local-name()='Fault' and namespace-uri()='http://schemas.xmlsoap.org/soap/envelope/']/*[local-name()='faultstring' and namespace-uri()=''])");
                                                expObj = new System.Exception("ServiceMax returned an error message"+strException);
                                                isException = true;
                                                IsSoapExp = true;
                                                //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} :A SOAP exception has occured within the Upsert call. Error Description: "+ strException, token));
                                            }
                                        }
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("1ac6fd12-0850-4aca-afa4-827b74638508")]
                                    xmlDoc = new System.Xml.XmlDocument();
                                    xmlDoc = msgUpsertResponse.parameters;
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Upsert Response - {1}", token, xmlDoc.InnerXml));
                                    resultCount = xpath(msgUpsertResponse.parameters, "count(/*[local-name()='upsertResponse' and namespace-uri()='urn:enterprise.soap.sforce.com']/*[local-name()='result' and namespace-uri()='urn:enterprise.soap.sforce.com'])");
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Upsert Response - Result Count: {1}", token, resultCount.ToString()));
                                    
                                    resultCounter = 1;
                                    resultCounterStr = "1";
                                    
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("587a576c-a0af-4bb7-9099-753073f80703")]
                                    while (resultCounter <= resultCount)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("cb687316-6d31-4cfc-a43d-a741e4585f93")]
                                        //upsertResp = xpath(msgUpsertResponse.parameters, "string(/*[local-name()='upsertResponse' and namespace-uri()='urn:enterprise.soap.sforce.com']/*[local-name()='result' and namespace-uri()='urn:enterprise.soap.sforce.com']/*[local-name()='success' and namespace-uri()='urn:enterprise.soap.sforce.com'][" + resultCounterStr + "]/text())");
                                        
                                        upsertResp = xpath(msgUpsertResponse.parameters, "string(/*[local-name()='upsertResponse' and namespace-uri()='urn:enterprise.soap.sforce.com']/*[local-name()='result' and namespace-uri()='urn:enterprise.soap.sforce.com'][" + resultCounterStr + "]/*[local-name()='success' and namespace-uri()='urn:enterprise.soap.sforce.com'])");
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Upsert Result for Count {1} :" + upsertResp, token, resultCounter.ToString()));
                                        if(upsertResp == "false")
                                        {
                                        
                                            resultCounter = resultCount + 1;
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} Within IF:", token));
                                        }
                                        else
                                        {
                                            resultCounter = resultCounter + 1;
                                            resultCounterStr = resultCounter.ToString();
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} Within ELSE; resultCounterStr: "+ resultCounterStr, token));
                                        }
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("2095f832-0971-471c-9bf5-f46a5768bd9b")]
                                    if ((retryCount >= retryLimit && isException == true))
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b968cb6e-a29a-4527-be0a-1b9c2f7746e4")]
                                        retryCount = retryLimit + 1;
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : An error occurred during the Upsert call. Exiting the loop",token));
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("5590ee09-533a-4d94-98bd-069c549c2bf2")]
                                        throw expObj;
                                    }
                                    else if ((isException == false) && (upsertResp == "true"))
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("762a020e-6d3f-4baf-9f4b-56ddd5b16b15")]
                                        xmlDoc = new System.Xml.XmlDocument();
                                        xmlDoc = msgUpsertResponse.parameters;
                                        //flowTracker.IsError = "False";
                                        //flowTracker.IsRetrying = "False";
                                        //flowTracker.IsSentToServiceMax = "Success";
                                        //flowTracker.IsEmailSent = "False";
                                        //flowTracker.IsMessageSuspended = "False";
                                        //flowTracker.SentToServiceMaxTime = System.DateTime.Now.ToString();
                                        //flowTracker.ServiceMaxRespMsg = xmlDoc.OuterXml;
                                        //flowTracker.CommitSAPToServiceMaxActivity();
                                        //flowTracker.EndSAPToServiceMaxActivity();
                                        retryCount = retryLimit + 1;
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Upsert successfully completed; Upsert response: " + xmlDoc.OuterXml.ToString(), token));
                                        
                                    }
                                    else if (upsertResp == "false")
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("b78620b1-ad17-466b-8c19-8f5a96be7428")]
                                        construct xmlDocMsg
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("34928b44-bfb4-419c-bad0-32f9fefd6b86")]
                                            xmlDocMsg = msgUpsertResponse.parameters;
                                        }
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("56691e47-2bc6-4cf4-8150-3d738906ff32")]
                                        retryCount = retryLimit + 1;
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Upsert returned a failure response. "+xmlDocMsg.OuterXml,token));
                                        expObj = new System.Exception(System.String.Format("ServiceMax returned an error message; <xmp>{0}</xmp>​ ", xmlDocMsg.OuterXml));
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("bc0cb438-1508-478a-ad9b-496048ac1bc0")]
                                        throw expObj;
                                    }
                                    else if (IsSoapExp == true)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("eabc8096-de1a-449b-ab5d-71259de076fe")]
                                        retryCount = retryLimit + 1;
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : A SOAP exception occurred during the Upsert call. Exiting the loop",token));
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("5aaad03f-a96e-4bcf-965c-69766e5eaca0")]
                                        throw expObj;
                                    }
                                    else 
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4e868ab2-93a5-48a8-a127-4ba5ab66a811")]
                                        retryCount = retryCount +1;
                                        isException =false;
                                        //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Error in transmitting the upsert request; Waiting to retry",token));
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2c8a2915-fe10-4bb8-ae4b-36755069ca96")]
                                        delay new System.TimeSpan(0,retryInterval,0);
                                    }
                                }
                            }
                        }
                        exceptions
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("0bf997e2-11e2-48cf-b00e-eab12dc0cd90")]
                            catch (System.Exception AllExcp)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("6fda8544-af74-47e2-8396-f7a96a2dcb1d")]
                                errorMsg = AllExcp.ToString();
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("969037b1-0377-404a-b3dd-5d08cf3c4412")]
                                construct msgFailedInterchange
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("8ffcdd0f-b80e-4f59-becf-891829d49489")]
                                    msgFailedInterchange = inXmlMsg;
                                    msgFailedInterchange(Visy.Middleware.SAP.ServiceMax.Schemas.ErrorDescription) = errorMsg;
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Sending Mesasage to Suspend Orchestration",token));
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("ed084577-bb5e-4db9-ba85-0bfb8f84e965")]
                                construct msgEmailException
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("d2c852a9-d8a2-46e7-bbe7-6092a4c84ca2")]
                                    //Build HTML Message body
                                    strbuilder_MsgBody = new System.Text.StringBuilder();
                                    strbuilder_MsgBody.AppendLine("<html>");
                                    strbuilder_MsgBody.AppendLine("<head>");
                                    strbuilder_MsgBody.AppendLine("</head>");
                                    strbuilder_MsgBody.AppendLine("<body>");
                                    strbuilder_MsgBody.AppendLine("<p><B>SAPToSMAX Orchestration Error</B></p>");
                                    
                                    strbuilder_MsgBody.AppendLine("<table>");
                                    
                                    strbuilder_MsgBody.AppendLine("<tr><td>Date of Error:</td><td>");
                                    strbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortDateString());
                                    strbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    strbuilder_MsgBody.AppendLine("<tr><td>Time of Error:</td><td>");
                                    strbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());
                                    strbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    strbuilder_MsgBody.AppendLine("<tr><td>Integration Point:</td><td>");
                                    strbuilder_MsgBody.AppendLine(varIntegrationPoint);
                                    strbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    strbuilder_MsgBody.AppendLine("<tr><td>Exception:</td><td>");
                                    strbuilder_MsgBody.AppendLine(errorMsg);
                                    strbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    strbuilder_MsgBody.AppendLine("<tr><td>IDOC DocNum of Incoming Message:</td><td>");
                                    strbuilder_MsgBody.AppendLine(DocNum);
                                    strbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    strbuilder_MsgBody.AppendLine("<tr><td>Processing Server:</td><td>");
                                    strbuilder_MsgBody.AppendLine(System.Environment.MachineName);
                                    strbuilder_MsgBody.AppendLine("</td></tr>");
                                    
                                    strbuilder_MsgBody.AppendLine("</table>");
                                    
                                    strbuilder_MsgBody.AppendLine("</body>");
                                    strbuilder_MsgBody.AppendLine("</html>");
                                    
                                    //Set Email Properties
                                    msgEmailException.msgBody = new Visy.Middleware.SAP.ServiceMax.Components.RawString(strbuilder_MsgBody.ToString());
                                    msgEmailException.msgBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                    msgEmailException(SMTP.Subject) = "SAPToSMAX Orchestration failed in BizTalk Server: " + System.Environment.MachineName;
                                    
                                    msgEmailException(SMTP.From) = "bt2016@visy.com.au";
                                    msgEmailException(SMTP.EmailBodyFileCharset) = "UTF-8";
                                    //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Created SMTP Mail Message",token));
                                    
                                    
                                    
                                    
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("0e9baf56-7949-40eb-a543-1bb597814fdb")]
                                send (Port_SendMail.Email, msgEmailException);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("2db2feed-842e-4cab-97ef-7099d015e125")]
                                send (Port_SendSusMsg.Operation_SendSusMsg, msgFailedInterchange);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("07af80c4-063a-4547-89f2-64159dc25e6a")]
                                terminate "Service Max Part Update terminated due to error:" + AllExcp.Message;;
                            }
                        }
                    }
                }
                exceptions
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("aab0b95f-1e06-4c51-a629-8e95cf896ee6")]
                    catch (System.Exception sysex)
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("9c9222f1-f0bf-43d0-bd9f-9d7d3dc817e2")]
                        errorMsg = sysex.ToString();
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3c8d3346-95af-4d35-afac-9a46ba09da9c")]
                        construct msgEmailException
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("1eb1b7d9-dfcf-4667-8d4c-cec7c9395c0f")]
                            //Build HTML Message body
                            strbuilder_MsgBody = new System.Text.StringBuilder();
                            strbuilder_MsgBody.AppendLine("<html>");
                            strbuilder_MsgBody.AppendLine("<head>");
                            strbuilder_MsgBody.AppendLine("</head>");
                            strbuilder_MsgBody.AppendLine("<body>");
                            strbuilder_MsgBody.AppendLine("<p><B>SAPToSMAX Orchestration Error</B></p>");
                            
                            strbuilder_MsgBody.AppendLine("<table>");
                            
                            strbuilder_MsgBody.AppendLine("<tr><td>Date of Error:</td><td>");
                            strbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortDateString());
                            strbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            strbuilder_MsgBody.AppendLine("<tr><td>Time of Error:</td><td>");
                            strbuilder_MsgBody.AppendLine(System.DateTime.Now.ToShortTimeString());
                            strbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            strbuilder_MsgBody.AppendLine("<tr><td>Integration Point:</td><td>");
                            strbuilder_MsgBody.AppendLine(varIntegrationPoint);
                            strbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            strbuilder_MsgBody.AppendLine("<tr><td>Exception:</td><td>");
                            strbuilder_MsgBody.AppendLine(errorMsg);
                            strbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            strbuilder_MsgBody.AppendLine("<tr><td>IDOC DocNum of Incoming Message:</td><td>");
                            strbuilder_MsgBody.AppendLine(DocNum);
                            strbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            strbuilder_MsgBody.AppendLine("<tr><td>Processing Server:</td><td>");
                            strbuilder_MsgBody.AppendLine(System.Environment.MachineName);
                            strbuilder_MsgBody.AppendLine("</td></tr>");
                            
                            strbuilder_MsgBody.AppendLine("</table>");
                            
                            strbuilder_MsgBody.AppendLine("</body>");
                            strbuilder_MsgBody.AppendLine("</html>");
                            
                            //Set Email Properties
                            msgEmailException.msgBody = new Visy.Middleware.SAP.ServiceMax.Components.RawString(strbuilder_MsgBody.ToString());
                            msgEmailException.msgBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                            msgEmailException(SMTP.Subject) = "SAPToSMAX Orchestration failed in BizTalk Server: " + System.Environment.MachineName;
                            
                            msgEmailException(SMTP.From) = "bt2016@visy.com.au";
                            msgEmailException(SMTP.EmailBodyFileCharset) = "UTF-8";
                            //Microsoft.BizTalk.CAT.BestPractices.Framework.Instrumentation.TraceManager.WorkflowComponent.TraceInfo(System.String.Format("{0} : Created SMTP Mail Message",token));
                            
                            
                            
                            
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("02aac028-a78b-40cc-8caf-8a30ec6f3cd6")]
                        send (Port_SendMail.Email, msgEmailException);
                    }
                }
            }
        }
    }
}

