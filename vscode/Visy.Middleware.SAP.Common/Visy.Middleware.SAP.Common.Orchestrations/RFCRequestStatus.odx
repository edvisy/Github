#if __DESIGNER_DATA
#error Do not define __DESIGNER_DATA.
<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<om:MetaModel MajorVersion="1" MinorVersion="3" Core="2b131234-7959-458d-834f-2dc0769ce683" ScheduleModel="66366196-361d-448d-976f-cab5e87496d2" xmlns:om="http://schemas.microsoft.com/BizTalk/2003/DesignerData">
    <om:Element Type="Module" OID="67df3509-ec1b-4d85-ae49-f798d1d0552b" LowerBound="1.1" HigherBound="412.1">
        <om:Property Name="ReportToAnalyst" Value="True" />
        <om:Property Name="Name" Value="Visy.Middleware.SAP.Common.Orchestrations" />
        <om:Property Name="Signal" Value="False" />
        <om:Element Type="PortType" OID="345adb0a-900b-4d75-b781-330eaa57d289" ParentLink="Module_PortType" LowerBound="8.1" HigherBound="15.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SndTechAlertPortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="be4528c3-56ca-4aaf-b9d1-956991103bef" ParentLink="PortType_OperationDeclaration" LowerBound="10.1" HigherBound="14.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SndTechAlertOperation" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="77281fcd-55ba-4863-9d53-358c74626890" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="12.13" HigherBound="12.23">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.Common.Orchestrations.EMailType8" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="SndTechAlertRequest" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="f09bdd42-01ab-4185-a84f-32f8f21139fc" ParentLink="Module_PortType" LowerBound="15.1" HigherBound="22.1">
            <om:Property Name="Synchronous" Value="True" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="sndSAPPostSResponsePortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="c89e8025-e5c8-4021-ac2a-0b458c62e68c" ParentLink="PortType_OperationDeclaration" LowerBound="17.1" HigherBound="21.1">
                <om:Property Name="OperationType" Value="RequestResponse" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="1028a38a-99ae-4be0-b142-13b004080b58" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="19.13" HigherBound="19.107">
                    <om:Property Name="Ref" Value="Visy.Middleware.Common.Schemas.SAP.Z_BIZTALK_GET_IDOC_STATUS.Z_BIZTALK_GET_IDOC_STATUS_Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="MessageRef" OID="f1314eb6-3dea-4bfc-acb3-0700e92a988f" ParentLink="OperationDeclaration_ResponseMessageRef" LowerBound="19.109" HigherBound="19.204">
                    <om:Property Name="Ref" Value="Visy.Middleware.Common.Schemas.SAP.Z_BIZTALK_GET_IDOC_STATUS.Z_BIZTALK_GET_IDOC_STATUS_Response" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Response" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="2b2dc23c-1458-482d-b8b7-b981576f0e52" ParentLink="Module_PortType" LowerBound="22.1" HigherBound="29.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SAPResponseSavePortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="abedd5b4-60d3-4ce5-93c9-0fde3629fbb2" ParentLink="PortType_OperationDeclaration" LowerBound="24.1" HigherBound="28.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="8ab9a8cf-33d3-4d55-ae95-2297284ffdab" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="26.13" HigherBound="26.35">
                    <om:Property Name="Ref" Value="System.Xml.XmlDocument" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="397ec205-942b-4cb5-8581-e30a79e9dce6" ParentLink="Module_PortType" LowerBound="29.1" HigherBound="36.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SndSaveRFCResponsePortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="836d0e76-8f85-4540-bfaa-42cd5b14c051" ParentLink="PortType_OperationDeclaration" LowerBound="31.1" HigherBound="35.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SndSaveRFCResponseOperation" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="MessageRef" OID="6531e230-4bc8-46f4-9e96-4ac09c2c696e" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="33.13" HigherBound="33.63">
                    <om:Property Name="Ref" Value="Visy.Middleware.Common.Schemas.SAP.SAPAlertContext" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="SndSaveRFCResponseRequest" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="6517e6a3-db22-44cf-8c73-ea19d4610d58" ParentLink="Module_PortType" LowerBound="36.1" HigherBound="43.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="ReceiveAlert_PortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="386df887-ccfd-4f8c-8206-1b1b67b44de3" ParentLink="PortType_OperationDeclaration" LowerBound="38.1" HigherBound="42.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="945342fc-7d61-4959-9814-8a7cc41688a6" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="40.13" HigherBound="40.63">
                    <om:Property Name="Ref" Value="Visy.Middleware.Common.Schemas.SAP.SAPAlertContext" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="1ad280b9-e8ac-4ef6-b091-81d533d49890" ParentLink="Module_PortType" LowerBound="43.1" HigherBound="50.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SendTechAlert_PortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="4e284ddc-1be1-4317-b99e-5bd596f4229a" ParentLink="PortType_OperationDeclaration" LowerBound="45.1" HigherBound="49.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="9ed39485-5f42-4332-943a-850ced7f05fa" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="47.13" HigherBound="47.23">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.Common.Orchestrations.EMailType8" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="PortType" OID="b859268e-b419-4792-b603-22f696b3dbf4" ParentLink="Module_PortType" LowerBound="50.1" HigherBound="57.1">
            <om:Property Name="Synchronous" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="SendErrorResponse_PortType" />
            <om:Property Name="Signal" Value="False" />
            <om:Element Type="OperationDeclaration" OID="6a6e4615-9cec-4ad0-a4c5-440e4bce9d77" ParentLink="PortType_OperationDeclaration" LowerBound="52.1" HigherBound="56.1">
                <om:Property Name="OperationType" Value="OneWay" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="Operation_1" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="MessageRef" OID="733d441b-706e-4e8b-ad1c-b95bfa3154a7" ParentLink="OperationDeclaration_RequestMessageRef" LowerBound="54.13" HigherBound="54.23">
                    <om:Property Name="Ref" Value="Visy.Middleware.SAP.Common.Orchestrations.EMailType8" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Request" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="ServiceDeclaration" OID="f406360c-6aee-41bb-87ca-332b6aa8c69d" ParentLink="Module_ServiceDeclaration" LowerBound="57.1" HigherBound="411.1">
            <om:Property Name="InitializedTransactionType" Value="False" />
            <om:Property Name="IsInvokable" Value="False" />
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="False" />
            <om:Property Name="Name" Value="RFCRequestStatus" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="VariableDeclaration" OID="68326d2a-3245-483e-956b-a5173fe47fea" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="75.1" HigherBound="76.1">
                <om:Property Name="UseDefaultConstructor" Value="True" />
                <om:Property Name="Type" Value="System.Text.StringBuilder" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="msgbody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="aef65a57-1195-4be2-96b8-2e191dbc2a67" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="76.1" HigherBound="77.1">
                <om:Property Name="InitialValue" Value="0" />
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="iAlertDelay" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c15ca743-7b4d-47b2-9ca2-d774cbda03bd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="77.1" HigherBound="78.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="iAlertLoopCount" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="2333cba6-52b1-4a06-9abc-d2b8a3d03251" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="78.1" HigherBound="79.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.Int32" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="iAlertLoopLimit" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f4bba727-b836-441b-b573-9e1e03bdf16a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="79.1" HigherBound="80.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sTemp" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="20cdf135-d664-4f3e-8e28-2356bdc2ec23" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="80.1" HigherBound="81.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sApplicationName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9af44d02-3018-40d7-b48c-c87071dda22e" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="81.1" HigherBound="82.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sBiztalkID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="3887cff3-079e-4742-a883-5a329150db5a" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="82.1" HigherBound="83.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sContextID" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="daf99776-a71f-4c93-b0fb-8120e86e1071" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="83.1" HigherBound="84.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sCustomerCode" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="f3199dff-3d4d-4b4b-950a-031cf9c35ff9" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="84.1" HigherBound="85.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sOutputFileName" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="34240e33-9589-4618-8dda-0d3cb6bb897b" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="85.1" HigherBound="86.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sAlertBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="9fd96098-ae38-4993-93f0-c9016958fcc4" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="86.1" HigherBound="87.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sStatusString" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="0c51018a-02e1-4281-85f1-7f680dc76c13" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="87.1" HigherBound="88.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="c2e18cdc-9fc4-488c-a3f6-b6dca361a6bf" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="88.1" HigherBound="89.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sDocNum" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="6272fec0-838d-4c41-9ebc-f8aaf3953dcd" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="89.1" HigherBound="90.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sIDocStatus" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="VariableDeclaration" OID="303623ec-a52d-46c0-9c2f-d34439a7e92f" ParentLink="ServiceDeclaration_VariableDeclaration" LowerBound="90.1" HigherBound="91.1">
                <om:Property Name="UseDefaultConstructor" Value="False" />
                <om:Property Name="Type" Value="System.String" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sIDocStatusDesc" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="534d304e-a37d-4424-ba74-b81eb77d8212" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="70.1" HigherBound="71.1">
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Common.Orchestrations.EMailType8" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="EMail" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="3190b18c-5082-4357-be2d-b46a1c16bc68" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="71.1" HigherBound="72.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.Z_BIZTALK_GET_IDOC_STATUS.Z_BIZTALK_GET_IDOC_STATUS_Request" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="RFCIDOCStatusRequest" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="07946fac-ecdc-46c6-8c49-bf0b1764ed48" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="72.1" HigherBound="73.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.Z_BIZTALK_GET_IDOC_STATUS.Z_BIZTALK_GET_IDOC_STATUS_Response" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="RFCIDOCStatusResponse" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="2447bcee-471e-40ca-b2aa-a602b1e5f895" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="73.1" HigherBound="74.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.SAPAlertContext" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="AlertMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="MessageDeclaration" OID="350a3971-b5fe-458d-999a-2ade80e28899" ParentLink="ServiceDeclaration_MessageDeclaration" LowerBound="74.1" HigherBound="75.1">
                <om:Property Name="Type" Value="Visy.Middleware.Common.Schemas.SAP.SAPAlertContext" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="UpdatedAlertMessage" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
            <om:Element Type="ServiceBody" OID="b5437fa2-a666-4b7d-a063-c6ec2a716711" ParentLink="ServiceDeclaration_ServiceBody">
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="Receive" OID="8149db7c-6416-4295-9be5-ee959342d4ff" ParentLink="ServiceBody_Statement" LowerBound="93.1" HigherBound="109.1">
                    <om:Property Name="Activate" Value="True" />
                    <om:Property Name="PortName" Value="ReceiveAlert_Port" />
                    <om:Property Name="MessageName" Value="AlertMessage" />
                    <om:Property Name="OperationName" Value="Operation_1" />
                    <om:Property Name="OperationMessageName" Value="Request" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Receive_AlertMessage" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
                <om:Element Type="Construct" OID="a48a455b-0bfe-44ad-848a-9c02f900fd1b" ParentLink="ServiceBody_Statement" LowerBound="109.1" HigherBound="115.1">
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Construct RFC Request" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="Transform" OID="d1cee42f-447d-4b6d-8499-33259dd170b2" ParentLink="ComplexStatement_Statement" LowerBound="112.1" HigherBound="114.1">
                        <om:Property Name="ClassName" Value="Visy.Middleware.SAP.Common.Maps.CreateRFCRequest" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="CreateRFCRequest" />
                        <om:Property Name="Signal" Value="False" />
                        <om:Element Type="MessagePartRef" OID="f583b8ce-4865-4616-aad6-f87ef3f6f120" ParentLink="Transform_OutputMessagePartRef" LowerBound="113.28" HigherBound="113.48">
                            <om:Property Name="MessageRef" Value="RFCIDOCStatusRequest" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="MessagePartReference_2" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessagePartRef" OID="57128af7-3280-4f26-8646-a0fae273b86c" ParentLink="Transform_InputMessagePartRef" LowerBound="113.102" HigherBound="113.114">
                            <om:Property Name="MessageRef" Value="AlertMessage" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="MessagePartReference_1" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="MessageRef" OID="3b676e75-94a5-4461-abd2-0252dd2e2bea" ParentLink="Construct_MessageRef" LowerBound="110.23" HigherBound="110.43">
                        <om:Property Name="Ref" Value="RFCIDOCStatusRequest" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="VariableAssignment" OID="a3dac7d3-634e-463f-9281-b59dc34cb7af" ParentLink="ServiceBody_Statement" LowerBound="115.1" HigherBound="127.1">
                    <om:Property Name="Expression" Value="//DELAY and ALERT PARAMETERS&#xD;&#xA;iAlertDelay = System.Int32.Parse(Visy.Middleware.Components.Utilities.AppSettingsReader.retrieveValue(&quot;RSPAlertTimeout&quot;) );&#xD;&#xA;iAlertLoopCount = 1;&#xD;&#xA;iAlertLoopLimit = 3;&#xD;&#xA;&#xD;&#xA;sApplicationName = AlertMessage.ApplicationCode;&#xD;&#xA;&#xD;&#xA;//BiztalkID and Parts from Message&#xD;&#xA;sBiztalkID = AlertMessage.BiztalkID;&#xD;&#xA;sCustomerCode = AlertMessage.CustomerNo;&#xD;&#xA;&#xD;&#xA;" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Initialise" />
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
                <om:Element Type="While" OID="54ab7c35-3895-4b58-b465-bd5de76c44c8" ParentLink="ServiceBody_Statement" LowerBound="127.1" HigherBound="396.1">
                    <om:Property Name="Expression" Value="iAlertLoopCount &lt;= iAlertLoopLimit" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="ResponseWaitRetry" />
                    <om:Property Name="Signal" Value="False" />
                    <om:Element Type="Delay" OID="8f33c5b9-63f6-46c3-9657-6d88d78ddd3b" ParentLink="ComplexStatement_Statement" LowerBound="130.1" HigherBound="132.1">
                        <om:Property Name="Timeout" Value="new System.TimeSpan(0,(iAlertDelay*iAlertLoopCount),0);" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Delay" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                    <om:Element Type="Send" OID="d05f5af7-c24e-4d2f-b6c5-c330d89c7c6b" ParentLink="ComplexStatement_Statement" LowerBound="132.1" HigherBound="134.1">
                        <om:Property Name="PortName" Value="sndSAPPostSResponsePort" />
                        <om:Property Name="MessageName" Value="RFCIDOCStatusRequest" />
                        <om:Property Name="OperationName" Value="Operation_1" />
                        <om:Property Name="OperationMessageName" Value="Request" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="RFCIDOCCRequest" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Receive" OID="48ab1c3d-5f9b-47b3-99db-45b0f951cc29" ParentLink="ComplexStatement_Statement" LowerBound="134.1" HigherBound="136.1">
                        <om:Property Name="Activate" Value="False" />
                        <om:Property Name="PortName" Value="sndSAPPostSResponsePort" />
                        <om:Property Name="MessageName" Value="RFCIDOCStatusResponse" />
                        <om:Property Name="OperationName" Value="Operation_1" />
                        <om:Property Name="OperationMessageName" Value="Response" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="RFCIDOCResponse" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="Decision" OID="501b4f0c-209b-44a4-91aa-f71f12b813f6" ParentLink="ComplexStatement_Statement" LowerBound="136.1" HigherBound="395.1">
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Check Status" />
                        <om:Property Name="Signal" Value="True" />
                        <om:Element Type="DecisionBranch" OID="0c2870f0-fbbb-47d2-b9db-9d901b5fec1f" ParentLink="ReallyComplexStatement_Branch" LowerBound="137.17" HigherBound="207.1">
                            <om:Property Name="Expression" Value="RFCIDOCStatusResponse.STATUS.STATUS == &quot;53&quot;" />
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="SUCCESS" />
                            <om:Property Name="Signal" Value="True" />
                            <om:Element Type="Scope" OID="c4c3560a-e0d8-48ce-a3ab-29bfc0e47533" ParentLink="ComplexStatement_Statement" LowerBound="139.1" HigherBound="173.1">
                                <om:Property Name="InitializedTransactionType" Value="True" />
                                <om:Property Name="IsSynchronized" Value="False" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="RSPUpdateStatTry" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="VariableAssignment" OID="31f7618a-5a95-45f6-8587-12148d1b1ea1" ParentLink="ComplexStatement_Statement" LowerBound="144.1" HigherBound="148.1">
                                    <om:Property Name="Expression" Value="//UPDATE STATS&#xD;&#xA;//Visy.WSS.Data.Reporting.Update(sBiztalkID,&quot;AC&quot;,sCustomerCode);&#xD;&#xA;sCustomerCode=sCustomerCode;&#xD;&#xA;" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="RSPUpdateStat" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="Catch" OID="08d9d954-47d9-4518-b92b-eb3dab59e5d7" ParentLink="Scope_Catch" LowerBound="151.1" HigherBound="171.1">
                                    <om:Property Name="ExceptionName" Value="ex3" />
                                    <om:Property Name="ExceptionType" Value="System.Exception" />
                                    <om:Property Name="IsFaultMessage" Value="False" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="RSPUpdateStatCatch" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Construct" OID="3e3d59bc-e1a3-4f53-a378-85a9c1a76d21" ParentLink="Catch_Statement" LowerBound="154.1" HigherBound="168.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="BuildAlertEMail" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="MessageAssignment" OID="17d158b7-91d4-4e13-b63b-4b4128c3324e" ParentLink="ComplexStatement_Statement" LowerBound="157.1" HigherBound="167.1">
                                            <om:Property Name="Expression" Value="//SET EMAIL PROPERTIES&#xD;&#xA;EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString(&quot;Error Getting Context or Updating Statistics&quot;);&#xD;&#xA;EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString(&quot;Exception encountered: &quot; + ex3.Message);&#xD;&#xA;&#xD;&#xA;EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;EMail(SMTP.Subject) = System.Environment.MachineName + &quot; - ALERT ERROR03 &quot;;&#xD;&#xA;EMail(SMTP.From) = &quot;biz06support@visy.com.au&quot;;&#xD;&#xA;EMail(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;EMail(SMTP.MessagePartsAttachments) = 1;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="Alert003Error" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="5cb084bc-d7f9-49c6-9c24-631f15d2ebbe" ParentLink="Construct_MessageRef" LowerBound="155.43" HigherBound="155.48">
                                            <om:Property Name="Ref" Value="EMail" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="1610e4d5-15c2-4520-b847-5119f320f22f" ParentLink="Catch_Statement" LowerBound="168.1" HigherBound="170.1">
                                        <om:Property Name="PortName" Value="SendTechAlert_Port" />
                                        <om:Property Name="MessageName" Value="EMail" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Alert003ErrorMsg" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                            <om:Element Type="Construct" OID="33158541-dfed-4eeb-9899-40d950915f05" ParentLink="ComplexStatement_Statement" LowerBound="173.1" HigherBound="204.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="AlertError" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="Transform" OID="2707998b-4675-454d-996f-e60efd80ac1a" ParentLink="ComplexStatement_Statement" LowerBound="176.1" HigherBound="178.1">
                                    <om:Property Name="ClassName" Value="Visy.Middleware.SAP.Common.Maps.UpdateAlertMessage" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="CreateErrorMessage" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="MessagePartRef" OID="0c20c109-8671-4d39-b55e-0ea9a4a3e919" ParentLink="Transform_OutputMessagePartRef" LowerBound="177.36" HigherBound="177.55">
                                        <om:Property Name="MessageRef" Value="UpdatedAlertMessage" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_6" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                    <om:Element Type="MessagePartRef" OID="fd67d121-b593-4e2f-bebc-f5a400fcca1b" ParentLink="Transform_InputMessagePartRef" LowerBound="177.111" HigherBound="177.123">
                                        <om:Property Name="MessageRef" Value="AlertMessage" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="MessagePartReference_5" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="MessageAssignment" OID="a08b6f3b-d06e-4d86-8e15-83fc39ea8dfa" ParentLink="ComplexStatement_Statement" LowerBound="178.1" HigherBound="203.1">
                                    <om:Property Name="Expression" Value="sMessage = &quot;IDOC Successful.&quot;;&#xD;&#xA;sDocNum = RFCIDOCStatusResponse.STATUS.DOCNUM;&#xD;&#xA;sIDocStatus = RFCIDOCStatusResponse.STATUS.STATUS;&#xD;&#xA;sIDocStatusDesc = RFCIDOCStatusResponse.STATUS.STATXT; &#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;1&quot;,RFCIDOCStatusResponse.STATUS.STAPA1);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;2&quot;,RFCIDOCStatusResponse.STATUS.STAPA2);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;3&quot;,RFCIDOCStatusResponse.STATUS.STAPA3);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;4&quot;,RFCIDOCStatusResponse.STATUS.STAPA4);&#xD;&#xA;UpdatedAlertMessage.MessageAlertText = sMessage;&#xD;&#xA;UpdatedAlertMessage.SAPDocumentNo = sDocNum;&#xD;&#xA;UpdatedAlertMessage.SAPIDOCStatus = sIDocStatus;&#xD;&#xA;UpdatedAlertMessage.SAPIDOCStatusDesc = sIDocStatusDesc; &#xD;&#xA;&#xD;&#xA;&#xD;&#xA;//BUILD HTML MESSAGE&#xD;&#xA;sAlertBody = Visy.Middleware.Components.Utilities.HTMLHelper.FromXML(UpdatedAlertMessage,&quot;SAPAlertContext.xslt&quot;);&#xD;&#xA;&#xD;&#xA;//SET EMAIL PROPERTIES&#xD;&#xA;EMail.EMailBody = new  Visy.Middleware.Components.Utilities.RawString(sAlertBody);&#xD;&#xA;EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;EMail(SMTP.Subject) = &quot;SAP.&quot; + sApplicationName + &quot; : IDOC Success&quot;;&#xD;&#xA;EMail(SMTP.From) = &quot;biz06support@visy.com.au&quot;;&#xD;&#xA;EMail(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;EMail(SMTP.MessagePartsAttachments) = 1;" />
                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                    <om:Property Name="Name" Value="CreateAlert" />
                                    <om:Property Name="Signal" Value="True" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="0bc4b9bb-7174-4eec-a92e-6d530ece23f6" ParentLink="Construct_MessageRef" LowerBound="174.31" HigherBound="174.36">
                                    <om:Property Name="Ref" Value="EMail" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                                <om:Element Type="MessageRef" OID="4cde04e2-00ff-467d-b546-1609753e6a84" ParentLink="Construct_MessageRef" LowerBound="174.38" HigherBound="174.57">
                                    <om:Property Name="Ref" Value="UpdatedAlertMessage" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Signal" Value="False" />
                                </om:Element>
                            </om:Element>
                            <om:Element Type="VariableAssignment" OID="046a4473-292d-4248-a510-88b921a86fe4" ParentLink="ComplexStatement_Statement" LowerBound="204.1" HigherBound="206.1">
                                <om:Property Name="Expression" Value="iAlertLoopCount = iAlertLoopLimit + 1;" />
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="EndLoop" />
                                <om:Property Name="Signal" Value="False" />
                            </om:Element>
                        </om:Element>
                        <om:Element Type="DecisionBranch" OID="dcff88e0-4f63-407f-a4a4-61c79e749388" ParentLink="ReallyComplexStatement_Branch">
                            <om:Property Name="IsGhostBranch" Value="True" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="Else" />
                            <om:Property Name="Signal" Value="False" />
                            <om:Element Type="Decision" OID="7258c42a-6e55-4b28-8aa8-12091f5d8c5e" ParentLink="ComplexStatement_Statement" LowerBound="209.1" HigherBound="394.1">
                                <om:Property Name="ReportToAnalyst" Value="True" />
                                <om:Property Name="Name" Value="Check Status" />
                                <om:Property Name="Signal" Value="True" />
                                <om:Element Type="DecisionBranch" OID="20977872-8c4b-48cc-bde7-a14ec8eb7ee7" ParentLink="ReallyComplexStatement_Branch" LowerBound="210.21" HigherBound="281.1">
                                    <om:Property Name="Expression" Value="RFCIDOCStatusResponse.STATUS.STATUS == &quot;51&quot;" />
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="ERROR" />
                                    <om:Property Name="Signal" Value="True" />
                                    <om:Element Type="Scope" OID="3083958b-1a93-44c2-9267-9a20ef6658b6" ParentLink="ComplexStatement_Statement" LowerBound="212.1" HigherBound="246.1">
                                        <om:Property Name="InitializedTransactionType" Value="True" />
                                        <om:Property Name="IsSynchronized" Value="False" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="RSPUpdateStatTry" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="VariableAssignment" OID="6ab94ab2-c929-4a1d-b345-67ae85ea157b" ParentLink="ComplexStatement_Statement" LowerBound="217.1" HigherBound="221.1">
                                            <om:Property Name="Expression" Value="//UPDATE STATS&#xD;&#xA;//Visy.WSS.Data.Reporting.Update(sBiztalkID,&quot;RE&quot;,sCustomerCode);&#xD;&#xA;sCustomerCode=sCustomerCode;" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="RSPUpdateStat" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="Catch" OID="78945bbc-def8-4416-8208-92ad953ba155" ParentLink="Scope_Catch" LowerBound="224.1" HigherBound="244.1">
                                            <om:Property Name="ExceptionName" Value="ex3" />
                                            <om:Property Name="ExceptionType" Value="System.Exception" />
                                            <om:Property Name="IsFaultMessage" Value="False" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="RSPUpdateStatCatch" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Construct" OID="a496fa5b-6ffb-41d2-bb13-9086c1c4fced" ParentLink="Catch_Statement" LowerBound="227.1" HigherBound="241.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="BuildAlertEMail" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="MessageAssignment" OID="09d86e94-c1d8-4512-8d49-cb57442ee022" ParentLink="ComplexStatement_Statement" LowerBound="230.1" HigherBound="240.1">
                                                    <om:Property Name="Expression" Value="//SET EMAIL PROPERTIES&#xD;&#xA;EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString(&quot;Error Getting Context or Updating Statistics&quot;);&#xD;&#xA;EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString(&quot;Exception encountered: &quot; + ex3.Message);&#xD;&#xA;&#xD;&#xA;EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;EMail(SMTP.Subject) = System.Environment.MachineName + &quot; - ALERT ERROR03 &quot;;&#xD;&#xA;EMail(SMTP.From) = &quot;biz06support@visy.com.au&quot;;&#xD;&#xA;EMail(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;EMail(SMTP.MessagePartsAttachments) = 1;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="Alert003Error" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="0145b161-8b81-4608-9d24-0795cc92b158" ParentLink="Construct_MessageRef" LowerBound="228.47" HigherBound="228.52">
                                                    <om:Property Name="Ref" Value="EMail" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="a43ebc0e-6af4-4b96-9390-f57696c050ef" ParentLink="Catch_Statement" LowerBound="241.1" HigherBound="243.1">
                                                <om:Property Name="PortName" Value="SendTechAlert_Port" />
                                                <om:Property Name="MessageName" Value="EMail" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Alert003ErrorMsg" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Construct" OID="cae2e6c2-623e-4ac4-9c3d-636f390fd99e" ParentLink="ComplexStatement_Statement" LowerBound="246.1" HigherBound="276.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="AlertError" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="Transform" OID="d8ab7723-c083-4ffe-a8a5-5801daaba78d" ParentLink="ComplexStatement_Statement" LowerBound="249.1" HigherBound="251.1">
                                            <om:Property Name="ClassName" Value="Visy.Middleware.SAP.Common.Maps.UpdateAlertMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="CreateErrorMessage" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="MessagePartRef" OID="2216b1ed-9143-4ef3-ab96-695aee9d16e3" ParentLink="Transform_OutputMessagePartRef" LowerBound="250.40" HigherBound="250.59">
                                                <om:Property Name="MessageRef" Value="UpdatedAlertMessage" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_12" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                            <om:Element Type="MessagePartRef" OID="949bf890-77f3-4a9d-81f6-afe50645011f" ParentLink="Transform_InputMessagePartRef" LowerBound="250.115" HigherBound="250.127">
                                                <om:Property Name="MessageRef" Value="AlertMessage" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="MessagePartReference_11" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="MessageAssignment" OID="c95f6a34-571f-44e1-bc4c-e828773bfd68" ParentLink="ComplexStatement_Statement" LowerBound="251.1" HigherBound="275.1">
                                            <om:Property Name="Expression" Value="sMessage = &quot;Status received by Z_BIZTALK_GET_IDOC_STATUS indicates that IDOC has failed.   Please investigate by accessing transaction WE02 in SAP and determining why ORDER failed.&quot;;&#xD;&#xA;sDocNum = RFCIDOCStatusResponse.STATUS.DOCNUM;&#xD;&#xA;sIDocStatus = RFCIDOCStatusResponse.STATUS.STATUS;&#xD;&#xA;sIDocStatusDesc = RFCIDOCStatusResponse.STATUS.STATXT; &#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;1&quot;,RFCIDOCStatusResponse.STATUS.STAPA1);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;2&quot;,RFCIDOCStatusResponse.STATUS.STAPA2);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;3&quot;,RFCIDOCStatusResponse.STATUS.STAPA3);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;4&quot;,RFCIDOCStatusResponse.STATUS.STAPA4);&#xD;&#xA;UpdatedAlertMessage.MessageAlertText = sMessage;&#xD;&#xA;UpdatedAlertMessage.SAPDocumentNo = sDocNum;&#xD;&#xA;UpdatedAlertMessage.SAPIDOCStatus = sIDocStatus;&#xD;&#xA;UpdatedAlertMessage.SAPIDOCStatusDesc = sIDocStatusDesc; &#xD;&#xA;&#xD;&#xA;//BUILD HTML MESSAGE&#xD;&#xA;sAlertBody = Visy.Middleware.Components.Utilities.HTMLHelper.FromXML(UpdatedAlertMessage,&quot;SAPAlertContext.xslt&quot;);&#xD;&#xA;&#xD;&#xA;//SET EMAIL PROPERTIES&#xD;&#xA;EMail.EMailBody = new  Visy.Middleware.Components.Utilities.RawString(sAlertBody);&#xD;&#xA;EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;EMail(SMTP.Subject) = &quot;SAP.&quot; + sApplicationName + &quot; : RFC Check Error&quot;;&#xD;&#xA;EMail(SMTP.From) = &quot;biz06support@visy.com.au&quot;;&#xD;&#xA;EMail(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;EMail(SMTP.MessagePartsAttachments) = 1;" />
                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                            <om:Property Name="Name" Value="CreateAlert" />
                                            <om:Property Name="Signal" Value="True" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="734e9ece-6194-4647-bde4-dacf22543235" ParentLink="Construct_MessageRef" LowerBound="247.35" HigherBound="247.40">
                                            <om:Property Name="Ref" Value="EMail" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                        <om:Element Type="MessageRef" OID="6e90ec0f-4b98-486d-842a-b0608d8bf324" ParentLink="Construct_MessageRef" LowerBound="247.42" HigherBound="247.61">
                                            <om:Property Name="Ref" Value="UpdatedAlertMessage" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Signal" Value="False" />
                                        </om:Element>
                                    </om:Element>
                                    <om:Element Type="Send" OID="d00a2ddc-3368-477a-9ae5-e2457c7ef0ea" ParentLink="ComplexStatement_Statement" LowerBound="276.1" HigherBound="278.1">
                                        <om:Property Name="PortName" Value="SendErrorResponse_Port" />
                                        <om:Property Name="MessageName" Value="EMail" />
                                        <om:Property Name="OperationName" Value="Operation_1" />
                                        <om:Property Name="OperationMessageName" Value="Request" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Error" />
                                        <om:Property Name="Signal" Value="True" />
                                    </om:Element>
                                    <om:Element Type="VariableAssignment" OID="4c34aa9c-dffd-4a87-a47d-6167184d3b06" ParentLink="ComplexStatement_Statement" LowerBound="278.1" HigherBound="280.1">
                                        <om:Property Name="Expression" Value="iAlertLoopCount = iAlertLoopLimit + 1;" />
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="EndLoop" />
                                        <om:Property Name="Signal" Value="False" />
                                    </om:Element>
                                </om:Element>
                                <om:Element Type="DecisionBranch" OID="cb456d05-4c59-4a2b-b467-07711250f1b0" ParentLink="ReallyComplexStatement_Branch">
                                    <om:Property Name="IsGhostBranch" Value="True" />
                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                    <om:Property Name="Name" Value="Else" />
                                    <om:Property Name="Signal" Value="False" />
                                    <om:Element Type="Decision" OID="3e723136-f367-44bd-b775-0f80753a9117" ParentLink="ComplexStatement_Statement" LowerBound="283.1" HigherBound="393.1">
                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                        <om:Property Name="Name" Value="Should Continue" />
                                        <om:Property Name="Signal" Value="True" />
                                        <om:Element Type="DecisionBranch" OID="a35fcd7f-155b-4b58-83f7-07cf79479ead" ParentLink="ReallyComplexStatement_Branch" LowerBound="284.25" HigherBound="356.1">
                                            <om:Property Name="Expression" Value="iAlertLoopCount &gt;= iAlertLoopLimit" />
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="NO" />
                                            <om:Property Name="Signal" Value="True" />
                                            <om:Element Type="Scope" OID="049821ea-c8fa-4b7b-a19e-7acb3c774d8a" ParentLink="ComplexStatement_Statement" LowerBound="286.1" HigherBound="320.1">
                                                <om:Property Name="InitializedTransactionType" Value="True" />
                                                <om:Property Name="IsSynchronized" Value="False" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="RSPUpdateStatTry" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="VariableAssignment" OID="c6661517-aeb4-43c0-92bd-7facd7fb845b" ParentLink="ComplexStatement_Statement" LowerBound="291.1" HigherBound="295.1">
                                                    <om:Property Name="Expression" Value="//UPDATE STATS&#xD;&#xA;//Visy.WSS.Data.Reporting.Update(sBiztalkID,&quot;NR&quot;,sCustomerCode);&#xD;&#xA;sCustomerCode=sCustomerCode;" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="RSPUpdateStat" />
                                                    <om:Property Name="Signal" Value="True" />
                                                </om:Element>
                                                <om:Element Type="Catch" OID="a091f149-b7c7-4e35-b45c-cf468ff39863" ParentLink="Scope_Catch" LowerBound="298.1" HigherBound="318.1">
                                                    <om:Property Name="ExceptionName" Value="ex3" />
                                                    <om:Property Name="ExceptionType" Value="System.Exception" />
                                                    <om:Property Name="IsFaultMessage" Value="False" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="RSPUpdateStatCatch" />
                                                    <om:Property Name="Signal" Value="True" />
                                                    <om:Element Type="Construct" OID="052aee8c-4d42-49ed-b8a1-481288a49a9f" ParentLink="Catch_Statement" LowerBound="301.1" HigherBound="315.1">
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="BuildAlertEMail" />
                                                        <om:Property Name="Signal" Value="True" />
                                                        <om:Element Type="MessageAssignment" OID="22dafff1-155f-4386-866c-706a779ec284" ParentLink="ComplexStatement_Statement" LowerBound="304.1" HigherBound="314.1">
                                                            <om:Property Name="Expression" Value="//SET EMAIL PROPERTIES&#xD;&#xA;EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString(&quot;Error Getting Context or Updating Statistics&quot;);&#xD;&#xA;EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString(&quot;Exception encountered: &quot; + ex3.Message);&#xD;&#xA;&#xD;&#xA;EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;EMail(SMTP.Subject) = System.Environment.MachineName + &quot; - ALERT ERROR03 &quot;;&#xD;&#xA;EMail(SMTP.From) = &quot;biz06support@visy.com.au&quot;;&#xD;&#xA;EMail(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;EMail(SMTP.MessagePartsAttachments) = 1;" />
                                                            <om:Property Name="ReportToAnalyst" Value="False" />
                                                            <om:Property Name="Name" Value="Alert003Error" />
                                                            <om:Property Name="Signal" Value="True" />
                                                        </om:Element>
                                                        <om:Element Type="MessageRef" OID="f4070a0f-7e9f-4cc1-88a0-033b78737c21" ParentLink="Construct_MessageRef" LowerBound="302.51" HigherBound="302.56">
                                                            <om:Property Name="Ref" Value="EMail" />
                                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                                            <om:Property Name="Signal" Value="False" />
                                                        </om:Element>
                                                    </om:Element>
                                                    <om:Element Type="Send" OID="8b12cfc0-5bba-4eb4-9cce-1fba6e5bcb80" ParentLink="Catch_Statement" LowerBound="315.1" HigherBound="317.1">
                                                        <om:Property Name="PortName" Value="SendTechAlert_Port" />
                                                        <om:Property Name="MessageName" Value="EMail" />
                                                        <om:Property Name="OperationName" Value="Operation_1" />
                                                        <om:Property Name="OperationMessageName" Value="Request" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="Alert003ErrorMsg" />
                                                        <om:Property Name="Signal" Value="True" />
                                                    </om:Element>
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Construct" OID="17659368-7726-4aec-bd94-bed978820d7f" ParentLink="ComplexStatement_Statement" LowerBound="320.1" HigherBound="351.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="AlertNoResponse" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="Transform" OID="c61b1e88-a740-435d-b5f8-747ae955aa56" ParentLink="ComplexStatement_Statement" LowerBound="323.1" HigherBound="325.1">
                                                    <om:Property Name="ClassName" Value="Visy.Middleware.SAP.Common.Maps.UpdateAlertMessage" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="CreateNoResponseMessage" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="MessagePartRef" OID="5e8224ac-b3dd-4559-a5ce-eeae7935bf71" ParentLink="Transform_OutputMessagePartRef" LowerBound="324.44" HigherBound="324.63">
                                                        <om:Property Name="MessageRef" Value="UpdatedAlertMessage" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_8" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="214d5250-1606-4f1a-b4e0-6950ac9e4e50" ParentLink="Transform_InputMessagePartRef" LowerBound="324.119" HigherBound="324.131">
                                                        <om:Property Name="MessageRef" Value="AlertMessage" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_7" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="87ba6e08-9072-4059-bbca-b2fc021cf838" ParentLink="ComplexStatement_Statement" LowerBound="325.1" HigherBound="350.1">
                                                    <om:Property Name="Expression" Value="sMessage = &quot;Orchestration has timed out, No more checks will be performed.  You will need to access transaction WE02 and check manually to see if IDOC has succedded.&quot;;&#xD;&#xA;sDocNum = RFCIDOCStatusResponse.STATUS.DOCNUM;&#xD;&#xA;sIDocStatus = RFCIDOCStatusResponse.STATUS.STATUS;&#xD;&#xA;sIDocStatusDesc = RFCIDOCStatusResponse.STATUS.STATXT; &#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;1&quot;,RFCIDOCStatusResponse.STATUS.STAPA1);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;2&quot;,RFCIDOCStatusResponse.STATUS.STAPA2);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;3&quot;,RFCIDOCStatusResponse.STATUS.STAPA3);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;4&quot;,RFCIDOCStatusResponse.STATUS.STAPA4);&#xD;&#xA;UpdatedAlertMessage.MessageAlertText = sMessage;&#xD;&#xA;UpdatedAlertMessage.SAPDocumentNo = sDocNum;&#xD;&#xA;UpdatedAlertMessage.SAPIDOCStatus = sIDocStatus;&#xD;&#xA;UpdatedAlertMessage.SAPIDOCStatusDesc = sIDocStatusDesc; &#xD;&#xA;&#xD;&#xA;//BUILD HTML MESSAGE&#xD;&#xA;sAlertBody = Visy.Middleware.Components.Utilities.HTMLHelper.FromXML(UpdatedAlertMessage,&quot;SAPAlertContext.xslt&quot;);&#xD;&#xA;&#xD;&#xA;//SET EMAIL PROPERTIES&#xD;&#xA;EMail.EMailBody = new  Visy.Middleware.Components.Utilities.RawString(sAlertBody);&#xD;&#xA;EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;EMail(SMTP.Subject) = &quot;SAP.&quot; + sApplicationName + &quot;RFC Check Orchestration Timeout&quot;;&#xD;&#xA;EMail(SMTP.From) = &quot;biz06support@visy.com.au&quot;;&#xD;&#xA;EMail(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;EMail(SMTP.MessagePartsAttachments) = 1;&#xD;&#xA;&#xD;&#xA;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="CreateAlert" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="e7b09aca-7a36-4065-becd-50505552891c" ParentLink="Construct_MessageRef" LowerBound="321.39" HigherBound="321.44">
                                                    <om:Property Name="Ref" Value="EMail" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="5cc5b040-d6f0-4201-b567-2338f18ede58" ParentLink="Construct_MessageRef" LowerBound="321.46" HigherBound="321.65">
                                                    <om:Property Name="Ref" Value="UpdatedAlertMessage" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="996f23ee-9257-40da-ad7b-145bc9b1ad9b" ParentLink="ComplexStatement_Statement" LowerBound="351.1" HigherBound="353.1">
                                                <om:Property Name="PortName" Value="SendErrorResponse_Port" />
                                                <om:Property Name="MessageName" Value="EMail" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="No Response" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="VariableAssignment" OID="322c97e1-2df5-449b-918e-1615ac5065f5" ParentLink="ComplexStatement_Statement" LowerBound="353.1" HigherBound="355.1">
                                                <om:Property Name="Expression" Value="iAlertLoopCount = iAlertLoopLimit + 1;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="EndLoop" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                        <om:Element Type="DecisionBranch" OID="3c3ff4c9-bc39-4d4d-834b-5144efb82d99" ParentLink="ReallyComplexStatement_Branch">
                                            <om:Property Name="IsGhostBranch" Value="True" />
                                            <om:Property Name="ReportToAnalyst" Value="True" />
                                            <om:Property Name="Name" Value="Else" />
                                            <om:Property Name="Signal" Value="False" />
                                            <om:Element Type="Construct" OID="fabb2790-196a-4954-b79d-ce4afbb3466d" ParentLink="ComplexStatement_Statement" LowerBound="358.1" HigherBound="388.1">
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="AlertDelayProcessing" />
                                                <om:Property Name="Signal" Value="True" />
                                                <om:Element Type="Transform" OID="bf91f8be-06f6-4918-ba7b-7259e5b99a08" ParentLink="ComplexStatement_Statement" LowerBound="361.1" HigherBound="363.1">
                                                    <om:Property Name="ClassName" Value="Visy.Middleware.SAP.Common.Maps.UpdateAlertMessage" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Name" Value="CreateDelayMessage" />
                                                    <om:Property Name="Signal" Value="False" />
                                                    <om:Element Type="MessagePartRef" OID="a9a8eb9b-c7f2-42a5-acea-5613d883f556" ParentLink="Transform_OutputMessagePartRef" LowerBound="362.44" HigherBound="362.63">
                                                        <om:Property Name="MessageRef" Value="UpdatedAlertMessage" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_10" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                    <om:Element Type="MessagePartRef" OID="53ac9e54-5836-48de-890f-c5ab2a12411e" ParentLink="Transform_InputMessagePartRef" LowerBound="362.119" HigherBound="362.131">
                                                        <om:Property Name="MessageRef" Value="AlertMessage" />
                                                        <om:Property Name="ReportToAnalyst" Value="True" />
                                                        <om:Property Name="Name" Value="MessagePartReference_9" />
                                                        <om:Property Name="Signal" Value="False" />
                                                    </om:Element>
                                                </om:Element>
                                                <om:Element Type="MessageAssignment" OID="a04d0945-0d44-4341-b61b-54ffcbe964df" ParentLink="ComplexStatement_Statement" LowerBound="363.1" HigherBound="387.1">
                                                    <om:Property Name="Expression" Value="sMessage = &quot;Orchestration has timed out, No more checks will be performed.  You will need to access transaction WE02 and check manually to see if IDOC has succeeded.&quot;;&#xD;&#xA;sDocNum = RFCIDOCStatusResponse.STATUS.DOCNUM;&#xD;&#xA;sIDocStatus = RFCIDOCStatusResponse.STATUS.STATUS;&#xD;&#xA;sIDocStatusDesc = RFCIDOCStatusResponse.STATUS.STATXT; &#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;1&quot;,RFCIDOCStatusResponse.STATUS.STAPA1);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;2&quot;,RFCIDOCStatusResponse.STATUS.STAPA2);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;3&quot;,RFCIDOCStatusResponse.STATUS.STAPA3);&#xD;&#xA;sIDocStatusDesc = sIDocStatusDesc.Replace(&quot;&amp;4&quot;,RFCIDOCStatusResponse.STATUS.STAPA4);&#xD;&#xA;UpdatedAlertMessage.MessageAlertText = sMessage;&#xD;&#xA;UpdatedAlertMessage.SAPDocumentNo = sDocNum;&#xD;&#xA;UpdatedAlertMessage.SAPIDOCStatus = sIDocStatus;&#xD;&#xA;UpdatedAlertMessage.SAPIDOCStatusDesc = sIDocStatusDesc; &#xD;&#xA;&#xD;&#xA;//BUILD HTML MESSAGE&#xD;&#xA;sAlertBody = Visy.Middleware.Components.Utilities.HTMLHelper.FromXML(UpdatedAlertMessage,&quot;SAPAlertContext.xslt&quot;);&#xD;&#xA;&#xD;&#xA;//SET EMAIL PROPERTIES&#xD;&#xA;EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString(sAlertBody);&#xD;&#xA;EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = &quot;text/html&quot;;&#xD;&#xA;EMail(SMTP.Subject) = &quot;SAP.&quot; + sApplicationName + &quot; : RFC Check Delayed - ALERT  &quot; + iAlertLoopCount.ToString();&#xD;&#xA;EMail(SMTP.From) = &quot;biz06support@visy.com.au&quot;;&#xD;&#xA;EMail(SMTP.EmailBodyFileCharset) = &quot;UTF-8&quot;;&#xD;&#xA;EMail(SMTP.MessagePartsAttachments) = 1;" />
                                                    <om:Property Name="ReportToAnalyst" Value="False" />
                                                    <om:Property Name="Name" Value="CreateAlert" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="fe208663-5dd2-421f-8c4f-c2555804af7e" ParentLink="Construct_MessageRef" LowerBound="359.39" HigherBound="359.44">
                                                    <om:Property Name="Ref" Value="EMail" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                                <om:Element Type="MessageRef" OID="0a1d2140-c379-4fa8-af6e-bccc828b56cf" ParentLink="Construct_MessageRef" LowerBound="359.46" HigherBound="359.65">
                                                    <om:Property Name="Ref" Value="UpdatedAlertMessage" />
                                                    <om:Property Name="ReportToAnalyst" Value="True" />
                                                    <om:Property Name="Signal" Value="False" />
                                                </om:Element>
                                            </om:Element>
                                            <om:Element Type="Send" OID="5a55ea4a-3b97-4ba2-b5ff-c32450cc5773" ParentLink="ComplexStatement_Statement" LowerBound="388.1" HigherBound="390.1">
                                                <om:Property Name="PortName" Value="SendErrorResponse_Port" />
                                                <om:Property Name="MessageName" Value="EMail" />
                                                <om:Property Name="OperationName" Value="Operation_1" />
                                                <om:Property Name="OperationMessageName" Value="Request" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="Delay Processing" />
                                                <om:Property Name="Signal" Value="True" />
                                            </om:Element>
                                            <om:Element Type="VariableAssignment" OID="def11823-3ba2-4369-9d5c-716da5695dc2" ParentLink="ComplexStatement_Statement" LowerBound="390.1" HigherBound="392.1">
                                                <om:Property Name="Expression" Value="iAlertLoopCount = iAlertLoopCount + 1;" />
                                                <om:Property Name="ReportToAnalyst" Value="True" />
                                                <om:Property Name="Name" Value="IncrementCount" />
                                                <om:Property Name="Signal" Value="False" />
                                            </om:Element>
                                        </om:Element>
                                    </om:Element>
                                </om:Element>
                            </om:Element>
                        </om:Element>
                    </om:Element>
                </om:Element>
                <om:Element Type="Construct" OID="dd86e2c7-aedc-4e7a-b40b-3e912fbdc237" ParentLink="ServiceBody_Statement" LowerBound="396.1" HigherBound="407.1">
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="Alert Message" />
                    <om:Property Name="Signal" Value="True" />
                    <om:Element Type="Transform" OID="8e539eac-010e-4d76-a203-747d6895c3fa" ParentLink="ComplexStatement_Statement" LowerBound="399.1" HigherBound="401.1">
                        <om:Property Name="ClassName" Value="Visy.Middleware.SAP.Common.Maps.UpdateAlertMessage" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Name" Value="Update AlertMessage" />
                        <om:Property Name="Signal" Value="False" />
                        <om:Element Type="MessagePartRef" OID="31d3c623-f6c8-4037-87fa-3a2b77dc1043" ParentLink="Transform_InputMessagePartRef" LowerBound="400.103" HigherBound="400.115">
                            <om:Property Name="MessageRef" Value="AlertMessage" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="MessagePartReference_3" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                        <om:Element Type="MessagePartRef" OID="2c75bff0-0ceb-49c9-bf9a-60b64cfa09b7" ParentLink="Transform_OutputMessagePartRef" LowerBound="400.28" HigherBound="400.47">
                            <om:Property Name="MessageRef" Value="UpdatedAlertMessage" />
                            <om:Property Name="ReportToAnalyst" Value="True" />
                            <om:Property Name="Name" Value="MessagePartReference_4" />
                            <om:Property Name="Signal" Value="False" />
                        </om:Element>
                    </om:Element>
                    <om:Element Type="MessageAssignment" OID="3e799f5a-3106-41d4-9da3-73b254ccf27b" ParentLink="ComplexStatement_Statement" LowerBound="401.1" HigherBound="406.1">
                        <om:Property Name="Expression" Value="UpdatedAlertMessage.MessageAlertText = sMessage;&#xD;&#xA;UpdatedAlertMessage.SAPDocumentNo = sDocNum;&#xD;&#xA;UpdatedAlertMessage.SAPIDOCStatus = sIDocStatus;&#xD;&#xA;UpdatedAlertMessage.SAPIDOCStatusDesc = sIDocStatusDesc; " />
                        <om:Property Name="ReportToAnalyst" Value="False" />
                        <om:Property Name="Name" Value="Create Alert" />
                        <om:Property Name="Signal" Value="True" />
                    </om:Element>
                    <om:Element Type="MessageRef" OID="d6bda065-ee7e-4202-9bfd-fc552c0932d0" ParentLink="Construct_MessageRef" LowerBound="397.23" HigherBound="397.42">
                        <om:Property Name="Ref" Value="UpdatedAlertMessage" />
                        <om:Property Name="ReportToAnalyst" Value="True" />
                        <om:Property Name="Signal" Value="False" />
                    </om:Element>
                </om:Element>
                <om:Element Type="Send" OID="4e7195a1-4069-4809-8ed6-85e09fe2a0b6" ParentLink="ServiceBody_Statement" LowerBound="407.1" HigherBound="409.1">
                    <om:Property Name="PortName" Value="SndSaveRFCResponsePort" />
                    <om:Property Name="MessageName" Value="UpdatedAlertMessage" />
                    <om:Property Name="OperationName" Value="SndSaveRFCResponseOperation" />
                    <om:Property Name="OperationMessageName" Value="SndSaveRFCResponseRequest" />
                    <om:Property Name="ReportToAnalyst" Value="True" />
                    <om:Property Name="Name" Value="SaveAlertContext" />
                    <om:Property Name="Signal" Value="True" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="dc87acf8-4b21-4d55-8dda-5ac0021df7e0" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="60.1" HigherBound="62.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="49" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Common.Orchestrations.sndSAPPostSResponsePortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="sndSAPPostSResponsePort" />
                <om:Property Name="Signal" Value="True" />
                <om:Element Type="LogicalBindingAttribute" OID="a1b1043d-caa1-490b-976f-c396d3aeddca" ParentLink="PortDeclaration_CLRAttribute" LowerBound="60.1" HigherBound="61.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="ea27ffba-8e23-4c27-a875-9cf400929306" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="62.1" HigherBound="64.1">
                <om:Property Name="PortModifier" Value="Implements" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="0" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Common.Orchestrations.ReceiveAlert_PortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="ReceiveAlert_Port" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="f60e3461-558c-415c-abb5-fb746eb7d3d3" ParentLink="PortDeclaration_CLRAttribute" LowerBound="62.1" HigherBound="63.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="6b003f46-5188-4c88-bf1f-cbe358e8da75" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="64.1" HigherBound="66.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="50" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Common.Orchestrations.SendTechAlert_PortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SendTechAlert_Port" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="4f8cf273-0224-4d8d-ab63-0031f3024cdc" ParentLink="PortDeclaration_CLRAttribute" LowerBound="64.1" HigherBound="65.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="db5a0124-4a7f-42a4-895b-d6b149f24ee3" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="66.1" HigherBound="68.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Left" />
                <om:Property Name="PortIndex" Value="92" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Common.Orchestrations.SendErrorResponse_PortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SendErrorResponse_Port" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="df56f3e1-6c42-427f-b23d-3b514669a2af" ParentLink="PortDeclaration_CLRAttribute" LowerBound="66.1" HigherBound="67.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
            <om:Element Type="PortDeclaration" OID="de588c14-bcad-473f-bcc5-5979e0dd4695" ParentLink="ServiceDeclaration_PortDeclaration" LowerBound="68.1" HigherBound="70.1">
                <om:Property Name="PortModifier" Value="Uses" />
                <om:Property Name="Orientation" Value="Right" />
                <om:Property Name="PortIndex" Value="150" />
                <om:Property Name="IsWebPort" Value="False" />
                <om:Property Name="OrderedDelivery" Value="False" />
                <om:Property Name="DeliveryNotification" Value="None" />
                <om:Property Name="Type" Value="Visy.Middleware.SAP.Common.Orchestrations.SndSaveRFCResponsePortType" />
                <om:Property Name="ParamDirection" Value="In" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="SndSaveRFCResponsePort" />
                <om:Property Name="Signal" Value="False" />
                <om:Element Type="LogicalBindingAttribute" OID="e52b6688-f4cc-4efd-b9ff-ea821991ee32" ParentLink="PortDeclaration_CLRAttribute" LowerBound="68.1" HigherBound="69.1">
                    <om:Property Name="Signal" Value="False" />
                </om:Element>
            </om:Element>
        </om:Element>
        <om:Element Type="MultipartMessageType" OID="2e0a1a32-d244-49d9-8dbc-8aee35f8927c" ParentLink="Module_MessageType" LowerBound="4.1" HigherBound="8.1">
            <om:Property Name="TypeModifier" Value="Internal" />
            <om:Property Name="ReportToAnalyst" Value="True" />
            <om:Property Name="Name" Value="EMailType8" />
            <om:Property Name="Signal" Value="True" />
            <om:Element Type="PartDeclaration" OID="adef1419-008d-4e17-8cc2-ba614e141b44" ParentLink="MultipartMessageType_PartDeclaration" LowerBound="6.1" HigherBound="7.1">
                <om:Property Name="ClassName" Value="Visy.Middleware.Components.Utilities.RawString" />
                <om:Property Name="IsBodyPart" Value="True" />
                <om:Property Name="ReportToAnalyst" Value="True" />
                <om:Property Name="Name" Value="EMailBody" />
                <om:Property Name="Signal" Value="True" />
            </om:Element>
        </om:Element>
    </om:Element>
</om:MetaModel>
#endif // __DESIGNER_DATA
[Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
module Visy.Middleware.SAP.Common.Orchestrations
{
    internal messagetype EMailType8
    {
        body Visy.Middleware.Components.Utilities.RawString EMailBody;
    };
    internal porttype SndTechAlertPortType
    {
        oneway SndTechAlertOperation
        {
            EMailType8
        };
    };
    internal porttype sndSAPPostSResponsePortType
    {
        requestresponse Operation_1
        {
            Visy.Middleware.Common.Schemas.SAP.Z_BIZTALK_GET_IDOC_STATUS.Z_BIZTALK_GET_IDOC_STATUS_Request, Visy.Middleware.Common.Schemas.SAP.Z_BIZTALK_GET_IDOC_STATUS.Z_BIZTALK_GET_IDOC_STATUS_Response
        };
    };
    internal porttype SAPResponseSavePortType
    {
        oneway Operation_1
        {
            System.Xml.XmlDocument
        };
    };
    internal porttype SndSaveRFCResponsePortType
    {
        oneway SndSaveRFCResponseOperation
        {
            Visy.Middleware.Common.Schemas.SAP.SAPAlertContext
        };
    };
    internal porttype ReceiveAlert_PortType
    {
        oneway Operation_1
        {
            Visy.Middleware.Common.Schemas.SAP.SAPAlertContext
        };
    };
    internal porttype SendTechAlert_PortType
    {
        oneway Operation_1
        {
            EMailType8
        };
    };
    internal porttype SendErrorResponse_PortType
    {
        oneway Operation_1
        {
            EMailType8
        };
    };
    [Microsoft.XLANGs.BaseTypes.BPELExportable(false)]
    internal service RFCRequestStatus
    {
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses sndSAPPostSResponsePortType sndSAPPostSResponsePort;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port implements ReceiveAlert_PortType ReceiveAlert_Port;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses SendTechAlert_PortType SendTechAlert_Port;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses SendErrorResponse_PortType SendErrorResponse_Port;
        [Microsoft.XLANGs.BaseTypes.LogicalBinding()]
        port uses SndSaveRFCResponsePortType SndSaveRFCResponsePort;
        message EMailType8 EMail;
        message Visy.Middleware.Common.Schemas.SAP.Z_BIZTALK_GET_IDOC_STATUS.Z_BIZTALK_GET_IDOC_STATUS_Request RFCIDOCStatusRequest;
        message Visy.Middleware.Common.Schemas.SAP.Z_BIZTALK_GET_IDOC_STATUS.Z_BIZTALK_GET_IDOC_STATUS_Response RFCIDOCStatusResponse;
        message Visy.Middleware.Common.Schemas.SAP.SAPAlertContext AlertMessage;
        message Visy.Middleware.Common.Schemas.SAP.SAPAlertContext UpdatedAlertMessage;
        System.Text.StringBuilder msgbody;
        System.Int32 iAlertDelay;
        System.Int32 iAlertLoopCount;
        System.Int32 iAlertLoopLimit;
        System.String sTemp;
        System.String sApplicationName;
        System.String sBiztalkID;
        System.String sContextID;
        System.String sCustomerCode;
        System.String sOutputFileName;
        System.String sAlertBody;
        System.String sStatusString;
        System.String sMessage;
        System.String sDocNum;
        System.String sIDocStatus;
        System.String sIDocStatusDesc;
        body ()
        {
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("8149db7c-6416-4295-9be5-ee959342d4ff")]
            activate receive (ReceiveAlert_Port.Operation_1, AlertMessage);
            msgbody = new System.Text.StringBuilder();
            iAlertDelay = 0;
            sTemp = "";
            sApplicationName = "";
            sBiztalkID = "";
            sContextID = "";
            sCustomerCode = "";
            sOutputFileName = "";
            sAlertBody = "";
            sStatusString = "";
            sMessage = "";
            sDocNum = "";
            sIDocStatus = "";
            sIDocStatusDesc = "";
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a48a455b-0bfe-44ad-848a-9c02f900fd1b")]
            construct RFCIDOCStatusRequest
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d1cee42f-447d-4b6d-8499-33259dd170b2")]
                transform (RFCIDOCStatusRequest) = Visy.Middleware.SAP.Common.Maps.CreateRFCRequest (AlertMessage);
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("a3dac7d3-634e-463f-9281-b59dc34cb7af")]
            //DELAY and ALERT PARAMETERS
            iAlertDelay = System.Int32.Parse(Visy.Middleware.Components.Utilities.AppSettingsReader.retrieveValue("RSPAlertTimeout") );
            iAlertLoopCount = 1;
            iAlertLoopLimit = 3;
            
            sApplicationName = AlertMessage.ApplicationCode;
            
            //BiztalkID and Parts from Message
            sBiztalkID = AlertMessage.BiztalkID;
            sCustomerCode = AlertMessage.CustomerNo;
            
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("54ab7c35-3895-4b58-b465-bd5de76c44c8")]
            while (iAlertLoopCount <= iAlertLoopLimit)
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("8f33c5b9-63f6-46c3-9657-6d88d78ddd3b")]
                delay new System.TimeSpan(0,(iAlertDelay*iAlertLoopCount),0);
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("d05f5af7-c24e-4d2f-b6c5-c330d89c7c6b")]
                send (sndSAPPostSResponsePort.Operation_1, RFCIDOCStatusRequest);
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("48ab1c3d-5f9b-47b3-99db-45b0f951cc29")]
                receive (sndSAPPostSResponsePort.Operation_1, RFCIDOCStatusResponse);
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("501b4f0c-209b-44a4-91aa-f71f12b813f6")]
                if (RFCIDOCStatusResponse.STATUS.STATUS == "53")
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c4c3560a-e0d8-48ce-a3ab-29bfc0e47533")]
                    scope
                    {
                        body
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("31f7618a-5a95-45f6-8587-12148d1b1ea1")]
                            //UPDATE STATS
                            //Visy.WSS.Data.Reporting.Update(sBiztalkID,"AC",sCustomerCode);
                            sCustomerCode=sCustomerCode;
                        }
                        exceptions
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("08d9d954-47d9-4518-b92b-eb3dab59e5d7")]
                            catch (System.Exception ex3)
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("3e3d59bc-e1a3-4f53-a378-85a9c1a76d21")]
                                construct EMail
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("17d158b7-91d4-4e13-b63b-4b4128c3324e")]
                                    //SET EMAIL PROPERTIES
                                    EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString("Error Getting Context or Updating Statistics");
                                    EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString("Exception encountered: " + ex3.Message);
                                    
                                    EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                    EMail(SMTP.Subject) = System.Environment.MachineName + " - ALERT ERROR03 ";
                                    EMail(SMTP.From) = "biz06support@visy.com.au";
                                    EMail(SMTP.EmailBodyFileCharset) = "UTF-8";
                                    EMail(SMTP.MessagePartsAttachments) = 1;
                                }
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("1610e4d5-15c2-4520-b847-5119f320f22f")]
                                send (SendTechAlert_Port.Operation_1, EMail);
                            }
                        }
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("33158541-dfed-4eeb-9899-40d950915f05")]
                    construct EMail, UpdatedAlertMessage
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("2707998b-4675-454d-996f-e60efd80ac1a")]
                        transform (UpdatedAlertMessage) = Visy.Middleware.SAP.Common.Maps.UpdateAlertMessage (AlertMessage);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("a08b6f3b-d06e-4d86-8e15-83fc39ea8dfa")]
                        sMessage = "IDOC Successful.";
                        sDocNum = RFCIDOCStatusResponse.STATUS.DOCNUM;
                        sIDocStatus = RFCIDOCStatusResponse.STATUS.STATUS;
                        sIDocStatusDesc = RFCIDOCStatusResponse.STATUS.STATXT; 
                        sIDocStatusDesc = sIDocStatusDesc.Replace("&1",RFCIDOCStatusResponse.STATUS.STAPA1);
                        sIDocStatusDesc = sIDocStatusDesc.Replace("&2",RFCIDOCStatusResponse.STATUS.STAPA2);
                        sIDocStatusDesc = sIDocStatusDesc.Replace("&3",RFCIDOCStatusResponse.STATUS.STAPA3);
                        sIDocStatusDesc = sIDocStatusDesc.Replace("&4",RFCIDOCStatusResponse.STATUS.STAPA4);
                        UpdatedAlertMessage.MessageAlertText = sMessage;
                        UpdatedAlertMessage.SAPDocumentNo = sDocNum;
                        UpdatedAlertMessage.SAPIDOCStatus = sIDocStatus;
                        UpdatedAlertMessage.SAPIDOCStatusDesc = sIDocStatusDesc; 
                        
                        
                        //BUILD HTML MESSAGE
                        sAlertBody = Visy.Middleware.Components.Utilities.HTMLHelper.FromXML(UpdatedAlertMessage,"SAPAlertContext.xslt");
                        
                        //SET EMAIL PROPERTIES
                        EMail.EMailBody = new  Visy.Middleware.Components.Utilities.RawString(sAlertBody);
                        EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                        EMail(SMTP.Subject) = "SAP." + sApplicationName + " : IDOC Success";
                        EMail(SMTP.From) = "biz06support@visy.com.au";
                        EMail(SMTP.EmailBodyFileCharset) = "UTF-8";
                        EMail(SMTP.MessagePartsAttachments) = 1;
                    }
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("046a4473-292d-4248-a510-88b921a86fe4")]
                    iAlertLoopCount = iAlertLoopLimit + 1;
                }
                else 
                {
                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("7258c42a-6e55-4b28-8aa8-12091f5d8c5e")]
                    if (RFCIDOCStatusResponse.STATUS.STATUS == "51")
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3083958b-1a93-44c2-9267-9a20ef6658b6")]
                        scope
                        {
                            body
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("6ab94ab2-c929-4a1d-b345-67ae85ea157b")]
                                //UPDATE STATS
                                //Visy.WSS.Data.Reporting.Update(sBiztalkID,"RE",sCustomerCode);
                                sCustomerCode=sCustomerCode;
                            }
                            exceptions
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("78945bbc-def8-4416-8208-92ad953ba155")]
                                catch (System.Exception ex3)
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a496fa5b-6ffb-41d2-bb13-9086c1c4fced")]
                                    construct EMail
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("09d86e94-c1d8-4512-8d49-cb57442ee022")]
                                        //SET EMAIL PROPERTIES
                                        EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString("Error Getting Context or Updating Statistics");
                                        EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString("Exception encountered: " + ex3.Message);
                                        
                                        EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                        EMail(SMTP.Subject) = System.Environment.MachineName + " - ALERT ERROR03 ";
                                        EMail(SMTP.From) = "biz06support@visy.com.au";
                                        EMail(SMTP.EmailBodyFileCharset) = "UTF-8";
                                        EMail(SMTP.MessagePartsAttachments) = 1;
                                    }
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a43ebc0e-6af4-4b96-9390-f57696c050ef")]
                                    send (SendTechAlert_Port.Operation_1, EMail);
                                }
                            }
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("cae2e6c2-623e-4ac4-9c3d-636f390fd99e")]
                        construct EMail, UpdatedAlertMessage
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("d8ab7723-c083-4ffe-a8a5-5801daaba78d")]
                            transform (UpdatedAlertMessage) = Visy.Middleware.SAP.Common.Maps.UpdateAlertMessage (AlertMessage);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("c95f6a34-571f-44e1-bc4c-e828773bfd68")]
                            sMessage = "Status received by Z_BIZTALK_GET_IDOC_STATUS indicates that IDOC has failed.   Please investigate by accessing transaction WE02 in SAP and determining why ORDER failed.";
                            sDocNum = RFCIDOCStatusResponse.STATUS.DOCNUM;
                            sIDocStatus = RFCIDOCStatusResponse.STATUS.STATUS;
                            sIDocStatusDesc = RFCIDOCStatusResponse.STATUS.STATXT; 
                            sIDocStatusDesc = sIDocStatusDesc.Replace("&1",RFCIDOCStatusResponse.STATUS.STAPA1);
                            sIDocStatusDesc = sIDocStatusDesc.Replace("&2",RFCIDOCStatusResponse.STATUS.STAPA2);
                            sIDocStatusDesc = sIDocStatusDesc.Replace("&3",RFCIDOCStatusResponse.STATUS.STAPA3);
                            sIDocStatusDesc = sIDocStatusDesc.Replace("&4",RFCIDOCStatusResponse.STATUS.STAPA4);
                            UpdatedAlertMessage.MessageAlertText = sMessage;
                            UpdatedAlertMessage.SAPDocumentNo = sDocNum;
                            UpdatedAlertMessage.SAPIDOCStatus = sIDocStatus;
                            UpdatedAlertMessage.SAPIDOCStatusDesc = sIDocStatusDesc; 
                            
                            //BUILD HTML MESSAGE
                            sAlertBody = Visy.Middleware.Components.Utilities.HTMLHelper.FromXML(UpdatedAlertMessage,"SAPAlertContext.xslt");
                            
                            //SET EMAIL PROPERTIES
                            EMail.EMailBody = new  Visy.Middleware.Components.Utilities.RawString(sAlertBody);
                            EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                            EMail(SMTP.Subject) = "SAP." + sApplicationName + " : RFC Check Error";
                            EMail(SMTP.From) = "biz06support@visy.com.au";
                            EMail(SMTP.EmailBodyFileCharset) = "UTF-8";
                            EMail(SMTP.MessagePartsAttachments) = 1;
                        }
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("d00a2ddc-3368-477a-9ae5-e2457c7ef0ea")]
                        send (SendErrorResponse_Port.Operation_1, EMail);
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("4c34aa9c-dffd-4a87-a47d-6167184d3b06")]
                        iAlertLoopCount = iAlertLoopLimit + 1;
                    }
                    else 
                    {
                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("3e723136-f367-44bd-b775-0f80753a9117")]
                        if (iAlertLoopCount >= iAlertLoopLimit)
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("049821ea-c8fa-4b7b-a19e-7acb3c774d8a")]
                            scope
                            {
                                body
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("c6661517-aeb4-43c0-92bd-7facd7fb845b")]
                                    //UPDATE STATS
                                    //Visy.WSS.Data.Reporting.Update(sBiztalkID,"NR",sCustomerCode);
                                    sCustomerCode=sCustomerCode;
                                }
                                exceptions
                                {
                                    [Microsoft.XLANGs.BaseTypes.DesignerPosition("a091f149-b7c7-4e35-b45c-cf468ff39863")]
                                    catch (System.Exception ex3)
                                    {
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("052aee8c-4d42-49ed-b8a1-481288a49a9f")]
                                        construct EMail
                                        {
                                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("22dafff1-155f-4386-866c-706a779ec284")]
                                            //SET EMAIL PROPERTIES
                                            EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString("Error Getting Context or Updating Statistics");
                                            EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString("Exception encountered: " + ex3.Message);
                                            
                                            EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                            EMail(SMTP.Subject) = System.Environment.MachineName + " - ALERT ERROR03 ";
                                            EMail(SMTP.From) = "biz06support@visy.com.au";
                                            EMail(SMTP.EmailBodyFileCharset) = "UTF-8";
                                            EMail(SMTP.MessagePartsAttachments) = 1;
                                        }
                                        [Microsoft.XLANGs.BaseTypes.DesignerPosition("8b12cfc0-5bba-4eb4-9cce-1fba6e5bcb80")]
                                        send (SendTechAlert_Port.Operation_1, EMail);
                                    }
                                }
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("17659368-7726-4aec-bd94-bed978820d7f")]
                            construct EMail, UpdatedAlertMessage
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("c61b1e88-a740-435d-b5f8-747ae955aa56")]
                                transform (UpdatedAlertMessage) = Visy.Middleware.SAP.Common.Maps.UpdateAlertMessage (AlertMessage);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("87ba6e08-9072-4059-bbca-b2fc021cf838")]
                                sMessage = "Orchestration has timed out, No more checks will be performed.  You will need to access transaction WE02 and check manually to see if IDOC has succedded.";
                                sDocNum = RFCIDOCStatusResponse.STATUS.DOCNUM;
                                sIDocStatus = RFCIDOCStatusResponse.STATUS.STATUS;
                                sIDocStatusDesc = RFCIDOCStatusResponse.STATUS.STATXT; 
                                sIDocStatusDesc = sIDocStatusDesc.Replace("&1",RFCIDOCStatusResponse.STATUS.STAPA1);
                                sIDocStatusDesc = sIDocStatusDesc.Replace("&2",RFCIDOCStatusResponse.STATUS.STAPA2);
                                sIDocStatusDesc = sIDocStatusDesc.Replace("&3",RFCIDOCStatusResponse.STATUS.STAPA3);
                                sIDocStatusDesc = sIDocStatusDesc.Replace("&4",RFCIDOCStatusResponse.STATUS.STAPA4);
                                UpdatedAlertMessage.MessageAlertText = sMessage;
                                UpdatedAlertMessage.SAPDocumentNo = sDocNum;
                                UpdatedAlertMessage.SAPIDOCStatus = sIDocStatus;
                                UpdatedAlertMessage.SAPIDOCStatusDesc = sIDocStatusDesc; 
                                
                                //BUILD HTML MESSAGE
                                sAlertBody = Visy.Middleware.Components.Utilities.HTMLHelper.FromXML(UpdatedAlertMessage,"SAPAlertContext.xslt");
                                
                                //SET EMAIL PROPERTIES
                                EMail.EMailBody = new  Visy.Middleware.Components.Utilities.RawString(sAlertBody);
                                EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                EMail(SMTP.Subject) = "SAP." + sApplicationName + "RFC Check Orchestration Timeout";
                                EMail(SMTP.From) = "biz06support@visy.com.au";
                                EMail(SMTP.EmailBodyFileCharset) = "UTF-8";
                                EMail(SMTP.MessagePartsAttachments) = 1;
                                
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("996f23ee-9257-40da-ad7b-145bc9b1ad9b")]
                            send (SendErrorResponse_Port.Operation_1, EMail);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("322c97e1-2df5-449b-918e-1615ac5065f5")]
                            iAlertLoopCount = iAlertLoopLimit + 1;
                        }
                        else 
                        {
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("fabb2790-196a-4954-b79d-ce4afbb3466d")]
                            construct EMail, UpdatedAlertMessage
                            {
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("bf91f8be-06f6-4918-ba7b-7259e5b99a08")]
                                transform (UpdatedAlertMessage) = Visy.Middleware.SAP.Common.Maps.UpdateAlertMessage (AlertMessage);
                                [Microsoft.XLANGs.BaseTypes.DesignerPosition("a04d0945-0d44-4341-b61b-54ffcbe964df")]
                                sMessage = "Orchestration has timed out, No more checks will be performed.  You will need to access transaction WE02 and check manually to see if IDOC has succeeded.";
                                sDocNum = RFCIDOCStatusResponse.STATUS.DOCNUM;
                                sIDocStatus = RFCIDOCStatusResponse.STATUS.STATUS;
                                sIDocStatusDesc = RFCIDOCStatusResponse.STATUS.STATXT; 
                                sIDocStatusDesc = sIDocStatusDesc.Replace("&1",RFCIDOCStatusResponse.STATUS.STAPA1);
                                sIDocStatusDesc = sIDocStatusDesc.Replace("&2",RFCIDOCStatusResponse.STATUS.STAPA2);
                                sIDocStatusDesc = sIDocStatusDesc.Replace("&3",RFCIDOCStatusResponse.STATUS.STAPA3);
                                sIDocStatusDesc = sIDocStatusDesc.Replace("&4",RFCIDOCStatusResponse.STATUS.STAPA4);
                                UpdatedAlertMessage.MessageAlertText = sMessage;
                                UpdatedAlertMessage.SAPDocumentNo = sDocNum;
                                UpdatedAlertMessage.SAPIDOCStatus = sIDocStatus;
                                UpdatedAlertMessage.SAPIDOCStatusDesc = sIDocStatusDesc; 
                                
                                //BUILD HTML MESSAGE
                                sAlertBody = Visy.Middleware.Components.Utilities.HTMLHelper.FromXML(UpdatedAlertMessage,"SAPAlertContext.xslt");
                                
                                //SET EMAIL PROPERTIES
                                EMail.EMailBody = new Visy.Middleware.Components.Utilities.RawString(sAlertBody);
                                EMail.EMailBody(Microsoft.XLANGs.BaseTypes.ContentType) = "text/html";
                                EMail(SMTP.Subject) = "SAP." + sApplicationName + " : RFC Check Delayed - ALERT  " + iAlertLoopCount.ToString();
                                EMail(SMTP.From) = "biz06support@visy.com.au";
                                EMail(SMTP.EmailBodyFileCharset) = "UTF-8";
                                EMail(SMTP.MessagePartsAttachments) = 1;
                            }
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("5a55ea4a-3b97-4ba2-b5ff-c32450cc5773")]
                            send (SendErrorResponse_Port.Operation_1, EMail);
                            [Microsoft.XLANGs.BaseTypes.DesignerPosition("def11823-3ba2-4369-9d5c-716da5695dc2")]
                            iAlertLoopCount = iAlertLoopCount + 1;
                        }
                    }
                }
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("dd86e2c7-aedc-4e7a-b40b-3e912fbdc237")]
            construct UpdatedAlertMessage
            {
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("8e539eac-010e-4d76-a203-747d6895c3fa")]
                transform (UpdatedAlertMessage) = Visy.Middleware.SAP.Common.Maps.UpdateAlertMessage (AlertMessage);
                [Microsoft.XLANGs.BaseTypes.DesignerPosition("3e799f5a-3106-41d4-9da3-73b254ccf27b")]
                UpdatedAlertMessage.MessageAlertText = sMessage;
                UpdatedAlertMessage.SAPDocumentNo = sDocNum;
                UpdatedAlertMessage.SAPIDOCStatus = sIDocStatus;
                UpdatedAlertMessage.SAPIDOCStatusDesc = sIDocStatusDesc; 
            }
            [Microsoft.XLANGs.BaseTypes.DesignerPosition("4e7195a1-4069-4809-8ed6-85e09fe2a0b6")]
            send (SndSaveRFCResponsePort.SndSaveRFCResponseOperation, UpdatedAlertMessage);
        }
    }
}

